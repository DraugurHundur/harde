<!DOCTYPE html>
<html  lang="fr"  dir="ltr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>HARDE - SÉCURISATION D’UN SYSTÈME RED HAT 8.x</title>
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon-precomposed" href="images/apple-touch-icon.png" />

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/2.26.4/css/uikit.gradient.css" />
    
    <!-- <link rel="stylesheet" href="style.css"> -->
    <link rel="stylesheet" href="https://cdn.rawgit.com/diversen/pandoc-uikit/master/style.css" />
    <link href="https://vjs.zencdn.net/7.15.4/video-js.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
    <!-- <script src="uikit.js"></script> -->
    <script src="https://cdn.rawgit.com/diversen/pandoc-uikit/master/uikit.js"></script>
    <!-- <script src="scripts.js"></script> -->
    <script src="https://cdn.rawgit.com/diversen/pandoc-uikit/master/scripts.js"></script>
    <!-- <script src="jquery.sticky-kit.js "></script> -->
    <script src="https://cdn.rawgit.com/diversen/pandoc-uikit/master/jquery.sticky-kit.js"></script>

    <meta name="generator" content="pandoc-uikit" />
        <meta name="author" content="Pierre Blanchet" />
            <title>HARDE - SÉCURISATION D’UN SYSTÈME RED HAT 8.x</title>
    <style type="text/css">
        code {
            white-space: pre;
        }
    </style>
            <style type="text/css">
        pre > code.sourceCode { white-space: pre; position: relative; }
        pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
        pre > code.sourceCode > span:empty { height: 1.2em; }
        .sourceCode { overflow: visible; }
        code.sourceCode > span { color: inherit; text-decoration: inherit; }
        div.sourceCode { margin: 1em 0; }
        pre.sourceCode { margin: 0; }
        @media screen {
        div.sourceCode { overflow: auto; }
        }
        @media print {
        pre > code.sourceCode { white-space: pre-wrap; }
        pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
        }
        pre.numberSource code
          { counter-reset: source-line 0; }
        pre.numberSource code > span
          { position: relative; left: -4em; counter-increment: source-line; }
        pre.numberSource code > span > a:first-child::before
          { content: counter(source-line);
            position: relative; left: -1em; text-align: right; vertical-align: baseline;
            border: none; display: inline-block;
            -webkit-touch-callout: none; -webkit-user-select: none;
            -khtml-user-select: none; -moz-user-select: none;
            -ms-user-select: none; user-select: none;
            padding: 0 4px; width: 4em;
            color: #aaaaaa;
          }
        pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
        div.sourceCode
          {   }
        @media screen {
        pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
        }
        code span.al { color: #ff0000; font-weight: bold; } /* Alert */
        code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
        code span.at { color: #7d9029; } /* Attribute */
        code span.bn { color: #40a070; } /* BaseN */
        code span.bu { } /* BuiltIn */
        code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
        code span.ch { color: #4070a0; } /* Char */
        code span.cn { color: #880000; } /* Constant */
        code span.co { color: #60a0b0; font-style: italic; } /* Comment */
        code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
        code span.do { color: #ba2121; font-style: italic; } /* Documentation */
        code span.dt { color: #902000; } /* DataType */
        code span.dv { color: #40a070; } /* DecVal */
        code span.er { color: #ff0000; font-weight: bold; } /* Error */
        code span.ex { } /* Extension */
        code span.fl { color: #40a070; } /* Float */
        code span.fu { color: #06287e; } /* Function */
        code span.im { } /* Import */
        code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
        code span.kw { color: #007020; font-weight: bold; } /* Keyword */
        code span.op { color: #666666; } /* Operator */
        code span.ot { color: #007020; } /* Other */
        code span.pp { color: #bc7a00; } /* Preprocessor */
        code span.sc { color: #4070a0; } /* SpecialChar */
        code span.ss { color: #bb6688; } /* SpecialString */
        code span.st { color: #4070a0; } /* String */
        code span.va { color: #19177c; } /* Variable */
        code span.vs { color: #4070a0; } /* VerbatimString */
        code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
                </head>

<body>


    <div class="uk-container uk-container-center uk-margin-top uk-margin-large-bottom">

                <div class="uk-grid" data-uk-grid-margin>
            <div class="uk-width-1-1">
                <h1 class="uk-heading-large">HARDE - SÉCURISATION D’UN SYSTÈME RED HAT 8.x</h1>
                                                <p class="uk-text-large">Pierre Blanchet</p>
                            </div>
        </div>
        
        <div class="uk-grid" data-uk-grid-margin>
            <div class="uk-width-medium-1-4">
                <div class="uk-overflow-container" data-uk-sticky="{top:25,media: 768}">
                    <div class="uk-panel uk-panel-box menu-begin">

                                                <ul>
                                                <li><a href="#principes-de-base">Principes de base</a>
                                                <ul>
                                                <li><a href="#installation">Installation</a></li>
                                                <li><a href="#application-automatique">Application automatique</a></li>
                                                <li><a href="#finalisation-de-la-sécurisation">Finalisation de la sécurisation</a></li>
                                                <li><a href="#audit">Audit</a></li>
                                                </ul></li>
                                                <li><a href="#installation-du-système">Installation du système</a>
                                                <ul>
                                                <li><a href="#sur-une-machine-virtuelle">Sur une machine virtuelle</a></li>
                                                <li><a href="#depuis-une-image-iso">Depuis une image ISO</a></li>
                                                <li><a href="#sécurisation">Sécurisation</a>
                                                <ul>
                                                <li><a href="#lancer-le-script-de-sécurisation">Lancer le script de sécurisation</a></li>
                                                <li><a href="#opérations-manuelles">Opérations Manuelles</a></li>
                                                <li><a href="#correctifs">Correctifs</a></li>
                                                <li><a href="#documents-à-établir">Documents à établir</a></li>
                                                </ul></li>
                                                <li><a href="#vérifier-la-bonne-application-des-règles">Vérifier la bonne application des règles</a></li>
                                                </ul></li>
                                                <li><a href="#catalogue-des-regles-de-securisation">CATALOGUE DES REGLES DE SECURISATION</a>
                                                <ul>
                                                <li><a href="#harde-rhel-001-minimisation-des-services-installés">HARDE-RHEL-001 : Minimisation des services installés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre">Méthode à suivre</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-002-minimisation-de-la-configuration">HARDE-RHEL-002 : Minimisation de la configuration</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation">Méthode d’implémentation</a></li>
                                                <li><a href="#méthode-daudit-1">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-003-principe-de-moindre-privilège">HARDE-RHEL-003 : Principe de moindre privilège</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-1">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-004-utilisation-des-fonctions-de-contrôles-daccès">HARDE-RHEL-004 : Utilisation des fonctions de contrôles d’accès</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-2">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-005-principe-de-défense-en-profondeur">HARDE-RHEL-005 : Principe de défense en profondeur</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-3">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-006-cloisonnement-des-services-réseaux">HARDE-RHEL-006 : Cloisonnement des services réseaux</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-4">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-007-journalisation-de-lactivité-des-services">HARDE-RHEL-007 : Journalisation de l’activité des services</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-5">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-008-mises-à-jour-régulières">HARDE-RHEL-008 : Mises à jour régulières</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-6">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-009-configuration-matérielle">HARDE-RHEL-009 : Configuration matérielle</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-7">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-010-architecture-32-et-64-bits">HARDE-RHEL-010 : Architecture 32 et 64 bits</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-8">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-011-désactiver-les-systèmes-de-fichiers-inutilisés">HARDE-RHEL-011 : Désactiver les systèmes de fichiers inutilisés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-1">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-2">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-012-partition-séparée-pour-home">HARDE-RHEL-012 : Partition séparée pour /home</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-2">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-3">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-013-options-de-montage-nodevnosuidnoexec-pour-devshm">HARDE-RHEL-013 : Options de montage nodev,nosuid,noexec pour /dev/shm</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-9">Méthode d’implémentation</a></li>
                                                <li><a href="#méthode-daudit-4">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-014-options-de-montage-nodevnosuidnoexec-pour-les-points-de-montage-temporaire">HARDE-RHEL-014 : Options de montage nodev,nosuid,noexec pour les points de montage temporaire</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-10">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-015-sassurer-de-la-configuration-de-tmp">HARDE-RHEL-015 : S’assurer de la configuration de /tmp</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-3">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-5">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-016-désactiver-le-stockage-usb">HARDE-RHEL-016 : Désactiver le stockage USB</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-4">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-6">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-017-sassurer-de-la-configuration-de-var">HARDE-RHEL-017 : S’assurer de la configuration de /var</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-5">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-7">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-018-sassurer-de-la-configuration-de-vartmp">HARDE-RHEL-018 : S’assurer de la configuration de /var/tmp</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-6">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-8">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-019-partitionnement-type">HARDE-RHEL-019 : Partitionnement type</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-7">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-9">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-020-restrictions-daccès-sur-le-dossier-boot">HARDE-RHEL-020 : Restrictions d’accès sur le dossier /boot</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-11">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-021-installation-de-paquets-réduite-au-strict-nécessaire">HARDE-RHEL-021 : Installation de paquets réduite au strict nécessaire</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-12">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-022-choix-des-dépôts-de-paquets">HARDE-RHEL-022 : Choix des dépôts de paquets</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-13">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-023-dépôts-de-paquets-durcis">HARDE-RHEL-023 : Dépôts de paquets durcis</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-14">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-024-robustesse-du-mot-de-passe-administrateur">HARDE-RHEL-024 : Robustesse du mot de passe administrateur</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-15">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-025-installation-déléments-secrets-ou-de-confiance">HARDE-RHEL-025 : Installation d’éléments secrets ou de confiance</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-16">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-026-sassurer-que-les-politiques-de-chiffrement-historiques-soient-désactivées">HARDE-RHEL-026 : S’assurer que les politiques de chiffrement historiques soient désactivées</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-8">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-10">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-027-sassurer-que-le-mode-fips-ou-future-est-activé-pour-le-chiffrement">HARDE-RHEL-027 : S’assurer que le mode FIPS ou FUTURE est activé pour le chiffrement</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-9">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-11">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-028-sassurer-que-lip-forwarding-est-désactivé">HARDE-RHEL-028 : S’assurer que l’IP Forwarding est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-10">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-12">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-029-désactiver-les-icmp-redirects">HARDE-RHEL-029 : Désactiver les ICMP Redirects</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-11">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-13">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-030-refuser-les-paquets-routés-par-la-source">HARDE-RHEL-030 : Refuser les paquets routés par la source</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-12">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-14">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-031-sassurer-que-les-paquets-suspects-soient-journalisés">HARDE-RHEL-031 : S’assurer que les paquets suspects soient journalisés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-13">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-15">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-032-refuser-les-icmp-broadcast">HARDE-RHEL-032 : Refuser les ICMP broadcast</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-14">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-16">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-033-ignorer-les-réponses-icmp-douteuses">HARDE-RHEL-033 : Ignorer les réponses ICMP douteuses</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-15">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-17">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-034-activer-le-filtrage-par-routage-inversé">HARDE-RHEL-034 : Activer le filtrage par routage inversé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-16">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-18">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-035-activer-les-tcp-syn-cookies">HARDE-RHEL-035 : Activer les TCP Syn Cookies</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-17">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-19">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-036-refuser-les-paquets-ipv6-router-advertisements">HARDE-RHEL-036 : Refuser les paquets IPv6 Router Advertisements</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-17">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-037-désactiver-ipv6">HARDE-RHEL-037 : Désactiver IPV6</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-18">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-20">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-038-sassurer-que-la-politique-de-chiffrement-système-nest-pas-outrepassée">HARDE-RHEL-038 : S’assurer que la politique de chiffrement système n’est pas outrepassée</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-19">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-21">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-039-paramétrage-des-sysctl-réseau">HARDE-RHEL-039 : Paramétrage des sysctl réseau</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-20">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-22">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-040-permissions-des-fichiers-de-configuration-du-démarrage">HARDE-RHEL-040 : Permissions des fichiers de configuration du démarrage</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-21">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-23">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-041-verrouiller-par-mot-de-passe-la-configuration-de-demarrage">HARDE-RHEL-041 : Verrouiller par mot de passe la configuration de demarrage</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-22">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-24">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-042-demander-un-mot-de-passe-pour-les-modes-de-secours">HARDE-RHEL-042 : Demander un mot de passe pour les modes de secours</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-18">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-043-directive-de-configuration-de-liommu">HARDE-RHEL-043 : Directive de configuration de l’IOMMU</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-23">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-25">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-044-configurer-la-connexion-red-hat-subscription-manager">HARDE-RHEL-044 : Configurer la connexion Red Hat Subscription Manager</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-24">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-26">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-045-désactiver-le-démon-rhnsd">HARDE-RHEL-045 : Désactiver le démon rhnsd</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-25">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-27">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-046-sassurer-que-les-clés-pgp-soient-configurées">HARDE-RHEL-046 : S’assurer que les clés PGP soient configurées</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-19">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-047-activer-loption-gpgcheck">HARDE-RHEL-047 : Activer l’option gpgcheck</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-20">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-048-sassurer-que-les-dépôts-soient-configurés">HARDE-RHEL-048 : S’assurer que les dépôts soient configurés</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-21">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-049-sassurer-que-les-mises-à-jour-de-sécurité-sont-installées">HARDE-RHEL-049 : S’assurer que les mises à jour de sécurité sont installées</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-22">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-050-activer-le-démon-cron">HARDE-RHEL-050 : Activer le démon cron</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-26">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-28">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-051-services-et-démons-résidents-en-mémoire">HARDE-RHEL-051 : Services et démons résidents en mémoire</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-23">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-052-restriction-des-accès-des-services-déployés">HARDE-RHEL-052 : Restriction des accès des services déployés</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-24">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-053-durcissement-des-composants-de-virtualisation">HARDE-RHEL-053 : Durcissement des composants de virtualisation</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-25">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-054-cage-chroot-et-privilèges-daccès-du-service-cloisonné">HARDE-RHEL-054 : Cage chroot et privilèges d’accès du service cloisonné</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-26">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-055-activation-et-utilisation-de-chroot-par-un-service">HARDE-RHEL-055 : Activation et utilisation de chroot par un service</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-27">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-056-ne-pas-installer-xinetd">HARDE-RHEL-056 : Ne pas installer xinetd</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-27">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-29">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-057-sassurer-que-le-serveur-ftp-est-désactivé">HARDE-RHEL-057 : S’assurer que le serveur FTP est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-28">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-30">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-058-sassurer-que-le-serveur-dns-est-désactivé">HARDE-RHEL-058 : S’assurer que le serveur DNS est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-29">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-31">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-059-sassurer-que-nfs-est-désactivé">HARDE-RHEL-059 : S’assurer que NFS est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-30">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-32">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-060-sassurer-que-rpc-est-désactivé">HARDE-RHEL-060 : S’assurer que RPC est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-31">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-33">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-061-sassurer-que-le-serveur-ldap-est-désactivé">HARDE-RHEL-061 : S’assurer que le serveur LDAP est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-32">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-34">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-062-sassurer-que-le-serveur-dhcp-est-désactivé">HARDE-RHEL-062 : S’assurer que le serveur DHCP est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-33">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-35">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-063-sassurer-que-le-serveur-cups-est-désactivé">HARDE-RHEL-063 : S’assurer que le serveur CUPS est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-34">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-36">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-064-sassurer-que-le-serveur-nis-est-désactivé">HARDE-RHEL-064 : S’assurer que le serveur NIS est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-35">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-37">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-065-sassurer-que-lagent-de-transfert-de-mail-soit-en-mode-local-seulement">HARDE-RHEL-065 : S’assurer que l’agent de transfert de mail soit en mode local seulement</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-28">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-066-désactiver-le-service-rsyncd">HARDE-RHEL-066 : Désactiver le service rsyncd</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-36">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-38">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-067-sassurer-que-le-serveur-avahi-est-désactivé">HARDE-RHEL-067 : S’assurer que le serveur Avahi est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-37">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-39">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-068-sassurer-que-le-serveur-snmp-est-désactivé">HARDE-RHEL-068 : S’assurer que le serveur SNMP est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-38">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-40">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-069-sassurer-que-le-service-proxy-http-est-désactivé">HARDE-RHEL-069 : S’assurer que le service Proxy HTTP est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-39">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-41">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-070-sassurer-que-le-service-samba-est-désactivé">HARDE-RHEL-070 : S’assurer que le service Samba est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-40">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-42">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-071-sassurer-que-le-service-imappop3-est-désactivé">HARDE-RHEL-071 : S’assurer que le service IMAP/POP3 est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-41">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-43">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-072-sassurer-que-le-serveur-http-est-désactivé">HARDE-RHEL-072 : S’assurer que le serveur HTTP est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-42">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-44">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-073-désactiver-les-protocoles-ddcp-sctp-rds-et-tipc">HARDE-RHEL-073 : Désactiver les protocoles DDCP, SCTP, RDS et TIPC</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-29">Méthode d’implémentation</a></li>
                                                <li><a href="#méthode-daudit-45">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-074-durcissement-et-surveillance-des-services-soumis-à">HARDE-RHEL-074 : Durcissement et surveillance des services soumis à</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-30">Méthode d’implémentation</a></li>
                                                <li><a href="#méthode-daudit-46">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-075-configuration-du-service-local-de-messagerie">HARDE-RHEL-075 : Configuration du service local de messagerie</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-31">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-076-alias-de-messagerie-des-comptes-de-service">HARDE-RHEL-076 : Alias de messagerie des comptes de service</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-32">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-077-sassurer-que-firewalld-est-installé">HARDE-RHEL-077 : S’assurer que firewalld est installé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-43">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-47">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-078-activer-le-service-firewalld">HARDE-RHEL-078 : Activer le service firewalld</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-44">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-48">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-079-désactiver-iptables">HARDE-RHEL-079 : Désactiver iptables</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-45">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-49">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-080-désactiver-nftables">HARDE-RHEL-080 : Désactiver nftables</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-46">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-50">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-081-sassurer-quune-zone-par-défaut-est-définie">HARDE-RHEL-081 : S’assurer qu’une zone par défaut est définie</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-47">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-51">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-082-sassurer-que-les-interfaces-soient-assignées-à-une-zone">HARDE-RHEL-082 : S’assurer que les interfaces soient assignées à une zone</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-48">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-52">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-083-bloquer-les-services-et-ports-inutiles">HARDE-RHEL-083 : Bloquer les services et ports inutiles</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-49">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-53">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-084-configurer-nftables">HARDE-RHEL-084 : Configurer nftables</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-33">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-085-configurer-iptables">HARDE-RHEL-085 : Configurer iptables</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-34">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-086-désactiver-les-interfaces-sans-fil">HARDE-RHEL-086 : Désactiver les interfaces sans fil</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-50">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-54">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-087-activation-de-selinux-avec-la-politique-targeted">HARDE-RHEL-087 : Activation de SELinux avec la politique targeted</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-51">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-55">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-088-désinstallation-des-outils-de-débogage-de-politique-selinux">HARDE-RHEL-088 : Désinstallation des outils de débogage de politique SELinux</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-52">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-56">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-089-sassurer-que-atcron-est-restreint-aux-utilisateurs-autorisés">HARDE-RHEL-089 : S’assurer que at/cron est restreint aux utilisateurs autorisés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-53">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-57">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-090-sassurer-que-laccès-ssh-soit-limité">HARDE-RHEL-090 : S’assurer que l’accès SSH soit limité</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-54">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-58">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-091-sassurer-que-laccès-à-la-commande-su-est-limité">HARDE-RHEL-091 : S’assurer que l’accès à la commande su est limité</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-55">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-59">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-092-sassurer-de-lintégrité-de-la-variable-path-pour-root">HARDE-RHEL-092 : S’assurer de l’intégrité de la variable PATH pour root</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-35">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-093-imputabilité-des-opérations-dadministration">HARDE-RHEL-093 : Imputabilité des opérations d’administration</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-36">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-094-répertoires-temporaires-dédiés-aux-comptes">HARDE-RHEL-094 : Répertoires temporaires dédiés aux comptes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-56">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-60">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-095-activation-des-profils-de-sécurité-apparmor">HARDE-RHEL-095 : Activation des profils de sécurité AppArmor</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-37">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-096-paramétrage-des-booléens-selinux">HARDE-RHEL-096 : Paramétrage des booléens SELinux</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-57">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-61">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-097-confinement-des-utilisateurs-interactifs-non-privilégiés">HARDE-RHEL-097 : Confinement des utilisateurs interactifs non privilégiés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-58">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-62">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-098-utiliser-une-source-de-temps">HARDE-RHEL-098 : Utiliser une source de temps</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-59">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-63">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-099-sassurer-que-chrony-est-configuré">HARDE-RHEL-099 : S’assurer que chrony est configuré</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-38">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-100-service-autofs-désactivé">HARDE-RHEL-100 : Service autofs désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-39">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-101-supprimer-le-serveur-x">HARDE-RHEL-101 : Supprimer le serveur X</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-60">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-64">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-102-sassurer-que-le-client-nis-nest-pas-installé">HARDE-RHEL-102 : S’assurer que le client NIS n’est pas installé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-61">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-65">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-103-sassurer-que-le-client-telnet-nest-pas-installé">HARDE-RHEL-103 : S’assurer que le client telnet n’est pas installé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-62">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-66">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-104-sassurer-que-le-client-ldap-nest-pas-installé">HARDE-RHEL-104 : S’assurer que le client ldap n’est pas installé</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-40">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-105-sassurer-que-le-paramètre-ssh-allowtcpforwarding-est-désactivé">HARDE-RHEL-105 : S’assurer que le paramètre SSH AllowTcpForwarding est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-63">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-67">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-106-sassurer-que-le-transfert-x11-ssh-est-désactivé">HARDE-RHEL-106 : S’assurer que le transfert X11 SSH est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-64">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-68">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-107-installer-sudo">HARDE-RHEL-107 : Installer sudo</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-65">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-69">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-108-sassurer-que-les-commandes-sudo-utilisent-un-pseudo-tty-et-autres-directives">HARDE-RHEL-108 : S’assurer que les commandes sudo utilisent un pseudo-TTY et autres directives</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-66">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-70">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-109-afficher-des-bannières-lors-de-la-connexion">HARDE-RHEL-109 : Afficher des bannières lors de la connexion</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-67">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-71">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-110-sassurer-que-le-paramètre-ssh-root-login-est-désactivé">HARDE-RHEL-110 : S’assurer que le paramètre SSH root login est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-68">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-72">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-111-sassurer-que-le-paramètre-ssh-permitemptypasswords-est-désactivé">HARDE-RHEL-111 : S’assurer que le paramètre SSH PermitEmptyPasswords est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-69">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-73">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-112-sassurer-que-le-paramètre-ssh-permituserenvironment-est-désactivé">HARDE-RHEL-112 : S’assurer que le paramètre SSH PermitUserEnvironment est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-70">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-74">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-113-sassurer-que-le-paramètre-ssh-idle-timeout-interval-est-configuré">HARDE-RHEL-113 : S’assurer que le paramètre SSH Idle Timeout Interval est configuré</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-71">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-75">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-114-sassurer-que-le-paramètre-ssh-logingracetime-est-positionné-à-une-minute-ou-moins">HARDE-RHEL-114 : S’assurer que le paramètre SSH LoginGraceTime est positionné à une minute ou moins</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-72">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-76">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-115-sassurer-que-la-bannière-ssh-est-configurée">HARDE-RHEL-115 : S’assurer que la bannière SSH est configurée</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-73">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-77">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-116-sassurer-que-le-paramétrage-ssh-pam-est-activé">HARDE-RHEL-116 : S’assurer que le paramétrage SSH PAM est activé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-74">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-78">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-117-sassurer-que-le-paramètre-ssh-maxstartups-est-configuré">HARDE-RHEL-117 : S’assurer que le paramètre SSH MaxStartups est configuré</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-75">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-79">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-118-sassurer-que-le-paramètre-ssh-maxsessions-est-positionné-à-4-ou-moins">HARDE-RHEL-118 : S’assurer que le paramètre SSH MaxSessions est positionné à 4 ou moins</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-76">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-80">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-119-sassurer-que-le-paramètre-ssh-maxauthtries-est-positionné-à-4-ou-moins">HARDE-RHEL-119 : S’assurer que le paramètre SSH MaxAuthTries est positionné à 4 ou moins</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-77">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-81">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-120-sassurer-que-le-paramètre-ssh-ignorerhosts-est-activé">HARDE-RHEL-120 : S’assurer que le paramètre SSH IgnoreRhosts est activé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-78">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-82">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-121-sassurer-que-le-paramètre-ssh-hostbasedauthentication-est-désactivé">HARDE-RHEL-121 : S’assurer que le paramètre SSH HostbasedAuthentication est désactivé</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-41">Méthode d’implémentation</a></li>
                                                <li><a href="#méthode-daudit-83">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-122-créer-un-profil-authselect-personnalisé">HARDE-RHEL-122 : Créer un profil authselect personnalisé</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-42">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-123-selectionner-le-profil-authselect">HARDE-RHEL-123 : Selectionner le profil authselect</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-43">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-124-sassurer-que-le-paramétrage-authselect-inclus-with-faillock">HARDE-RHEL-124 : S’assurer que le paramétrage authselect inclus with-faillock</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-44">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-125-sassurer-que-les-exigences-de-création-de-mot-de-passe-soient-correctes">HARDE-RHEL-125 : S’assurer que les exigences de création de mot de passe soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-79">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-84">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-126-sassurer-que-le-verrouillage-après-des-tentatives-de-connexion-soit-configuré">HARDE-RHEL-126 : S’assurer que le verrouillage après des tentatives de connexion soit configuré</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-45">Méthode d’implémentation</a></li>
                                                <li><a href="#méthode-daudit-85">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-127-sassurer-que-la-réutilisation-danciens-mots-de-passe-soit-limitée">HARDE-RHEL-127 : S’assurer que la réutilisation d’anciens mots de passe soit limitée</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-80">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-86">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-128-protection-des-mots-de-passe-stockés">HARDE-RHEL-128 : Protection des mots de passe stockés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-81">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-87">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-129-sassurer-que-lexpiration-des-mots-de-passe-soit-de-365-jours-ou-moins">HARDE-RHEL-129 : S’assurer que l’expiration des mots de passe soit de 365 jours ou moins</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-82">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-88">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-130-sassurer-que-le-nombre-minimum-de-jours-entre-2-changements-de-mot-de-passe-soit-7-ou-plus">HARDE-RHEL-130 : S’assurer que le nombre minimum de jours entre 2 changements de mot de passe soit 7 ou plus</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-83">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-89">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-131-sassurer-que-lalerte-pour-expiration-de-mot-de-passe-soit-émise-7-jours-ou-plus-avant-expiration-du-mot-de-passe">HARDE-RHEL-131 : S’assurer que l’alerte pour expiration de mot de passe soit émise 7 jours ou plus avant expiration du mot de passe</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-84">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-90">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-132-sassurer-que-le-verrouillage-des-comptes-inutilisés-soit-de-30-jours-ou-moins">HARDE-RHEL-132 : S’assurer que le verrouillage des comptes inutilisés soit de 30 jours ou moins</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-85">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-91">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-133-sassurer-que-toutes-les-dates-de-changement-de-mot-de-passe-sont-dans-le-passé">HARDE-RHEL-133 : S’assurer que toutes les dates de changement de mot de passe sont dans le passé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-86">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-92">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-134-sassurer-que-les-comptes-système-soient-sécurisés">HARDE-RHEL-134 : S’assurer que les comptes système soient sécurisés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-87">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-93">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-135-sassurer-que-la-temporisation-par-défaut-des-shell-utilisateurs-soit-de-900-secondes-ou-moins">HARDE-RHEL-135 : S’assurer que la temporisation par défaut des shell utilisateurs soit de 900 secondes ou moins</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-88">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-94">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-136-sassurer-que-le-groupe-par-défaut-du-compte-root-est-0">HARDE-RHEL-136 : S’assurer que le groupe par défaut du compte root est 0</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-89">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-95">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-137-sassurer-que-la-connexion-est-root-est-seulement-possible-sur-la-console-system">HARDE-RHEL-137 : S’assurer que la connexion est root est seulement possible sur la console system</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-90">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-96">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-138-sassurer-quaucun-mot-de-passe-nest-vide">HARDE-RHEL-138 : S’assurer qu’aucun mot de passe n’est vide</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-46">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-139-sassurer-que-quaucune-entrée-dans-etcpasswd-nutilise-le-code-historique">HARDE-RHEL-139 : S’assurer que qu’aucune entrée dans /etc/passwd n’utilise le code historique “+”</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-47">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-140-sassurer-que-quaucune-entrée-dans-etcshadow-nutilise-le-code-historique">HARDE-RHEL-140 : S’assurer que qu’aucune entrée dans /etc/shadow n’utilise le code historique “+”</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-48">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-141-sassurer-que-quaucune-entrée-dans-etcgroup-nutilise-le-code-historique">HARDE-RHEL-141 : S’assurer que qu’aucune entrée dans /etc/group n’utilise le code historique “+”</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-49">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-142-sassurer-que-root-est-le-seul-compte-avec-uid-0">HARDE-RHEL-142 : S’assurer que root est le seul compte avec UID 0</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-50">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-143-désactivation-des-comptes-utilisateurs-inutilisés">HARDE-RHEL-143 : Désactivation des comptes utilisateurs inutilisés</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-51">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-144-désactivation-des-comptes-de-services">HARDE-RHEL-144 : Désactivation des comptes de services</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-52">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-145-unicité-et-exclusivité-des-comptes-de-services">HARDE-RHEL-145 : Unicité et exclusivité des comptes de services</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-53">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-146-délai-dexpiration-de-sessions-utilisateurs">HARDE-RHEL-146 : Délai d’expiration de sessions utilisateurs</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-54">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-147-applications-utilisant-pam">HARDE-RHEL-147 : Applications utilisant PAM</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-55">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-148-sécurisation-des-services-réseau-dauthentification-pam">HARDE-RHEL-148 : Sécurisation des services réseau d’authentification PAM</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-91">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-97">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-149-sécurisation-des-accès-aux-bases-utilisateurs-distantes">HARDE-RHEL-149 : Sécurisation des accès aux bases utilisateurs distantes</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-56">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-150-séparation-des-comptes-système-et-dadministrateur-de-lannuaire">HARDE-RHEL-150 : Séparation des comptes système et d’administrateur de l’annuaire</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-57">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-151-groupe-dédié-à-lusage-de-sudo">HARDE-RHEL-151 : Groupe dédié à l’usage de sudo</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-92">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-98">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-152-authentification-des-utilisateurs-exécutant-sudo">HARDE-RHEL-152 : Authentification des utilisateurs exécutant sudo</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-93">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-99">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-153-privilèges-des-utilisateurs-cibles-pour-une-commande-sudo">HARDE-RHEL-153 : Privilèges des utilisateurs cibles pour une commande sudo</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-58">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-154-limitation-du-nombre-de-commandes-nécessitant-loption-exec">HARDE-RHEL-154 : Limitation du nombre de commandes nécessitant l’option EXEC</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-59">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-155-du-bon-usage-de-la-négation-dans-une-spécification-sudo">HARDE-RHEL-155 : Du bon usage de la négation dans une spécification sudo</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-60">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-156-arguments-explicites-dans-les-spécifications-sudo">HARDE-RHEL-156 : Arguments explicites dans les spécifications sudo</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-61">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-157-du-bon-usage-de-sudoedit">HARDE-RHEL-157 : Du bon usage de sudoedit</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-62">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-158-sticky-bit-et-droits-daccès-en-écriture">HARDE-RHEL-158 : Sticky bit et droits d’accès en écriture</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-63">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-159-installer-aide">HARDE-RHEL-159 : Installer AIDE</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-94">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-100">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-160-vérification-régulière-de-lintégrité-de-système-de-fichiers">HARDE-RHEL-160 : Vérification régulière de l’intégrité de système de fichiers</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-95">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-101">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-161-sassurer-que-les-permissions-sur-etccrontab-soient-correctes">HARDE-RHEL-161 : S’assurer que les permissions sur /etc/crontab soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-96">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-102">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-162-sassurer-que-les-permissions-sur-etccron.hourly-soient-correctes">HARDE-RHEL-162 : S’assurer que les permissions sur /etc/cron.hourly soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-97">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-103">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-163-sassurer-que-les-permissions-sur-etccron.daily-soient-correctes">HARDE-RHEL-163 : S’assurer que les permissions sur /etc/cron.daily soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-98">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-104">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-164-sassurer-que-les-permissions-sur-etccron.weekly-soient-correctes">HARDE-RHEL-164 : S’assurer que les permissions sur /etc/cron.weekly soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-99">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-105">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-165-sassurer-que-les-permissions-sur-etccron.monthly-soient-correctes">HARDE-RHEL-165 : S’assurer que les permissions sur /etc/cron.monthly soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-100">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-106">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-166-sassurer-que-les-permissions-sur-etccron.d-soient-correctes">HARDE-RHEL-166 : S’assurer que les permissions sur /etc/cron.d soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-101">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-107">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-167-sassurer-que-les-permissions-sur-etcsshsshd_config-soient-correctes">HARDE-RHEL-167 : S’assurer que les permissions sur /etc/ssh/sshd_config soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-102">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-108">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-168-sassurer-que-les-permissions-sur-les-clés-privées-dhôte-ssh-soient-correctes">HARDE-RHEL-168 : S’assurer que les permissions sur les clés privées d’hôte SSH soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-103">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-109">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-169-sassurer-que-les-permissions-sur-les-clés-publiques-dhôte-soient-correctes">HARDE-RHEL-169 : S’assurer que les permissions sur les clés publiques d’hôte soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-104">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-110">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-170-sassurer-que-lumask-utilisateur-est-ou-plus-restrictif">HARDE-RHEL-170 : S’assurer que l’umask utilisateur est ou plus restrictif</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-105">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-111">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-171-auditer-les-permissions-du-système-de-fichiers">HARDE-RHEL-171 : Auditer les permissions du système de fichiers</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-64">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-172-sassurer-quaucun-fichier-en-écriture-pour-tout-le-monde-nexiste">HARDE-RHEL-172 : S’assurer qu’aucun fichier en écriture pour tout le monde n’existe</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-65">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-173-sassurer-que-tous-les-fichiers-ont-un-propriétaire">HARDE-RHEL-173 : S’assurer que tous les fichiers ont un propriétaire</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-66">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-174-sassurer-que-tous-les-fichiers-ont-un-groupe">HARDE-RHEL-174 : S’assurer que tous les fichiers ont un groupe</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-67">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-175-auditer-les-exécutables-suid">HARDE-RHEL-175 : Auditer les exécutables SUID</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-106">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-112">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-176-auditer-les-exécutables-sgid">HARDE-RHEL-176 : Auditer les exécutables SGID</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-107">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-113">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-177-sassurer-que-les-permissions-sur-etcpasswd-soient-correctes">HARDE-RHEL-177 : S’assurer que les permissions sur /etc/passwd soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-108">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-114">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-178-sassurer-que-les-permissions-sur-etcshadow-soient-correctes">HARDE-RHEL-178 : S’assurer que les permissions sur /etc/shadow soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-109">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-115">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-179-sassurer-que-les-permissions-sur-etcgroup-soient-correctes">HARDE-RHEL-179 : S’assurer que les permissions sur /etc/group soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-110">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-116">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-180-sassurer-que-les-permissions-sur-etcgshadow-soient-correctes">HARDE-RHEL-180 : S’assurer que les permissions sur /etc/gshadow soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-111">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-117">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-181-sassurer-que-les-permissions-sur-etcpasswd--soient-correctes">HARDE-RHEL-181 : S’assurer que les permissions sur /etc/passwd- soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-112">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-118">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-182-sassurer-que-les-permissions-sur-etcshadow--soient-correctes">HARDE-RHEL-182 : S’assurer que les permissions sur /etc/shadow- soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-113">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-119">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-183-sassurer-que-les-permissions-sur-etcgroup--soient-correctes">HARDE-RHEL-183 : S’assurer que les permissions sur /etc/group- soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-114">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-120">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-184-sassurer-que-les-permissions-sur-etcgshadow--soient-correctes">HARDE-RHEL-184 : S’assurer que les permissions sur /etc/gshadow- soient correctes</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-115">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-121">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-185-sassurer-que-les-utilisateurs-nont-pas-de-fichier-.forward">HARDE-RHEL-185 : S’assurer que les utilisateurs n’ont pas de fichier .forward</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-68">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-186-sassurer-que-les-utilisateurs-nont-pas-de-fichier-.netrc">HARDE-RHEL-186 : S’assurer que les utilisateurs n’ont pas de fichier .netrc</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-69">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-187-sassurer-que-les-fichiers-.netrc-ne-soint-pas-accessibles-en-écriture">HARDE-RHEL-187 : S’assurer que les fichiers .netrc ne soint pas accessibles en écriture</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-70">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-188-sassurer-quil-nexiste-pas-de-fichier-.rhosts">HARDE-RHEL-188 : S’assurer qu’il n’existe pas de fichier .rhosts</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-71">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-189-sassurer-que-tous-les-groupes-de-etcpasswd-existent-dans-etcgroup">HARDE-RHEL-189 : S’assurer que tous les groupes de /etc/passwd existent dans /etc/group</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-72">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-190-sassurer-quil-ny-a-pas-duids-dupliqués">HARDE-RHEL-190 : S’assurer qu’il n’y a pas d’UIDs dupliqués</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-73">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-191-sassurer-quil-ny-a-pas-de-gids-dupliqués">HARDE-RHEL-191 : S’assurer qu’il n’y a pas de GIDs dupliqués</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-74">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-192-sassurer-quil-ny-a-pas-de-de-doublons-dans-les-noms-dutilisateur">HARDE-RHEL-192 : S’assurer qu’il n’y a pas de de doublons dans les noms d’utilisateur</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-75">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-193-sassurer-que-quil-ny-a-pas-de-de-doublons-dans-les-noms-de-groupe">HARDE-RHEL-193 : S’assurer que qu’il n’y a pas de de doublons dans les noms de groupe</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-76">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-194-sassurer-quil-ny-a-pas-de-groupe-shadow">HARDE-RHEL-194 : S’assurer qu’il n’y a pas de groupe shadow</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-77">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-195-vérifier-que-tous-les-utilisateurs-aient-un-répertoire-daccueil">HARDE-RHEL-195 : Vérifier que tous les utilisateurs aient un répertoire d’accueil</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-78">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-196-sassurer-que-les-permissions-sur-les-répertoire-daccueil-des-utilisateurs-soit-750-ou-plus-restrictif">HARDE-RHEL-196 : S’assurer que les permissions sur les répertoire d’accueil des utilisateurs soit 750 ou plus restrictif</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-79">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-197-sassurer-que-les-utilisateurs-possèdent-leurs-répertoires-daccueil">HARDE-RHEL-197 : S’assurer que les utilisateurs possèdent leurs répertoires d’accueil</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-80">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-198-sassurer-que-les-fichiers-de-configuration-des-utilisateurs-ne-soient-pas-ouverts-en-écriture-au-groupe-ou-à-tout-le-monde">HARDE-RHEL-198 : S’assurer que les fichiers de configuration des utilisateurs ne soient pas ouverts en écriture au groupe ou à tout le monde</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-81">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-199-droits-daccès-aux-fichiers-de-contenu-sensible">HARDE-RHEL-199 : Droits d’accès aux fichiers de contenu sensible</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-82">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-200-sécurisation-des-accès-pour-les-sockets-et-pipes">HARDE-RHEL-200 : Sécurisation des accès pour les sockets et pipes</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-83">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-201-protection-de-la-base-de-données-des-scellés">HARDE-RHEL-201 : Protection de la base de données des scellés</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-84">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-202-désactiver-la-création-de-core-dumps">HARDE-RHEL-202 : Désactiver la création de core dumps</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-116">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-122">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-203-activer-laléatoire-dans-lorganisation-de-lespace-dadressage">HARDE-RHEL-203 : Activer l’aléatoire dans l’organisation de l’espace d’adressage</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-117">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-123">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-204-paramétrage-des-sysctl-système">HARDE-RHEL-204 : Paramétrage des sysctl système</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-118">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-124">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-205-désactivation-du-chargement-des-modules-noyau">HARDE-RHEL-205 : Désactivation du chargement des modules noyau</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-119">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-125">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-206-configuration-sysctl-du-module-yama">HARDE-RHEL-206 : Configuration sysctl du module Yama</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-120">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-126">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-207-partition-séparée-pour-varlog">HARDE-RHEL-207 : Partition séparée pour /var/log</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-121">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-127">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-208-partition-séparée-pour-varlogaudit">HARDE-RHEL-208 : Partition séparée pour /var/log/audit</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-122">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-128">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-209-journal-spécifique-pour-sudo">HARDE-RHEL-209 : Journal spécifique pour sudo</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-123">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-129">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-210-sassurer-quauditd-est-installé">HARDE-RHEL-210 : S’assurer qu’auditd est installé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-124">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-130">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-211-sassurer-que-le-service-auditd-est-activé">HARDE-RHEL-211 : S’assurer que le service auditd est activé</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-125">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-131">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-212-sassurer-que-laudit-commence-au-plus-tôt">HARDE-RHEL-212 : S’assurer que l’audit commence au plus tôt</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-126">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-132">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-213-sassurer-que-la-valeur-daudit_backlog_limit-est-suffisante">HARDE-RHEL-213 : S’assurer que la valeur d’audit_backlog_limit est suffisante</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-127">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-133">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-214-tracer-les-tentatives-daccès-aux-fichiers-refusées">HARDE-RHEL-214 : Tracer les tentatives d’accès aux fichiers refusées</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-128">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-134">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-215-tracer-les-modifications-dutilisateurs">HARDE-RHEL-215 : Tracer les modifications d’utilisateurs</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-129">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-135">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-216-journalisation-de-lactivité-par-auditd">HARDE-RHEL-216 : Journalisation de l’activité par auditd</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-130">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-136">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-217-tracer-lutilisation-des-commandes-privilégiés">HARDE-RHEL-217 : Tracer l’utilisation des commandes privilégiés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-131">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-137">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-218-tracer-les-suppressions-de-fichiers">HARDE-RHEL-218 : Tracer les suppressions de fichiers</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-132">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-138">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-219-tracer-le-chargementdéchargement-de-modules">HARDE-RHEL-219 : Tracer le chargement/déchargement de modules</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-133">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-139">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-220-tracer-les-actions-des-administrateurs">HARDE-RHEL-220 : Tracer les actions des administrateurs</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-134">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-140">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-221-sassurer-que-la-configuration-auditd-nest-pas-modifiable">HARDE-RHEL-221 : S’assurer que la configuration auditd n’est pas modifiable</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-135">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-141">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-222-sassurer-que-la-taille-de-stockage-est-spécifiée">HARDE-RHEL-222 : S’assurer que la taille de stockage est spécifiée</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-136">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-142">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-223-sassurer-que-les-logs-daudit-ne-soient-pas-purgés">HARDE-RHEL-223 : S’assurer que les logs d’audit ne soient pas purgés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-137">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-143">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-224-sassurer-que-le-système-sarrête-si-le-système-daudit-est-plein">HARDE-RHEL-224 : S’assurer que le système s’arrête si le système d’audit est plein</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-138">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-144">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-225-auditer-tout-changement-du-fichier-sudoers">HARDE-RHEL-225 : Auditer tout changement du fichier sudoers</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-139">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-145">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-226-auditer-toute-connexiondéconnexion">HARDE-RHEL-226 : Auditer toute connexion/déconnexion</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-140">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-146">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-227-collecter-toutes-les-informations-de-session">HARDE-RHEL-227 : Collecter toutes les informations de session</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-141">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-147">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-228-sassurer-que-les-évènements-de-changements-horaires-soient-tracés">HARDE-RHEL-228 : S’assurer que les évènements de changements horaires soient tracés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-142">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-148">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-229-sassurer-que-les-évènements-modifiant-les-mac-soient-collectés">HARDE-RHEL-229 : S’assurer que les évènements modifiant les MAC soient collectés</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-143">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-149">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-230-tracer-les-évènements-changeant-lenvironnement-réseau">HARDE-RHEL-230 : Tracer les évènements changeant l’environnement réseau</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-144">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-150">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-231-tracer-les-changements-de-permission">HARDE-RHEL-231 : Tracer les changements de permission</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-145">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-151">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-232-installer-le-service-rsyslog">HARDE-RHEL-232 : Installer le service rsyslog</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-146">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-152">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-233-activer-le-service-syslog">HARDE-RHEL-233 : Activer le service syslog</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-147">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-153">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-234-configurer-les-permissions-des-fichiers-journaux">HARDE-RHEL-234 : Configurer les permissions des fichiers journaux</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-148">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-154">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-235-définir-les-fichiers-journaux">HARDE-RHEL-235 : Définir les fichiers journaux</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-149">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-155">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-236-renvoyer-les-journaux-vers-un-hôte-distant">HARDE-RHEL-236 : Renvoyer les journaux vers un hôte distant</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-150">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-156">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-237-sassurer-que-seuls-les-puits-de-logs-peuvent-recevoir-des-logs">HARDE-RHEL-237 : S’assurer que seuls les puits de logs peuvent recevoir des logs</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-85">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-238-sassurer-que-journald-est-redirigé-vers-rsyslog">HARDE-RHEL-238 : S’assurer que journald est redirigé vers rsyslog</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-151">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-157">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-239-sassurer-que-journald-compresse-les-journaux-de-grande-taille">HARDE-RHEL-239 : S’assurer que journald compresse les journaux de grande taille</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-152">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-158">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-240-sassurer-que-journald-écrit-les-journaux-sur-disque">HARDE-RHEL-240 : S’assurer que journald écrit les journaux sur disque</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-153">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-159">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-241-sassurer-de-la-permission-des-fichiers-journaux">HARDE-RHEL-241 : S’assurer de la permission des fichiers journaux</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-154">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-160">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-242-sassurer-que-logrotate-est-configuré">HARDE-RHEL-242 : S’assurer que logrotate est configuré</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-155">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-161">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-243-sassurer-que-le-paramètre-ssh-loglevel-est-approprié">HARDE-RHEL-243 : S’assurer que le paramètre SSH LogLevel est approprié</a>
                                                <ul>
                                                <li><a href="#méthode-à-suivre-156">Méthode à suivre</a></li>
                                                <li><a href="#méthode-daudit-162">Méthode d’audit</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-244-durcissement-et-configuration-du-service-syslog">HARDE-RHEL-244 : Durcissement et configuration du service syslog</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-86">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-245-cloisonnement-du-service-syslog-par-chroot">HARDE-RHEL-245 : Cloisonnement du service syslog par chroot</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-87">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-246-cloisonnement-du-service-syslog-par-conteneur">HARDE-RHEL-246 : Cloisonnement du service syslog par conteneur</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-88">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                <li><a href="#harde-rhel-247-journaux-dactivité-de-service">HARDE-RHEL-247 : Journaux d’activité de service</a>
                                                <ul>
                                                <li><a href="#méthode-dimplémentation-89">Méthode d’implémentation</a></li>
                                                </ul></li>
                                                </ul></li>
                                                <li><a href="#utilisation-du-système">UTILISATION DU SYSTÈME</a>
                                                <ul>
                                                <li><a href="#ajouter-un-utilisateur">Ajouter un utilisateur</a></li>
                                                <li><a href="#supprimer-un-utilisateur">Supprimer un utilisateur</a></li>
                                                <li><a href="#ajouter-un-administrateur">Ajouter un administrateur</a></li>
                                                <li><a href="#supprimer-un-administrateur">Supprimer un administrateur</a></li>
                                                <li><a href="#ajouter-un-service">Ajouter un service</a></li>
                                                <li><a href="#se-connecter-en-root">Se connecter en root</a></li>
                                                <li><a href="#monter-une-partition">Monter une partition</a>
                                                <ul>
                                                <li><a href="#images-iso-physiques-ou-virtuelles">Images ISO (physiques ou virtuelles)</a></li>
                                                <li><a href="#clés-usb">Clés USB</a></li>
                                                <li><a href="#accéder-à-la-partition-boot">Accéder à la partition /boot</a></li>
                                                </ul></li>
                                                <li><a href="#diagnostic-selinux">Diagnostic SELinux</a></li>
                                                <li><a href="#agrandir-une-partition">Agrandir une partition</a></li>
                                                <li><a href="#modifier-le-mot-de-passe-de-démarrage">Modifier le mot de passe de démarrage</a></li>
                                                <li><a href="#modifier-le-serveur-syslog-distant">Modifier le serveur SYSLOG distant</a></li>
                                                <li><a href="#modifier-la-source-de-référence-de-temps">Modifier la source de référence de temps</a></li>
                                                <li><a href="#joindre-un-domaine-windows">Joindre un domaine Windows</a></li>
                                                </ul></li>
                                                </ul>
                        
                    </div>
                </div>
            </div>

            <div class="uk-width-medium-3-4">
<p>Dernière mise à jour : %date%</p>
<div style=""></div>
<h1 id="principes-de-base">Principes de base</h1>
<p>Ce guide vise à rendre un système Red Hat plus résilient face aux attaques informatiques, ce qu’on appelle un système durci. Il se base principalement sur les recommandations <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a> et <a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a>.</p>
<p>Il introduit deux modes de fonctionnement du système : nominal et maintenance. En mode nominal, les points suivants sont désactivés :</p>
<ul>
<li>le chargement de modules noyaux.</li>
<li>l’accès à la partition de démarrage /boot</li>
<li>les supports de stockage externe.</li>
</ul>
<p>Pour les réactiver, il faut passer en mode « maintenance ». Pour passer d’un mode à l’autre, il est nécessaire de redémarrer le système.</p>
<p>Ce guide décrit la procédure à suivre pour un système Red Hat Linux Entreprise 8 (Testé avec les versions 8.1 à 8.5).</p>
<p>Si ce guide n’a pas été suivi dès l’installation du système, il sera compliqué voire très fastidieux de mettre en place l’ensemble des règles définies dans ce guide.</p>
<h2 id="installation">Installation</h2>
<p>Certains des paramètres de sécurisation sont uniquement ou plus facilement sélectionnables lors de l’installation. Ce sont, en particulier, la répartition des partitions et la sélection initiale de logiciels à installer.</p>
<p>L’installation du système est décrite au <a href="#installation-du-système">chapitre ci-dessous</a>.</p>
<p>La documentation constructeur est disponible sur <a href="https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index">le site Red Hat</a>.</p>
<p>Pour rappel, pendant l’installation et avant l’installation des correctifs de sécurité, l’ordinateur est potentiellement vulnérable et doit donc être déconnecté ou au pire connecté à un réseau maitrisé.</p>
<h2 id="application-automatique">Application automatique</h2>
<p>Quand cela est possible, les règles de sécurisation ont été traduites dans un script qui permet d’appliquer les paramètres demandés sans interaction de l’utilisateur.</p>
<h2 id="finalisation-de-la-sécurisation">Finalisation de la sécurisation</h2>
<p>Un certain nombre d’opérations (trop complexes ou dépendantes du réseau d’installation) sont à réaliser manuellement, et sont décrites dans le chapitre <a href="#opérations-manuelles">dédié</a>.</p>
<h2 id="audit">Audit</h2>
<p>L’audit permet de s’assurer que le système est correctement configuré. Il est à réaliser à intervalles réguliers pour s’assurer qu’il n’y a pas de déviations ou de dérives du système. Par exemple, des mises à jour du système peuvent modifier des permissions sur le système de fichiers.</p>
<p>L’audit est décrit au <a href="#audit-1">chapitre dédié</a>.</p>
<h1 id="installation-du-système">Installation du système</h1>
<h2 id="sur-une-machine-virtuelle">Sur une machine virtuelle</h2>
<p>Il est conseillé de s’assurer que le matériel virtualisé soit réduit au minimum : par exemple pas de carte son, pas de port série … pour limiter la surface d’attaque. Le disque dur alloué doit être au minimum de 48 Go</p>
<h2 id="depuis-une-image-iso">Depuis une image ISO</h2>
<p>Démarrer le système depuis l’image ISO: <img src="images/dvd.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran : Démarrage du DVD" /></p>
<p>Puis dès que l’installateur graphique est démarré, sélectionner France, Français(France) comme paramètres linguistiques. S’assurer que le clavier est positionné à fr(oss) après avoir cliqué sur Continuer.</p>
<figure>
<img src="images/language-selection.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran : Langue d’installation" /><figcaption aria-hidden="true">Copie d’écran : Langue d’installation</figcaption>
</figure>
<p>Depuis l’écran principal, régler l’heure &amp; date pour pointer vers le fuseau horaire cible et si disponibles, définir plusieurs sources NTP fiables. <img src="images/date-time.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran : Configuration date et heure" /></p>
<p>Depuis l’écran Résumé de l’installation, positionner la Sélection Logiciel à « Installation minimale » :</p>
<figure>
<img src="images/software-selection.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran : Sélection Logiciel" /><figcaption aria-hidden="true">Copie d’écran : Sélection Logiciel</figcaption>
</figure>
<p>Depuis l’écran Résumé de l’installation, positionner le paramètre KDUMP à désactivé :</p>
<figure>
<img src="images/kdump.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran : KDUMP est désactivé" /><figcaption aria-hidden="true">Copie d’écran : KDUMP est désactivé</figcaption>
</figure>
<p>Depuis l’écran Résumé de l’installation, cliquer sur « Nom du réseau &amp;…» pour activer la carte réseau et modifier les différents paramètres réseau (dont le nom DNS).</p>
<figure>
<img src="images/network-config.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran : Configuration du réseau" /><figcaption aria-hidden="true">Copie d’écran : Configuration du réseau</figcaption>
</figure>
<p>Depuis l’écran Résumé de l’installation, dans le chapitre « Installation Destination » pour le partitionnement du disque dur, choisissez « Personnalisé » (cliquer sur Fait) :</p>
<figure>
<img src="images/storage.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran : Configuration du stockage" /><figcaption aria-hidden="true">Copie d’écran : Configuration du stockage</figcaption>
</figure>
<p>Puis garder les options par défaut pour le disque (LVM). Cliquer sur + pour créer les partitions suivantes :</p>
<table>
<thead>
<tr class="header">
<th>Point de montage</th>
<th>Taille Minimum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>/</td>
<td>4 Gio</td>
</tr>
<tr class="even">
<td>/boot</td>
<td>1 Gio</td>
</tr>
<tr class="odd">
<td>/boot/efi</td>
<td>512 Mio</td>
</tr>
<tr class="even">
<td>/usr</td>
<td>12 Gio</td>
</tr>
<tr class="odd">
<td>/tmp</td>
<td>1 Gio</td>
</tr>
<tr class="even">
<td>/home</td>
<td>2 Gio</td>
</tr>
<tr class="odd">
<td>/var</td>
<td>4 Gio</td>
</tr>
<tr class="even">
<td>/var/log</td>
<td>4 Gio</td>
</tr>
<tr class="odd">
<td>/var/tmp</td>
<td>4 Gio</td>
</tr>
<tr class="even">
<td>/var/log/audit</td>
<td>4 Gio</td>
</tr>
<tr class="odd">
<td>/srv ou /opt</td>
<td>6 Gio</td>
</tr>
<tr class="even">
<td>swap</td>
<td>4 Gio (ou 20% de la mémoire vive)</td>
</tr>
</tbody>
</table>
<figure>
<img src="images/part1.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran : Partitionnement" /><figcaption aria-hidden="true">Copie d’écran : Partitionnement</figcaption>
</figure>
<p>Valider les modifications à effectuer sur le disque :</p>
<figure>
<img src="images/part2.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran : Partitionnement" /><figcaption aria-hidden="true">Copie d’écran : Partitionnement</figcaption>
</figure>
<p>Ne pas sélectionner de politique de sécurité.</p>
<p>Le chapitre But du système est optionnel et pour information seulement.</p>
<p>Définir un mot de passe administrateur (root) et créer un compte utilisateur. Veiller à choisir des mots de passe conformes à la politique de sécurité.</p>
<p>Quand tous les paramètres sont réglés, cliquer sur ‘Commencer l’installation’: <img src="images/installation-start.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran: Fin du paramétrage d’installation" /></p>
<p>Redémarrer une fois l’installation terminée :</p>
<figure>
<img src="images/installation-end.png" style="display: block; margin-left: auto; margin-right: auto;" alt="Copie d’écran : Fin d’installation" /><figcaption aria-hidden="true">Copie d’écran : Fin d’installation</figcaption>
</figure>
<p>Passer ensuite à la sécurisation dans le chapitre ci-dessous : <a href="#sécurisation-1">Sécurisation</a>.</p>
<h2 id="sécurisation">Sécurisation</h2>
<p>Une fois l’installation terminée selon le chapitre précédent, la sécurisation proprement dite se passe en quatre étapes :</p>
<ol type="1">
<li>Lancer le script fourni en attachement puis redémarrer.</li>
<li>Effectuer les opérations manuelles détaillés ci-dessous.</li>
<li>Appliquer les correctifs et mises à jour de sécurité.</li>
<li>Mettre en place les mesures organisationnelles de suivi (procédures de MCS, liste des utilisateurs, liste des services …)</li>
</ol>
<h3 id="lancer-le-script-de-sécurisation">Lancer le script de sécurisation</h3>
<p>Copier le script fourni en attachement dans le répertoire /root, puis le lancer dans une session root (ou dans une session sudo).</p>
<p>Il est obligatoire d’avoir inséré un DVD d’installation dans le lecteur (ou à défaut d’avoir monté l’image ISO sur le répertoire /mnt/disc).</p>
<p>Une fois lancé, le script pose quelques questions pour affiner le paramétrage.</p>
<p>Une fois la sécurisation effectuée (et le système redémarré), il n’est plus possible de relancer le script : le montage des images ISO n’étant plus possible.</p>
<p>Voir le chapitre <a href="#clés-usb">Utiliser le système</a> pour les procédures à appliquer pour utiliser des supports externes.</p>
<h3 id="opérations-manuelles">Opérations Manuelles</h3>
<h4 id="configuration-de-chrony">Configuration de chrony</h4>
<p>Le paquet <code>chrony</code> est installé pour assurer la synchronisation du temps. Il est primordial de s’assurer que le démon puisse contacter à minima un (au mieux 3) serveur de temps fiable. Voir <a href="#harde-rhel-099-sassurer-que-chrony-est-configuré">HARDE-RHEL-099</a>.</p>
<h4 id="configuration-du-puits-de-logs">Configuration du puits de logs</h4>
<p>Les journaux du système doivent être renvoyés sur un serveur central pour :</p>
<ul>
<li>empêcher leur modifications.</li>
<li>les archiver selon la règlementation en vigueur.</li>
</ul>
<p>Le script positionne automatiquement cette valeur mais pour la confirmer, voir <a href="#harde-rhel-236-renvoyer-les-journaux-vers-un-hôte-distant">HARDE-RHEL-236</a>.</p>
<h3 id="correctifs">Correctifs</h3>
<p>Pour rappel, il est évidemment nécessaire d’installer au plus tôt les dernières mises à jour de sécurité.</p>
<p>En plus des mises à jour de sécurité, des correctifs fonctionnels peuvent être nécessaires pour résoudre des défauts logiciels ou améliorer le fonctionnement du système.</p>
<p>Il est donc fortement recommandé qu’un processus de veille soit mise en place pour identifier au plus tôt les correctifs indispensables au maintien en condition de sécurité (MCS) ou nécessaires au bon fonctionnement du système (MCO).</p>
<h3 id="documents-à-établir">Documents à établir</h3>
<p>La directive <a href="#harde-rhel-051-services-et-démons-résidents-en-mémoire">HARDE-RHEL-51</a> demande à ce qu’une liste blanche des démons (services résidents) soit établie.</p>
<p>La directive <a href="#harde-rhel-143-désactivation-des-comptes-utilisateurs-inutilisés">HARDE-RHEL-143</a> demande à ce qu’une liste blanche et une liste noire des utilisateurs soient établies.</p>
<h2 id="vérifier-la-bonne-application-des-règles">Vérifier la bonne application des règles</h2>
<p>Le catalogue des règles de sécurisation donne le détail des étapes à réaliser pour auditer le système. Comme pour la sécurisation, lorsque cela a été possible, ces étapes ont été automatisées à l’aide d’un script harde.sh fourni en attachement. Ce script a été écrit en utilisant le framework bats-core (également fourni en attachement).</p>
<h1 id="catalogue-des-regles-de-securisation">CATALOGUE DES REGLES DE SECURISATION</h1>
<p>Ce catalogue contient des règles définies à partir des recommandations <a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a> et du benchmark <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a>. Certaines de ces règles sont positionnées à « Ne pas implémenter » car elles ont été jugées non pertinentes ou non applicables dans le cadre de ce projet. Elles sont néanmoins présentes pour offrir une vision globale des recommandations. La majorité de ces règles sont mis en place par un paramétrage du système mais certaines demandent la mise en place de procédures organisationnelles.</p>
<div style=""></div>
<h2 id="harde-rhel-001-minimisation-des-services-installés">HARDE-RHEL-001 : Minimisation des services installés</h2>
<p>Supprimer les services non nécessaires. Une liste de paquets le plus souvent inutiles et désinstallée par la commande suivante:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-001 :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-001 : Minimisation des services installés&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># If we&#39;re online update</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="ex">dnf</span> update</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># packages that we depends on</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="ex">dnf</span> install <span class="at">--assumeyes</span> net-tools tar policycoreutils-python-utils <span class="dt">\</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  setools-console chrony rsyslog bzip2 firewalld audit usbguard rng-tools <span class="dt">\</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>  openscap-scanner libcap-ng-utils aide rsyslog rsyslog-gnutls <span class="dt">\</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>  audispd-plugins tmux dnf-automatic sssd-ipa sudo policycoreutils <span class="dt">\</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>  python3-subscription-manager-rhsm fapolicyd aide scap-security-guide sssd <span class="dt">\</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>  realmd oddjob oddjob-mkhomedir adcli samba-common samba-common-tools <span class="dt">\</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>  krb5-workstation openldap-clients python3-policycoreutils</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="ex">dnf</span> remove <span class="at">--assumeyes</span> abrt-addon-ccpp abrt-plugin-sosreport iprutils nfs-utils <span class="dt">\</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>  abrt-addon-python tuned abrt-addon-kerneloops gssproxy abrt-plugin-logger <span class="dt">\</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>  abrt-cli abrt-plugin-rhtsupport sendmail abrt setroubleshoot <span class="dt">\</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>  setroubleshoot-server mcstrans xinetd xorg-x11<span class="pp">*</span>.<span class="pp">*</span> ypbind telnet</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co"># Fin: HARDE-RHEL-001</span></span></code></pre></div>
<h4 id="méthode-daudit">Méthode d’audit</h4>
<p>Il n’y a pas de méthode automatique pour déterminer que la configuration est aussi minimale que possible.</p>
<p>Le script d’audit fait une capture des processus exécutés. Cette doit être revue manuellement et comparée entre deux exécutions successives pour déterminer la légitimité des processus présents.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lister les processus</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ps</span> aux</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lister les services réseaux</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">ss</span> <span class="at">-tulpen</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lister les sockets UNIX</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="ex">ss</span> <span class="at">-xp</span></span></code></pre></div>
<h2 id="harde-rhel-002-minimisation-de-la-configuration">HARDE-RHEL-002 : Minimisation de la configuration</h2>
<p>Activer seulement les options nécessaires. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R2</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation">Méthode d’implémentation</h3>
<p>Il faut lors de l’installation et de manière générale n’activer que les options nécessaires. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<h3 id="méthode-daudit-1">Méthode d’audit</h3>
<h2 id="harde-rhel-003-principe-de-moindre-privilège">HARDE-RHEL-003 : Principe de moindre privilège</h2>
<p>Analyser pour connaitre les privilèges nécessaires pour limiter leur usage. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R3</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-1">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-004-utilisation-des-fonctions-de-contrôles-daccès">HARDE-RHEL-004 : Utilisation des fonctions de contrôles d’accès</h2>
<p>Activer cloisonnement et contrôle de privilèges. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R4</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-2">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-005-principe-de-défense-en-profondeur">HARDE-RHEL-005 : Principe de défense en profondeur</h2>
<p>Conception de plusieurs couches de sécurité indépendantes et complémentaires en vue de retarder un attaquant dont l’objectif est la compromis- sion du système. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R5</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-3">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-006-cloisonnement-des-services-réseaux">HARDE-RHEL-006 : Cloisonnement des services réseaux</h2>
<p>Utiliser des environnements distincts. Cette directive est générique est ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R6</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-4">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-007-journalisation-de-lactivité-des-services">HARDE-RHEL-007 : Journalisation de l’activité des services</h2>
<p>Activités journalisées et activées sur un système externe. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R7</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-5">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-008-mises-à-jour-régulières">HARDE-RHEL-008 : Mises à jour régulières</h2>
<p>Procédure de mise à jour et activité de veille. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R8</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-6">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-009-configuration-matérielle">HARDE-RHEL-009 : Configuration matérielle</h2>
<p>Appliquer les recommandations de configuration mentionnées dans la note technique « Recommandations de configuration matérielle de postes clients et serveurs x86 ». Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R9</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-7">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-010-architecture-32-et-64-bits">HARDE-RHEL-010 : Architecture 32 et 64 bits</h2>
<p>Installer une version 64 bits. Le chapitre Installation ci-dessus décrit le processus.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R10</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-8">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-011-désactiver-les-systèmes-de-fichiers-inutilisés">HARDE-RHEL-011 : Désactiver les systèmes de fichiers inutilisés</h2>
<p>Désactiver cramfs, freevxfs, jffs2, hfs, hfsplus, squashfs, udf et vfat :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-1">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-011 :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-11 : Désactiver les sytèmes de fichiers inutilisés&quot;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="cf">for</span> i <span class="kw">in</span> cramfs freevxfs jffs2 hfs hfsplus squashfs crc-itu-t udf fat vfat<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">cat</span> <span class="op">&gt;</span><span class="st">&quot;/etc/modprobe.d/</span><span class="va">$i</span><span class="st">&quot;</span>.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="st">install </span><span class="va">$i</span><span class="st"> /bin/true</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="op">EOF</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="ex">rmmod</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span> <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="cf">done</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co"># Fin: HARDE-RHEL-11</span></span></code></pre></div>
<h3 id="méthode-daudit-2">Méthode d’audit</h3>
<h2 id="harde-rhel-012-partition-séparée-pour-home">HARDE-RHEL-012 : Partition séparée pour /home</h2>
<p>/home doit être installé dans une partition séparée d’au moins 1GB avec les options nodev</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: right;">À implémenter</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.13<br>RHEL 8 1.1.14</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations<br>05.1 Establish Secure Configurations</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-2">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-012 :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-12 : Partition séparée pour /home&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;/home\s&#39;</span> <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;/home n&#39;est pas une partition séparée !&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># Fin: HARDE-RHEL-12</span></span></code></pre></div>
<h3 id="méthode-daudit-3">Méthode d’audit</h3>
<h2 id="harde-rhel-013-options-de-montage-nodevnosuidnoexec-pour-devshm">HARDE-RHEL-013 : Options de montage nodev,nosuid,noexec pour /dev/shm</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.15<br>RHEL 8 1.1.16<br>RHEL 8 1.1.17</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations<br>05.1 Establish Secure Configurations<br>02.6 Address unapproved software</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-9">Méthode d’implémentation</h3>
<p>Ces options ont été activées lors des opérations manuelles après l’installation.</p>
<p>Rajouter la ligne suivante à /etc/fstab, <em>si</em> elle est manquante :</p>
<pre><code>none    /dev/shm    tmpfs   nosuid,nodev,noexec,defaults                    0 0</code></pre>
<h3 id="méthode-daudit-4">Méthode d’audit</h3>
<h2 id="harde-rhel-014-options-de-montage-nodevnosuidnoexec-pour-les-points-de-montage-temporaire">HARDE-RHEL-014 : Options de montage nodev,nosuid,noexec pour les points de montage temporaire</h2>
<p>Rajouter les options dans /etc/fstab pour lecteur DVD ou similaires. Cette directive ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.18<br>RHEL 8 1.1.19<br>RHEL 8 1.1.20</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations<br>05.1 Establish Secure Configurations<br>02.6 Address unapproved software</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-10">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-015-sassurer-de-la-configuration-de-tmp">HARDE-RHEL-015 : S’assurer de la configuration de /tmp</h2>
<p>/tmp doit être installé dans une partition séparée d’au moins 1GB avec les options nodev,nosuid,noexec</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.2<br>RHEL 8 1.1.3<br>RHEL 8 1.1.4<br>RHEL 8 1.1.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations<br>05.1 Establish Secure Configurations<br>05.1 Establish Secure Configurations<br>02.6 Address unapproved software</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-3">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-015 :</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-15 : S&#39;assurer de la configuration de /tmp&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;/tmp\s&#39;</span> <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;/tmp n&#39;est pas une partition séparée !&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># Fin: HARDE-RHEL-15</span></span></code></pre></div>
<h3 id="méthode-daudit-5">Méthode d’audit</h3>
<h2 id="harde-rhel-016-désactiver-le-stockage-usb">HARDE-RHEL-016 : Désactiver le stockage USB</h2>
<p>Pour désactiver le stockage USB, lancer les commandes du chapitre suivante. Une alternative est d’autoriser le module usb-storage mais de contrôler et limiter les périphériques USB pouvant être connectés en configurant usb-guard. La configuration d’USB n’est pas décrite dans ce guide.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.23</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">08.4 Configure Anti-Malware Scanning of Removable Devices<br>08.5 Configure Devices Not To Auto-run Content</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-4">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-016 :</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-16 : Désactiver le stockage USB&quot;</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="bu">declare</span> <span class="at">-a</span> <span class="va">modules</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="va">modules</span><span class="op">=</span><span class="va">(</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="op">[</span><span class="dv">0</span><span class="op">]</span><span class="va">=</span><span class="st">&quot;usb-storage&quot;</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="va">)</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${modules</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">cat</span> <span class="op">&gt;</span><span class="st">&quot;/etc/modprobe.d/</span><span class="va">$i</span><span class="st">.conf&quot;</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="st">install </span><span class="va">$i</span><span class="st"> /bin/true</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="op">EOF</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>  <span class="ex">rmmod</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span> <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="cf">done</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="ex">usbguard</span> generate-policy <span class="op">&gt;</span>/etc/usbguard/rules.conf</span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co"># Fin: HARDE-RHEL-16</span></span></code></pre></div>
<h3 id="méthode-daudit-6">Méthode d’audit</h3>
<h2 id="harde-rhel-017-sassurer-de-la-configuration-de-var">HARDE-RHEL-017 : S’assurer de la configuration de /var</h2>
<p>/var doit être installé dans une partition séparé d’au moins 4GB avec les options nodev</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-5">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-017 :</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-17 : S&#39;assurer de la configuration de /var&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-E</span> <span class="st">&#39;\s/var\s&#39;</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-q</span> nodev <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;Options de montage non valide pour /var&quot;</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># Fin: HARDE-RHEL-17</span></span></code></pre></div>
<h3 id="méthode-daudit-7">Méthode d’audit</h3>
<h2 id="harde-rhel-018-sassurer-de-la-configuration-de-vartmp">HARDE-RHEL-018 : S’assurer de la configuration de /var/tmp</h2>
<p>/var/tmp doit être installé dans une partition séparé d’au moins 1GB avec les options nodev,nosuid,noexec</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.7<br>RHEL 8 1.1.8<br>RHEL 8 1.1.9<br>RHEL 8 1.1.10</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations<br>05.1 Establish Secure Configurations<br>05.1 Establish Secure Configurations<br>02.6 Address unapproved software</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-6">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-018 :</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-018 : S&#39;assurer de la configuration de /var/tmp&quot;</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-E</span> <span class="st">&#39;/var/tmp\s&#39;</span> <span class="kw">|</span> <span class="fu">grep</span> nodev <span class="kw">|</span> <span class="fu">grep</span> noexec <span class="kw">|</span> <span class="fu">grep</span> nosuid <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;Options de montage non valide pour /var/tmp&quot;</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># Fin: HARDE-RHEL-018</span></span></code></pre></div>
<h3 id="méthode-daudit-8">Méthode d’audit</h3>
<h2 id="harde-rhel-019-partitionnement-type">HARDE-RHEL-019 : Partitionnement type</h2>
<p>Le principe de minimisation pousse à partitionner le stockage pour limiter l’impact en cas de remplissage abusif (attaque, journaux, processus fou …) et pour limiter les droits sur des emplacements ouverts en écriture (par exemple en limitant la possibilité d’un utilitaire <em>suid</em> à la seule partition <code>/usr</code> celle-ci n’étant accessible qu’aux administrateurs voire en mettant la partition complète en lecture seule).</p>
<p>Le chapitre Installation décrit le minimum de partitions à créer sur le système.</p>
<p>Voici la liste des options recommandées à appliquer dans le fichier /etc/fstab pour les points de montage :</p>
<table>
<thead>
<tr class="header">
<th>Point de Montage</th>
<th>Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>/</td>
<td><em>pas d’option</em></td>
<td>Partition racine, contient le reste de l’arborescence</td>
</tr>
<tr class="even">
<td>/boot et /boot/efi</td>
<td>nodev,nosuid,noexec,noauto</td>
<td>Contient le noyau et le chargeur de démarrage. Pas d’accès nécessaire une fois le boot terminé (sauf mise à jour)</td>
</tr>
<tr class="odd">
<td>/dev/shm</td>
<td>nodev,nosuid,noexec</td>
<td>Contient les segments de mémoire partagés</td>
</tr>
<tr class="even">
<td>/home</td>
<td>nodev,nosuid,noexec</td>
<td>Contient les HOME utilisateurs. Montage en lecture seule si non utilisé</td>
</tr>
<tr class="odd">
<td>/opt</td>
<td>nodev,nosuid (ro optionnel)</td>
<td>Packages additionnels au système. Montage en lecture seule si non utilisé</td>
</tr>
<tr class="even">
<td>/proc</td>
<td>hidepid=2,gid=sudogrp</td>
<td>Contient des informations sur les processus et le système</td>
</tr>
<tr class="odd">
<td>/srv</td>
<td>nodev,nosuid (noexec,ro optionnels)</td>
<td>Contient des fichiers servis par un service type web, ftp, etc.</td>
</tr>
<tr class="even">
<td>/tmp</td>
<td>nodev,nosuid,noexec</td>
<td>Fichiers temporaires. Ne doit contenir que des éléments non exécutables. Nettoyé après redémarrage ou préférablement de type tmpfs</td>
</tr>
<tr class="odd">
<td>/usr</td>
<td>nodev (ro optionnel)</td>
<td>Contient la majorité des utilitaires et fichiers système</td>
</tr>
<tr class="even">
<td>/var</td>
<td>nodev,nosuid,noexec</td>
<td>Partition contenant des fichiers variables pendant la vie du système (mails, fichiers PID, bases de données d’un service)</td>
</tr>
<tr class="odd">
<td>/var/log</td>
<td>nodev,nosuid,noexec</td>
<td>Contient les logs du système</td>
</tr>
<tr class="even">
<td>/var/log/audit</td>
<td>nodev,nosuid,noexec</td>
<td>Contient les logs d’audit du système</td>
</tr>
<tr class="odd">
<td>/var/tmp</td>
<td>nodev,nosuid,noexec</td>
<td>Fichiers temporaires conservés après extinction</td>
</tr>
</tbody>
</table>
<p>Le script rajoute les lignes suivantes :</p>
<pre class="text"><code>proc /proc  proc rw,nosuid,nodev,noexec,relatime,hidepid=2,gid=sudogrp 0 0
none /dev/shm tmpfs nosuid,nodev,noexec,defaults             0 0</code></pre>
<p>À titre d’exemple, voici le fichier édité pour une machine virtuelle (sans les options « ro » de lecture seule) :</p>
<pre class="text"><code>#
# /etc/fstab
# Created by anaconda on Fri Sep 11 11:21:06 2020
#
# Accessible filesystems, by reference, are maintained under &#39;/dev/disk/&#39;.
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.
#
# After editing this file, run &#39;systemctl daemon-reload&#39; to update systemd
# units generated from this file.
#
/dev/mapper/rhel_lab-root   /                     xfs    defaults      0 0
UUID=3fe99bee-938f-4751-a956-b4335bc32e7c  /boot           xfs    nosuid,nodev,noexec,noauto,defaults          0 0
UUID=16FD-1FB3             /boot/efi          vfat   nosuid,nodev,noexec,noauto,umask=0077,shortname=winnt  0 2
/dev/mapper/rhel_lab-home    /home             xfs    nosuid,nodev,noexec,defaults           0 0
/dev/mapper/rhel_lab-srv    /srv                xfs   nosuid,nodev,defaults            0 0
/dev/mapper/rhel_lab-tmp    /tmp                    xfs    nosuid,nodev,noexec,defaults           0 0
/dev/mapper/rhel_lab-usr    /usr                   xfs    nodev,defaults             0 0
/dev/mapper/rhel_lab-var    /var                xfs    nosuid,nodev,noexec,defaults           0 0
/dev/mapper/rhel_lab-var_log    /var/log       xfs    nosuid,nodev,noexec,defaults           0 0
/dev/mapper/rhel_lab-var_log_audit   /var/log/audit   xfs    nosuid,nodev,noexec,defaults           0 0
/dev/mapper/rhel_lab-var_tmp      /var/tmp         xfs    nosuid,nodev,noexec,defaults           0 0
/dev/mapper/rhel_lab-swap       swap                  swap   defaults             0 0
proc                    /proc              proc   rw,nosuid,nodev,noexec,relatime,hidepid=2,gid=sudogrp 0 0
none                      /dev/shm             tmpfs  nosuid,nodev,noexec,defaults    0 0</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R12</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-7">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-019 :</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-19 : Partitionnement type&quot;</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="ex">harde_backup_file</span> /etc/fstab</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="fu">grep</span> <span class="at">-q</span> ^proc /etc/fstab  <span class="kw">||</span> <span class="fu">cat</span> <span class="op">&gt;</span>/etc/fstab <span class="op">&lt;&lt;EOF</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="st">proc /proc  proc rw,nosuid,nodev,noexec,relatime,hidepid=2,gid=sudogrp 0 0</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="op">EOF</span></span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="ex">harde_backup_file</span> /etc/fstab</span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="fu">grep</span> <span class="at">-q</span> /dev/shm /etc/fstab  <span class="kw">||</span> <span class="fu">cat</span> <span class="op">&gt;</span>/etc/fstab <span class="op">&lt;&lt;EOF</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="st">none /dev/shm tmpfs nosuid,nodev,noexec,defaults             0 0</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="op">EOF</span></span>
<span id="cb12-14"><a href="#cb12-14"></a></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="ex">harde_backup_file</span> /etc/fstab</span>
<span id="cb12-16"><a href="#cb12-16"></a></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="fu">cat</span> <span class="op">&gt;</span>/tmp/fs.sed <span class="op">&lt;&lt;EOF</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="st">#! /usr/bin/sed</span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="dt">\%</span><span class="st">^</span><span class="dt">\#</span><span class="st">%n</span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="st">#</span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/0-9]+ +/ %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/0-9]+ +/boot %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,noexec,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/0-9]+ +/boot/efi %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,noexec,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/]+ +/home %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,noexec,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-25"><a href="#cb12-25"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/]+ +/opt %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/]+ +/srv %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-27"><a href="#cb12-27"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/]+ +/tmp %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,noexec,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/]+ +/usr %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nodev,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-29"><a href="#cb12-29"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/]+ +/var %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,noexec,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-30"><a href="#cb12-30"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/]+ +/var/log %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,noexec,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/]+ +/var/tmp %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,noexec,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/]+ +/var/log/audit %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">  </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,noexec,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-33"><a href="#cb12-33"></a><span class="dt">\%</span><span class="st">^proc%cproc       /proc   proc    rw,nosuid,nodev,noexec,relatime,hidepid=2,gid=sudogrp   0 0</span></span>
<span id="cb12-34"><a href="#cb12-34"></a><span class="dt">\%</span><span class="st">^[-A-Za-z=_/]+ +/dev/shm %s|([^  ]*) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+) +([^  ]+)|</span><span class="dt">\1</span><span class="st">   </span><span class="dt">\2</span><span class="st">  </span><span class="dt">\3</span><span class="st">  nosuid,nodev,noexec,defaults    </span><span class="dt">\5</span><span class="st"> </span><span class="dt">\6</span><span class="st">|</span></span>
<span id="cb12-35"><a href="#cb12-35"></a><span class="op">EOF</span></span>
<span id="cb12-36"><a href="#cb12-36"></a></span>
<span id="cb12-37"><a href="#cb12-37"></a><span class="fu">sed</span> <span class="at">-Ef</span> /tmp/fstab.sed /etc/fstab <span class="op">&gt;</span> /etc/fstab.new <span class="kw">&amp;&amp;</span> <span class="fu">mv</span> /etc/fstab.new /etc/fstab</span>
<span id="cb12-38"><a href="#cb12-38"></a><span class="fu">mkdir</span> <span class="at">-p</span> /etc/systemd/system/systemd-logind.service.d</span>
<span id="cb12-39"><a href="#cb12-39"></a><span class="co"># makes systemd-logind work with hidepid</span></span>
<span id="cb12-40"><a href="#cb12-40"></a><span class="ex">harde_backup_file</span> /etc/systemd/system/systemd-logind.service.d/hidepid.conf</span>
<span id="cb12-41"><a href="#cb12-41"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/system/systemd-logind.service.d/hidepid.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb12-42"><a href="#cb12-42"></a><span class="st">[Service]</span></span>
<span id="cb12-43"><a href="#cb12-43"></a><span class="st">SupplementaryGroups=sudogrp</span></span>
<span id="cb12-44"><a href="#cb12-44"></a><span class="op">EOF</span></span>
<span id="cb12-45"><a href="#cb12-45"></a><span class="co"># Fin: HARDE-RHEL-19</span></span></code></pre></div>
<h3 id="méthode-daudit-9">Méthode d’audit</h3>
<h2 id="harde-rhel-020-restrictions-daccès-sur-le-dossier-boot">HARDE-RHEL-020 : Restrictions d’accès sur le dossier /boot</h2>
<p>Ne pas monter /boot automatiquement au démarrage. S’assurer que /boot est monté pour les mises à jour (via procédure ou script).</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R13</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-11">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-021-installation-de-paquets-réduite-au-strict-nécessaire">HARDE-RHEL-021 : Installation de paquets réduite au strict nécessaire</h2>
<p>Limiter les paquets installés au strict nécessaire en partant d’un «profil» minimum (sélectionner Installation minimale lors de l’installation) et maintenir une liste des paquets installés. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R14</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-12">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-022-choix-des-dépôts-de-paquets">HARDE-RHEL-022 : Choix des dépôts de paquets</h2>
<p>N’utiliser que les dépôts officiels. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R15</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-13">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-023-dépôts-de-paquets-durcis">HARDE-RHEL-023 : Dépôts de paquets durcis</h2>
<p>Préférer les versions durcis des paquets si disponible. Cette directive est générique est ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R16</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-14">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-024-robustesse-du-mot-de-passe-administrateur">HARDE-RHEL-024 : Robustesse du mot de passe administrateur</h2>
<p>Le mot de passe root doit être suffisamment robuste. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R18</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-15">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-025-installation-déléments-secrets-ou-de-confiance">HARDE-RHEL-025 : Installation d’éléments secrets ou de confiance</h2>
<p>Installation au plus tôt des éléments secrets et remplacement des éléments par défaut. Cette directive est générique est ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R20</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-16">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-026-sassurer-que-les-politiques-de-chiffrement-historiques-soient-désactivées">HARDE-RHEL-026 : S’assurer que les politiques de chiffrement historiques soient désactivées</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.10</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.4 Encrypt All Sensitive Information in Transit</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-8">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-026 :</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-026 : S&#39;assurer que les politiques de chiffrement historiques soit désactivées&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="ex">update-crypto-policies</span> <span class="at">--set</span> DEFAULT</span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="ex">update-crypto-policies</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># Fin: HARDE-RHEL-026</span></span></code></pre></div>
<h3 id="méthode-daudit-10">Méthode d’audit</h3>
<h2 id="harde-rhel-027-sassurer-que-le-mode-fips-ou-future-est-activé-pour-le-chiffrement">HARDE-RHEL-027 : S’assurer que le mode FIPS ou FUTURE est activé pour le chiffrement</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.11</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.4 Encrypt All Sensitive Information in Transit</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-9">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-027 :</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># </span><span class="al">FIXME</span><span class="co"> should probably switch to FUTURE or something more secure</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># See https://workbench.cisecurity.org/tickets/12887</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-027 : S&#39;assurer que le mode FIPS ou FUTURE est activé pour le chiffrement&quot;</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="ex">update-crypto-policies</span> <span class="at">--set</span> FIPS</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="ex">update-crypto-policies</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co"># Fin: HARDE-RHEL-027</span></span></code></pre></div>
<h3 id="méthode-daudit-11">Méthode d’audit</h3>
<h2 id="harde-rhel-028-sassurer-que-lip-forwarding-est-désactivé">HARDE-RHEL-028 : S’assurer que l’IP Forwarding est désactivé</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.1.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R22</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-10">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-028 :</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-28 : S&#39;assurer que l&#39;IP Forwarding est désactivé&quot;</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/30forwarding.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="st"># Pas de routage entre les interfaces</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="st">net.ipv4.ip_forward = 0</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="op">EOF</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co"># Fin: HARDE-RHEL-28</span></span></code></pre></div>
<h3 id="méthode-daudit-12">Méthode d’audit</h3>
<h2 id="harde-rhel-029-désactiver-les-icmp-redirects">HARDE-RHEL-029 : Désactiver les ICMP Redirects</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramétrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.1.2<br>RHEL 8 3.2.2<br>RHEL 8 3.2.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations<br>05.1 Establish Secure Configurations<br>05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R22<br>R22<br>R22</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-11">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-029 :</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-29 : Désactiver les ICMP Redirects&quot;</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/35icmpredirects.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="st"># Ne pas envoyer de redirections ICMP</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="st">net.ipv4.conf.all.send_redirects = 0</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="st">net.ipv4.conf.default.send_redirects = 0</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="st"># Ne pas accepter les ICMP de type redirect</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="st">net.ipv4.conf.all.accept_redirects = 0</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="st">net.ipv4.conf.all.secure_redirects = 0</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="st">net.ipv4.conf.default.accept_redirects = 0</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="st">net.ipv4.conf.default.secure_redirects = 0</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="op">EOF</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co"># Fin: HARDE-RHEL-29</span></span></code></pre></div>
<h3 id="méthode-daudit-13">Méthode d’audit</h3>
<h2 id="harde-rhel-030-refuser-les-paquets-routés-par-la-source">HARDE-RHEL-030 : Refuser les paquets routés par la source</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.2.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R22</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-12">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-030 :</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-30 : Refuser les paquets routés par la source&quot;</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/40sourceroute.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st"># Refuser les paquets de source routing</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="st">net.ipv4.conf.all.accept_source_route = 0</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="st">net.ipv4.conf.default.accept_source_route = 0</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="op">EOF</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co"># Fin: HARDE-RHEL-30</span></span></code></pre></div>
<h3 id="méthode-daudit-14">Méthode d’audit</h3>
<h2 id="harde-rhel-031-sassurer-que-les-paquets-suspects-soient-journalisés">HARDE-RHEL-031 : S’assurer que les paquets suspects soient journalisés</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramétrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.2.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>6.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R22<br>R22</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-13">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-031 :</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-31 : S&#39;assurer que les paquets suspects soient loggués&quot;</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/45logmartians.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st"># Loguer les paquets ayant des IPs anormales</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="st">net.ipv4.conf.all.log_martians = 1</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="st">net.ipv4.conf.default.log_martians = 1</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="op">EOF</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co"># Fin: HARDE-RHEL-31</span></span></code></pre></div>
<h3 id="méthode-daudit-15">Méthode d’audit</h3>
<h2 id="harde-rhel-032-refuser-les-icmp-broadcast">HARDE-RHEL-032 : Refuser les ICMP broadcast</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.2.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-14">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-032 :</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-32 : Refuser les ICMP broadcast&quot;</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/50icmpbroadcast.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="st"># Refuser les requêtes ICMP vers une adresse de broadcast/multicast</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="st">net.ipv4.icmp_echo_ignore_broadcasts = 1</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="op">EOF</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co"># Fin: HARDE-RHEL-32</span></span></code></pre></div>
<h3 id="méthode-daudit-16">Méthode d’audit</h3>
<h2 id="harde-rhel-033-ignorer-les-réponses-icmp-douteuses">HARDE-RHEL-033 : Ignorer les réponses ICMP douteuses</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.2.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-15">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-033 :</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-33 : Ignorer les réponses ICMP douteuses&quot;</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/55icmpbogus.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="st"># Refuser les réponses ICMP bogus</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="st">net.ipv4.icmp_ignore_bogus_error_responses = 1</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="op">EOF</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co"># Fin: HARDE-RHEL-33</span></span></code></pre></div>
<h3 id="méthode-daudit-17">Méthode d’audit</h3>
<h2 id="harde-rhel-034-activer-le-filtrage-par-routage-inversé">HARDE-RHEL-034 : Activer le filtrage par routage inversé</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.2.7</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R22</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-16">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-034 :</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-34 : Activer le filtrage par routage inversé&quot;</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/60rp_filter.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="st"># Filtrage par chemin inverse</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="st">net.ipv4.conf.all.rp_filter = 1</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="st">net.ipv4.conf.default.rp_filter = 1</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="op">EOF</span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co"># Fin: HARDE-RHEL-34</span></span></code></pre></div>
<h3 id="méthode-daudit-18">Méthode d’audit</h3>
<h2 id="harde-rhel-035-activer-les-tcp-syn-cookies">HARDE-RHEL-035 : Activer les TCP Syn Cookies</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.2.8</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R22</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-17">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-035 :</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-35 : Activer les TCP Syn Cookies&quot;</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/65syncookies.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="st"># Utiliser les SYN cookies</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="st">net.ipv4.tcp_syncookies = 1</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="op">EOF</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co"># Fin: HARDE-RHEL-35</span></span></code></pre></div>
<h3 id="méthode-daudit-19">Méthode d’audit</h3>
<h2 id="harde-rhel-036-refuser-les-paquets-ipv6-router-advertisements">HARDE-RHEL-036 : Refuser les paquets IPv6 Router Advertisements</h2>
<p>IPv6 est désactivé dans notre configuration</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.2.9</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-17">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-037-désactiver-ipv6">HARDE-RHEL-037 : Désactiver IPV6</h2>
<p>Éditer /etc/default/grub et modifier le paramètre GRUB_CMDLINE_LINUX pour inclure ipv6.disable=1 puis lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-18">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-037 :</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-37 : Désactiver IPV6&quot;</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/70disable_ipv6.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="st">net.ipv6.conf.all.disable_ipv6 = 1</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="st">net.ipv6.conf.default.disable_ipv6 = 1</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="op">EOF</span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co"># Samba and others may require the stack to be available, even with no interfaces</span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co"># so the follwoing will have to be disabled</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;ipv6.disable=&#39;</span> /etc/default/grub<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(GRUB_CMDLINE_LINUX=&quot;[^&quot;]*\)&quot;/\1 ipv6.disable=1&quot;/&#39;</span> <span class="at">-i</span> /etc/default/grub</span>
<span id="cb23-11"><a href="#cb23-11"></a>  <span class="bu">echo</span> <span class="st">&quot;Parameter ipv6.disable added.&quot;</span></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="cf">fi</span></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="ex">grub2-mkconfig</span> –o /boot/grub2/grub.cfg <span class="op">&gt;</span>/dev/null</span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="ex">grub2-mkconfig</span> –o /boot/efi/EFI/grub.cfg <span class="op">&gt;</span>/dev/null</span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="co"># Fin: HARDE-RHEL-37</span></span></code></pre></div>
<h3 id="méthode-daudit-20">Méthode d’audit</h3>
<h2 id="harde-rhel-038-sassurer-que-la-politique-de-chiffrement-système-nest-pas-outrepassée">HARDE-RHEL-038 : S’assurer que la politique de chiffrement système n’est pas outrepassée</h2>
<p>Conforme par défaut</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.20</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.4 Encrypt All Sensitive Information in Transit</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-19">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-038 :</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-38 : S&#39;assurer que la politique de chiffrement système n&#39;est pas outrepassée &quot;</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">sed</span> <span class="at">-E</span> <span class="at">-i</span> <span class="st">&quot;s/^\s*(CRYPTO_POLICY\s*=.*)$/# \1/&quot;</span> /etc/sysconfig/sshd</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="ex">systemctl</span> reload sshd</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co"># Fin: HARDE-RHEL-38</span></span></code></pre></div>
<h3 id="méthode-daudit-21">Méthode d’audit</h3>
<h2 id="harde-rhel-039-paramétrage-des-sysctl-réseau">HARDE-RHEL-039 : Paramétrage des sysctl réseau</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R22</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-20">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-039 :</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-39 : Paramétrage des sysctl réseau&quot;</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/05anssi.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="st"># RFC 1337</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="st">net.ipv4.tcp_rfc1337 = 1</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="st"># Ignorer les réponses non conformes à la RFC 1122</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="st">net.ipv4.icmp_ignore_bogus_error_responses = 1</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="st"># Augmenter la plage pour les ports éphémères</span></span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="st">net.ipv4.ip_local_port_range = 32768 65535</span></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="st"># Désactiver IPv6</span></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="st">net.ipv6.conf.all.disable_ipv6 = 1</span></span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="op">EOF</span></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="co"># Fin: HARDE-RHEL-39</span></span></code></pre></div>
<h3 id="méthode-daudit-22">Méthode d’audit</h3>
<h2 id="harde-rhel-040-permissions-des-fichiers-de-configuration-du-démarrage">HARDE-RHEL-040 : Permissions des fichiers de configuration du démarrage</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.5.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-21">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-040 :</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-40 : Permissions des fichiers de configuration du démarrage&quot;</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="fu">chown</span> root:root /boot/grub2/grub<span class="pp">*</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="fu">chmod</span> go-rwx /boot/grub2/grub<span class="pp">*</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co"># Fin: HARDE-RHEL-40</span></span></code></pre></div>
<h3 id="méthode-daudit-23">Méthode d’audit</h3>
<h2 id="harde-rhel-041-verrouiller-par-mot-de-passe-la-configuration-de-demarrage">HARDE-RHEL-041 : Verrouiller par mot de passe la configuration de demarrage</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.5.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R17</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-22">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-041 :</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-41 : Verrouiller par mot de passe la configuration de demarrage&quot;</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="cf">while</span> <span class="ot">! </span><span class="ex">grub2-setpassword</span> <span class="at">-o</span> /boot/grub2<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="bu">echo</span> <span class="st">&quot;Mot de passe non enregistré. Veuillez réessayer ...&quot;</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="cf">done</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="fu">cp</span> /boot/grub2/user.cfg /boot/efi/EFI/redhat/</span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co"># Fin: HARDE-RHEL-41</span></span></code></pre></div>
<h3 id="méthode-daudit-24">Méthode d’audit</h3>
<h2 id="harde-rhel-042-demander-un-mot-de-passe-pour-les-modes-de-secours">HARDE-RHEL-042 : Demander un mot de passe pour les modes de secours</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.5.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-18">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-043-directive-de-configuration-de-liommu">HARDE-RHEL-043 : Directive de configuration de l’IOMMU</h2>
<p>Éditer /etc/default/grub et modifier le paramètre GRUB_CMDLINE_LINUX pour inclure iommu=force en lançant la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R11</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-23">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-043 :</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-43 : Directive de configuration de l&#39;IOMMU&quot;</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;iommu=&#39;</span> /etc/default/grub<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(GRUB_CMDLINE_LINUX=&quot;[^&quot;]*\)&quot;/\1 iommu=force&quot;/&#39;</span> <span class="at">-i</span> /etc/default/grub</span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="bu">echo</span> <span class="st">&quot;Parameter iommu added.&quot;</span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="cf">fi</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="ex">grub2-mkconfig</span> <span class="at">-o</span> /boot/grub2/grub.cfg <span class="op">&gt;</span>/dev/null</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="ex">grub2-mkconfig</span> –o /boot/efi/EFI/grub.cfg <span class="op">&gt;</span>/dev/null</span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="co"># Fin: HARDE-RHEL-43</span></span></code></pre></div>
<h3 id="méthode-daudit-25">Méthode d’audit</h3>
<h2 id="harde-rhel-044-configurer-la-connexion-red-hat-subscription-manager">HARDE-RHEL-044 : Configurer la connexion Red Hat Subscription Manager</h2>
<p>Pas utile sur un système déconnecté d’Internet. La commande suivante désactive les messages inutiles dans notre cas.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Ne pas implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.2.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">03.4 Deploy Automated Operating System Patch Management Tools</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-24">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-044 :</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-44 : Configurer la connexion Red Hat Subscription Manager&quot;</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="fu">sed</span> <span class="at">-e</span> s/enabled=1/enabled=0/ <span class="at">-i</span> /etc/yum/pluginconf.d/subscription-manager.conf</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co"># Fin: HARDE-RHEL-44</span></span></code></pre></div>
<h3 id="méthode-daudit-26">Méthode d’audit</h3>
<h2 id="harde-rhel-045-désactiver-le-démon-rhnsd">HARDE-RHEL-045 : Désactiver le démon rhnsd</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.2.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-25">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-045 :</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-45 : Désactiver le démon rhnsd&quot;</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable rhnsd <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co"># Fin: HARDE-RHEL-45</span></span></code></pre></div>
<h3 id="méthode-daudit-27">Méthode d’audit</h3>
<h2 id="harde-rhel-046-sassurer-que-les-clés-pgp-soient-configurées">HARDE-RHEL-046 : S’assurer que les clés PGP soient configurées</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.2.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">03.4 Deploy Automated Operating System Patch Management Tools</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-19">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-047-activer-loption-gpgcheck">HARDE-RHEL-047 : Activer l’option gpgcheck</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.2.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">03.4 Deploy Automated Operating System Patch Management Tools</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-20">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-048-sassurer-que-les-dépôts-soient-configurés">HARDE-RHEL-048 : S’assurer que les dépôts soient configurés</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.2.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">03.4 Deploy Automated Operating System Patch Management Tools</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-21">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-049-sassurer-que-les-mises-à-jour-de-sécurité-sont-installées">HARDE-RHEL-049 : S’assurer que les mises à jour de sécurité sont installées</h2>
<p>Appliquer les mises à jour de sécurité</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.9</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">03.4 Deploy Automated Operating System Patch Management Tools</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-22">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-050-activer-le-démon-cron">HARDE-RHEL-050 : Activer le démon cron</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.1.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-26">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-050 :</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-50 : Activer le démon cron&quot;</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> enable crond</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co"># Fin: HARDE-RHEL-50</span></span></code></pre></div>
<h3 id="méthode-daudit-28">Méthode d’audit</h3>
<h2 id="harde-rhel-051-services-et-démons-résidents-en-mémoire">HARDE-RHEL-051 : Services et démons résidents en mémoire</h2>
<p>Établir une liste blanche de démons autorisés. Cette directive est générique est ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R42</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-23">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-052-restriction-des-accès-des-services-déployés">HARDE-RHEL-052 : Restriction des accès des services déployés</h2>
<p>Utiliser podman, si possible, pour créer de containers et ainsi restreindre la surface d’attaque d’un service. Deployer un container dépasse le cadre de ce guide. Une documentation exhaustive se trouve sur https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/building_running_and_managing_containers/index</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R53</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-24">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-053-durcissement-des-composants-de-virtualisation">HARDE-RHEL-053 : Durcissement des composants de virtualisation</h2>
<p>Tout composant support de virtualisation doit être durci, notamment par l’application de mesures techniques contrant les tentatives d’exploitation</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R54</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-25">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-054-cage-chroot-et-privilèges-daccès-du-service-cloisonné">HARDE-RHEL-054 : Cage chroot et privilèges d’accès du service cloisonné</h2>
<p>Pas de service chrooté/chrootable dans l’installation minimale.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R55</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-26">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-055-activation-et-utilisation-de-chroot-par-un-service">HARDE-RHEL-055 : Activation et utilisation de chroot par un service</h2>
<p>Pas de service chrooté dans l’installation minimale mais chroot doit être utilisé et activé lorsque le service supporte ce mécanisme.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R56</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-27">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-056-ne-pas-installer-xinetd">HARDE-RHEL-056 : Ne pas installer xinetd</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.1.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-27">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-056 :</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-56 : Ne pas installer xinetd&quot;</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="ex">dnf</span> remove xinetd <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="co"># Fin: HARDE-RHEL-56</span></span></code></pre></div>
<h3 id="méthode-daudit-29">Méthode d’audit</h3>
<h2 id="harde-rhel-057-sassurer-que-le-serveur-ftp-est-désactivé">HARDE-RHEL-057 : S’assurer que le serveur FTP est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.10</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-28">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-057 :</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-57 : S&#39;assurer que le serveur FTP est désactivé&quot;</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable vsftpd <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="co"># Fin: HARDE-RHEL-57</span></span></code></pre></div>
<h3 id="méthode-daudit-30">Méthode d’audit</h3>
<h2 id="harde-rhel-058-sassurer-que-le-serveur-dns-est-désactivé">HARDE-RHEL-058 : S’assurer que le serveur DNS est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.11</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-29">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-058 :</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-58 : S&#39;assurer que le serveur DNS est désactivé&quot;</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable named <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="co"># Fin: HARDE-RHEL-58</span></span></code></pre></div>
<h3 id="méthode-daudit-31">Méthode d’audit</h3>
<h2 id="harde-rhel-059-sassurer-que-nfs-est-désactivé">HARDE-RHEL-059 : S’assurer que NFS est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.12</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-30">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-059 :</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-59 : S&#39;assurer que NFS est désactivé&quot;</span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable nfs-server <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="co"># Fin: HARDE-RHEL-59</span></span></code></pre></div>
<h3 id="méthode-daudit-32">Méthode d’audit</h3>
<h2 id="harde-rhel-060-sassurer-que-rpc-est-désactivé">HARDE-RHEL-060 : S’assurer que RPC est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.13</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-31">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-060 :</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-60 : S&#39;assurer que RPC est désactivé&quot;</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable rpcbind <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="co"># Fin: HARDE-RHEL-60</span></span></code></pre></div>
<h3 id="méthode-daudit-33">Méthode d’audit</h3>
<h2 id="harde-rhel-061-sassurer-que-le-serveur-ldap-est-désactivé">HARDE-RHEL-061 : S’assurer que le serveur LDAP est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.14</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-32">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-061 :</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-61 : S&#39;assurer que le serveur LDAP est désactivé&quot;</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable slapd <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="co"># Fin: HARDE-RHEL-61</span></span></code></pre></div>
<h3 id="méthode-daudit-34">Méthode d’audit</h3>
<h2 id="harde-rhel-062-sassurer-que-le-serveur-dhcp-est-désactivé">HARDE-RHEL-062 : S’assurer que le serveur DHCP est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.15</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-33">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-062 :</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-62 : S&#39;assurer que le serveur DHCP est désactivé&quot;</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable dhcpd <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="co"># Fin: HARDE-RHEL-62</span></span></code></pre></div>
<h3 id="méthode-daudit-35">Méthode d’audit</h3>
<h2 id="harde-rhel-063-sassurer-que-le-serveur-cups-est-désactivé">HARDE-RHEL-063 : S’assurer que le serveur CUPS est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.16</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-34">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-063 :</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-63 : S&#39;assurer que le serveur CUPS est désactivé&quot;</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable cups <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="co"># Fin: HARDE-RHEL-63</span></span></code></pre></div>
<h3 id="méthode-daudit-36">Méthode d’audit</h3>
<h2 id="harde-rhel-064-sassurer-que-le-serveur-nis-est-désactivé">HARDE-RHEL-064 : S’assurer que le serveur NIS est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.17</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-35">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-064 :</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-64 : S&#39;assurer que le serveur NIS est désactivé&quot;</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable ypserv <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="co"># Fin: HARDE-RHEL-64</span></span></code></pre></div>
<h3 id="méthode-daudit-37">Méthode d’audit</h3>
<h2 id="harde-rhel-065-sassurer-que-lagent-de-transfert-de-mail-soit-en-mode-local-seulement">HARDE-RHEL-065 : S’assurer que l’agent de transfert de mail soit en mode local seulement</h2>
<p>Pas de serveur mail (MTA) installé</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.18</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-28">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-066-désactiver-le-service-rsyncd">HARDE-RHEL-066 : Désactiver le service rsyncd</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-36">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-066 :</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-66 : Désactiver le service rsyncd&quot;</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable rsyncd <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co"># Fin: HARDE-RHEL-66</span></span></code></pre></div>
<h3 id="méthode-daudit-38">Méthode d’audit</h3>
<h2 id="harde-rhel-067-sassurer-que-le-serveur-avahi-est-désactivé">HARDE-RHEL-067 : S’assurer que le serveur Avahi est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-37">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-067 :</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-67 : S&#39;assurer que le serveur Avahi est désactivé&quot;</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable avahi-daemon <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="co"># Fin: HARDE-RHEL-67</span></span></code></pre></div>
<h3 id="méthode-daudit-39">Méthode d’audit</h3>
<h2 id="harde-rhel-068-sassurer-que-le-serveur-snmp-est-désactivé">HARDE-RHEL-068 : S’assurer que le serveur SNMP est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-38">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-068 :</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-68 : S&#39;assurer que le serveur SNMP est désactivé&quot;</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable snmpd <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="co"># Fin: HARDE-RHEL-68</span></span></code></pre></div>
<h3 id="méthode-daudit-40">Méthode d’audit</h3>
<h2 id="harde-rhel-069-sassurer-que-le-service-proxy-http-est-désactivé">HARDE-RHEL-069 : S’assurer que le service Proxy HTTP est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-39">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-069 :</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-69 : S&#39;assurer que le service Proxy HTTP est désactivé&quot;</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable squid <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="co"># Fin: HARDE-RHEL-69</span></span></code></pre></div>
<h3 id="méthode-daudit-41">Méthode d’audit</h3>
<h2 id="harde-rhel-070-sassurer-que-le-service-samba-est-désactivé">HARDE-RHEL-070 : S’assurer que le service Samba est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.7</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-40">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-070 :</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-70 : S&#39;assurer que le service Samba  est désactivé&quot;</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable smb <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="co"># Fin: HARDE-RHEL-70</span></span></code></pre></div>
<h3 id="méthode-daudit-42">Méthode d’audit</h3>
<h2 id="harde-rhel-071-sassurer-que-le-service-imappop3-est-désactivé">HARDE-RHEL-071 : S’assurer que le service IMAP/POP3 est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.8</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-41">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-071 :</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-71 : S&#39;assurer que le service IMAP/POP3 est désactivé&quot;</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable dovecot <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="co"># Fin: HARDE-RHEL-71</span></span></code></pre></div>
<h3 id="méthode-daudit-43">Méthode d’audit</h3>
<h2 id="harde-rhel-072-sassurer-que-le-serveur-http-est-désactivé">HARDE-RHEL-072 : S’assurer que le serveur HTTP est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.9</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-42">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-072 :</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-72 : S&#39;assurer que le serveur HTTP est désactivé&quot;</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> disable httpd <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="co"># Fin: HARDE-RHEL-72</span></span></code></pre></div>
<h3 id="méthode-daudit-44">Méthode d’audit</h3>
<h2 id="harde-rhel-073-désactiver-les-protocoles-ddcp-sctp-rds-et-tipc">HARDE-RHEL-073 : Désactiver les protocoles DDCP, SCTP, RDS et TIPC</h2>
<p>Désactiver dccp, sctp, rds, tipc en lançant la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-29">Méthode d’implémentation</h3>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-073:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> dccp sctp rds tipc<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="op">&gt;</span><span class="st">&quot;/etc/modprobe.d/</span><span class="va">$i</span><span class="st">.conf&quot;</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="st">install </span><span class="va">$i</span><span class="st"> /bin/true</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="ex">rmmod</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span> <span class="kw">||</span> <span class="fu">true</span> <span class="kw">;</span> <span class="cf">done</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fin: HARDE-RHEL-73</span></span></code></pre></div>
<h3 id="méthode-daudit-45">Méthode d’audit</h3>
<h2 id="harde-rhel-074-durcissement-et-surveillance-des-services-soumis-à">HARDE-RHEL-074 : Durcissement et surveillance des services soumis à</h2>
<p>des flux arbitraires</p>
<p>Les services exposés à des flux non maîtrisés doivent être surveillés et particulièrement durcis. Cette directive est générique et ne peut être mise en place de manière automatique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R21</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-30">Méthode d’implémentation</h3>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-074:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="ex">des</span> flux arbitraires<span class="st">&quot;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="st"># Fin: HARDE-RHEL-74</span></span></code></pre></div>
<h3 id="méthode-daudit-46">Méthode d’audit</h3>
<h2 id="harde-rhel-075-configuration-du-service-local-de-messagerie">HARDE-RHEL-075 : Configuration du service local de messagerie</h2>
<p>Pas de service de messagerie installé</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R48</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-31">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-076-alias-de-messagerie-des-comptes-de-service">HARDE-RHEL-076 : Alias de messagerie des comptes de service</h2>
<p>Pas de service de messagerie installé</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Ne pas implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R49</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-32">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-077-sassurer-que-firewalld-est-installé">HARDE-RHEL-077 : S’assurer que firewalld est installé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.4.1.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.4 Apply Host-based Firewalls or Port Filtering</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-43">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-077 :</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-77 : S&#39;assurer que firewalld est installé&quot;</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="ex">dnf</span> install firewalld</span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="co"># Fin: HARDE-RHEL-77</span></span></code></pre></div>
<h3 id="méthode-daudit-47">Méthode d’audit</h3>
<h2 id="harde-rhel-078-activer-le-service-firewalld">HARDE-RHEL-078 : Activer le service firewalld</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.4.2.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.4 Apply Host-based Firewalls or Port Filtering</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-44">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-078 :</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-78 : Activer le service firewalld&quot;</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> enable firewalld</span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="co"># Fin: HARDE-RHEL-78</span></span></code></pre></div>
<h3 id="méthode-daudit-48">Méthode d’audit</h3>
<h2 id="harde-rhel-079-désactiver-iptables">HARDE-RHEL-079 : Désactiver iptables</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.4.2.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.4 Apply Host-based Firewalls or Port Filtering</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-45">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-079 :</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-79 : Désactiver iptables&quot;</span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> mask iptables</span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="co"># Fin: HARDE-RHEL-79</span></span></code></pre></div>
<h3 id="méthode-daudit-49">Méthode d’audit</h3>
<h2 id="harde-rhel-080-désactiver-nftables">HARDE-RHEL-080 : Désactiver nftables</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.4.2.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.4 Apply Host-based Firewalls or Port Filtering</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-46">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-080 :</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-80 : Désactiver nftables&quot;</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> mask nftables</span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="co"># Fin: HARDE-RHEL-80</span></span></code></pre></div>
<h3 id="méthode-daudit-50">Méthode d’audit</h3>
<h2 id="harde-rhel-081-sassurer-quune-zone-par-défaut-est-définie">HARDE-RHEL-081 : S’assurer qu’une zone par défaut est définie</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.4.2.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.4 Apply Host-based Firewalls or Port Filtering</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-47">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-081 :</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-81 : S&#39;assurer qu&#39;une zone par défaut est définie&quot;</span></span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="ex">firewall-cmd</span> <span class="at">--set-default-zone</span><span class="op">=</span>public</span>
<span id="cb54-3"><a href="#cb54-3"></a><span class="co"># Fin: HARDE-RHEL-81</span></span></code></pre></div>
<h3 id="méthode-daudit-51">Méthode d’audit</h3>
<h2 id="harde-rhel-082-sassurer-que-les-interfaces-soient-assignées-à-une-zone">HARDE-RHEL-082 : S’assurer que les interfaces soient assignées à une zone</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.4.2.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.4 Apply Host-based Firewalls or Port Filtering</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-48">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-082 :</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-82 : S&#39;assurer que les interfaces soient assignées à une zone&quot;</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="va">ITF</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$(</span><span class="ex">nmcli</span> <span class="at">--terse</span> connection show <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F:</span> <span class="st">&#39;{print $1}&#39;</span><span class="va">)</span><span class="st">&quot;</span></span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="ex">firewall-cmd</span> <span class="at">--zone</span><span class="op">=</span>public <span class="at">--change-interface</span><span class="op">=</span><span class="st">&quot;</span><span class="va">${ITF}</span><span class="st">&quot;</span></span>
<span id="cb55-4"><a href="#cb55-4"></a><span class="co"># Fin: HARDE-RHEL-82</span></span></code></pre></div>
<h3 id="méthode-daudit-52">Méthode d’audit</h3>
<h2 id="harde-rhel-083-bloquer-les-services-et-ports-inutiles">HARDE-RHEL-083 : Bloquer les services et ports inutiles</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.4.2.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.4 Apply Host-based Firewalls or Port Filtering</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-49">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-083 :</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-83 : Bloquer les services et ports inutiles&quot;</span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="ex">firewall-cmd</span> <span class="at">--remove-service</span><span class="op">=</span>cockpit</span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="ex">firewall-cmd</span> <span class="at">--runtime-to-permanent</span></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="co"># Fin: HARDE-RHEL-83</span></span></code></pre></div>
<h3 id="méthode-daudit-53">Méthode d’audit</h3>
<h2 id="harde-rhel-084-configurer-nftables">HARDE-RHEL-084 : Configurer nftables</h2>
<p>nftables n’est pas utilisé (firewalld est installé par défaut)</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.4.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-33">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-085-configurer-iptables">HARDE-RHEL-085 : Configurer iptables</h2>
<p>iptables n’est pas utilisé (firewalld est installé par défaut)</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.4.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-34">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-086-désactiver-les-interfaces-sans-fil">HARDE-RHEL-086 : Désactiver les interfaces sans fil</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 3.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">15.4 Disable Wireless Access on Devices if Not Required<br>15.5 Limit Wireless Access on Client Devices</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-50">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-086 :</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-86 : Désactiver les interfaces sans fil&quot;</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="ex">nmcli</span> radio all off</span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="co"># Fin: HARDE-RHEL-86</span></span></code></pre></div>
<h3 id="méthode-daudit-54">Méthode d’audit</h3>
<h2 id="harde-rhel-087-activation-de-selinux-avec-la-politique-targeted">HARDE-RHEL-087 : Activation de SELinux avec la politique targeted</h2>
<p>SELinux est activé par défaut sous Red Hat 8.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.7.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.6 Protect Information through Access Control Lists</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R66</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-51">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-087 :</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-87 : Activation de SELinux avec la politique targeted&quot;</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="ex">selinuxenabled</span> <span class="kw">||</span> <span class="ex">setenforce</span> 1</span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="ex">fixfiles</span> onboot</span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="co"># Fin: HARDE-RHEL-87</span></span></code></pre></div>
<h3 id="méthode-daudit-55">Méthode d’audit</h3>
<h2 id="harde-rhel-088-désinstallation-des-outils-de-débogage-de-politique-selinux">HARDE-RHEL-088 : Désinstallation des outils de débogage de politique SELinux</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.7.1.6<br>RHEL 8 1.7.1.7</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.6 Protect Information through Access Control Lists<br>9.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R68</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-52">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-088 :</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-88 : Désinstallation des outils de débogage de politique SELinux&quot;</span></span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="ex">dnf</span> remove settroubleshoot mcstrans</span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="co"># Fin: HARDE-RHEL-88</span></span></code></pre></div>
<h3 id="méthode-daudit-56">Méthode d’audit</h3>
<h2 id="harde-rhel-089-sassurer-que-atcron-est-restreint-aux-utilisateurs-autorisés">HARDE-RHEL-089 : S’assurer que at/cron est restreint aux utilisateurs autorisés</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.1.8</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16 Account Monitoring and Control</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-53">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-089 :</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-89 : S&#39;assurer que at/cron est restreint aux utilisateurs autorisés&quot;</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="fu">rm</span> <span class="at">-f</span> /etc/cron.deny</span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="fu">rm</span> <span class="at">-f</span> /etc/at.deny</span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="fu">true</span> <span class="op">&gt;</span>/etc/cron.allow</span>
<span id="cb60-5"><a href="#cb60-5"></a><span class="fu">true</span> <span class="op">&gt;</span>/etc/at.allow</span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="fu">chmod</span> og-rwx /etc/cron.allow</span>
<span id="cb60-7"><a href="#cb60-7"></a><span class="fu">chmod</span> og-rwx /etc/at.allow</span>
<span id="cb60-8"><a href="#cb60-8"></a><span class="fu">chown</span> root:root /etc/cron.allow</span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="fu">chown</span> root:root /etc/at.allow</span>
<span id="cb60-10"><a href="#cb60-10"></a><span class="co"># Fin: HARDE-RHEL-89</span></span></code></pre></div>
<h3 id="méthode-daudit-57">Méthode d’audit</h3>
<h2 id="harde-rhel-090-sassurer-que-laccès-ssh-soit-limité">HARDE-RHEL-090 : S’assurer que l’accès SSH soit limité</h2>
<p>Éditer le fichier /etc/ssh/sshd_config pour restreindre la connexion aux membres du groupe sudoers: AllowGroups sudogrp DenyUsers root</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.3 Ensure the Use of Dedicated Administrative Accounts</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-54">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-090 :</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-90 : S&#39;assurer que l&#39;accès SSH soit limité&quot;</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^AllowGroups sudogrp&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;AllowGroups sudogrp&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/ssd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^DenyUsers root&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;DenyUsers root&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/ssd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="co"># Fin: HARDE-RHEL-90</span></span></code></pre></div>
<h3 id="méthode-daudit-58">Méthode d’audit</h3>
<h2 id="harde-rhel-091-sassurer-que-laccès-à-la-commande-su-est-limité">HARDE-RHEL-091 : S’assurer que l’accès à la commande su est limité</h2>
<p>Lancer la commande suivante (Et voir HARDE-RHEL-148)</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.7</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-55">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-091 :</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb62-1"><a href="#cb62-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-91 : S&#39;assurer que l&#39;accès à la commande su est limité&quot;</span></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="ex">usermod</span> <span class="at">-a</span> <span class="at">-G</span> wheel root</span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="co"># Fin: HARDE-RHEL-91</span></span></code></pre></div>
<h3 id="méthode-daudit-59">Méthode d’audit</h3>
<h2 id="harde-rhel-092-sassurer-de-lintégrité-de-la-variable-path-pour-root">HARDE-RHEL-092 : S’assurer de l’intégrité de la variable PATH pour root</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-35">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-093-imputabilité-des-opérations-dadministration">HARDE-RHEL-093 : Imputabilité des opérations d’administration</h2>
<p>Chaque administrateur doit avoir un compte dédié et changer de privilèges en passant par sudo</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R19</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-36">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-094-répertoires-temporaires-dédiés-aux-comptes">HARDE-RHEL-094 : Répertoires temporaires dédiés aux comptes</h2>
<p>pam_namespace est utilisé (installé par défaut sous Red Hat 8) mais une attention particulière doit être porté au montage temporaire (dans certains cas d’utilisation de su/sudo, les points de montage ne seront pas visibles des autres utilisateurs). Ceci a également des effets sur les logiciels qui partagent entre sessions ou entre utilisateurs des fichiers ou des sockets dans /tmp. Dans ce cas-là il faut s’assurer que l’application soit configurée pour utiliser un répertoire spécifique.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R39</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-56">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-094 :</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-94 : Répertoires temporaires dédiés aux comptes&quot;</span></span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="ex">setsebool</span> <span class="at">-P</span> polyinstantiation_enabled=on</span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/secure_namespace.sh <span class="op">&lt;&lt;EOF</span></span>
<span id="cb63-4"><a href="#cb63-4"></a><span class="st">#! /bin/bash</span></span>
<span id="cb63-5"><a href="#cb63-5"></a></span>
<span id="cb63-6"><a href="#cb63-6"></a><span class="st">function copy_se_labels() {</span></span>
<span id="cb63-7"><a href="#cb63-7"></a><span class="st">    # copy SElinux labels from </span><span class="va">$1</span><span class="st"> to </span><span class="va">$2</span></span>
<span id="cb63-8"><a href="#cb63-8"></a><span class="st">    # use copy_se_labels /var/www /srv/www(/.*)?</span></span>
<span id="cb63-9"><a href="#cb63-9"></a><span class="st">    semanage fcontext --modify --equal &quot;</span><span class="va">$1</span><span class="st">&quot; &quot;</span><span class="va">$2</span><span class="st">&quot; || true</span></span>
<span id="cb63-10"><a href="#cb63-10"></a><span class="st">    restorecon -R &quot;</span><span class="va">$2</span><span class="st">&quot;</span></span>
<span id="cb63-11"><a href="#cb63-11"></a><span class="st">}</span></span>
<span id="cb63-12"><a href="#cb63-12"></a><span class="st"># As /tmp is cleaned at each reboot, recreate them as needed</span></span>
<span id="cb63-13"><a href="#cb63-13"></a><span class="st">if ! [ -d /tmp/namespace ] ; then</span></span>
<span id="cb63-14"><a href="#cb63-14"></a><span class="st">    mkdir /tmp/namespace </span></span>
<span id="cb63-15"><a href="#cb63-15"></a><span class="st">fi </span></span>
<span id="cb63-16"><a href="#cb63-16"></a><span class="st">if ! [ -d /var/tmp/namespace ] ; then</span></span>
<span id="cb63-17"><a href="#cb63-17"></a><span class="st">    mkdir /var/tmp/namespace</span></span>
<span id="cb63-18"><a href="#cb63-18"></a><span class="st">fi</span></span>
<span id="cb63-19"><a href="#cb63-19"></a><span class="st">chmod 000 /tmp/namespace</span></span>
<span id="cb63-20"><a href="#cb63-20"></a><span class="st">#chcon --reference=/tmp /tmp/namespace</span></span>
<span id="cb63-21"><a href="#cb63-21"></a><span class="st">copy_se_labels /tmp /tmp/namespace</span></span>
<span id="cb63-22"><a href="#cb63-22"></a><span class="st">chmod 000 /var/tmp/namespace </span></span>
<span id="cb63-23"><a href="#cb63-23"></a><span class="st">#chcon --reference=/var/tmp /var/tmp/namespace</span></span>
<span id="cb63-24"><a href="#cb63-24"></a><span class="st">copy_se_labels /var/tmp /var/tmp/namespace</span></span>
<span id="cb63-25"><a href="#cb63-25"></a><span class="op">EOF</span></span>
<span id="cb63-26"><a href="#cb63-26"></a><span class="fu">chmod</span> 0700 /etc/secure_namespace.sh</span>
<span id="cb63-27"><a href="#cb63-27"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/system/secure_namespace.service <span class="op">&lt;&lt;EOF</span></span>
<span id="cb63-28"><a href="#cb63-28"></a><span class="st">[Unit]</span></span>
<span id="cb63-29"><a href="#cb63-29"></a><span class="st">Description=Script to create the required directories for pam_namespace</span></span>
<span id="cb63-30"><a href="#cb63-30"></a></span>
<span id="cb63-31"><a href="#cb63-31"></a><span class="st">[Service]</span></span>
<span id="cb63-32"><a href="#cb63-32"></a><span class="st">Type=oneshot</span></span>
<span id="cb63-33"><a href="#cb63-33"></a><span class="st">ExecStart=/etc/secure_namespace.sh</span></span>
<span id="cb63-34"><a href="#cb63-34"></a><span class="st">TimeoutStartSec=0</span></span>
<span id="cb63-35"><a href="#cb63-35"></a></span>
<span id="cb63-36"><a href="#cb63-36"></a><span class="st">[Install]</span></span>
<span id="cb63-37"><a href="#cb63-37"></a><span class="st">WantedBy=multi-user.target</span></span>
<span id="cb63-38"><a href="#cb63-38"></a><span class="op">EOF</span></span>
<span id="cb63-39"><a href="#cb63-39"></a><span class="ex">systemctl</span> enable secure_namespace</span>
<span id="cb63-40"><a href="#cb63-40"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/security/namespace.d/10tmp.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb63-41"><a href="#cb63-41"></a><span class="st">/tmp     /tmp/namespace/        level      root</span></span>
<span id="cb63-42"><a href="#cb63-42"></a><span class="st">/var/tmp /var/tmp/namespace/    level      root</span></span>
<span id="cb63-43"><a href="#cb63-43"></a><span class="op">EOF</span></span>
<span id="cb63-44"><a href="#cb63-44"></a><span class="co"># Fin: HARDE-RHEL-94</span></span></code></pre></div>
<h3 id="méthode-daudit-60">Méthode d’audit</h3>
<h2 id="harde-rhel-095-activation-des-profils-de-sécurité-apparmor">HARDE-RHEL-095 : Activation des profils de sécurité AppArmor</h2>
<p>AppArmor n’est pas installé par défaut sous Red Hat 8. La fonctionnalité équivalente est obtenue par l’utilisation de selinux.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Ne pas implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R65</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-37">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-096-paramétrage-des-booléens-selinux">HARDE-RHEL-096 : Paramétrage des booléens SELinux</h2>
<p>La politique SELinux inclut aussi des booléens permettant de définir des comportements particuliers du système. Aussi les booléens suivants sont positionnés à <em>off</em> :</p>
<ul>
<li><code>allow_execheap</code> (interdit aux processus de rendre exécutable leur tas — <em>heap</em>);</li>
<li><code>allow_execstack</code> (interdit aux processus le droit de rendre leur pile — <em>stack</em> — exécutable);</li>
<li><code>allow_execmod</code> (interdit aux processus d’utiliser des bibliothèques qui demande la relocalisation de code ans être étiquetées <em>textrel_shlib_t</em>);</li>
<li><code>ssh_sysadm_login</code> (interdit les logins SSH de se connecter directement en rôle sysadmin).</li>
</ul>
<p>Le booléen suivant est positionné à <em>on</em> :</p>
<ul>
<li><code>deny_execmem</code> (interdit aux processus d’avoir une zone mémoire avec des droits en écriture —w— et en exécution —x—), aussi appelé W^X;</li>
</ul>
<p>Le paramètre suivant est positionné au démarrage suivant le mode de fonctionnement (maintenance ou normal):</p>
<ul>
<li><code>secure_mode_insmod</code> (interdit le chargement dynamique des modules par n’importe quel processus);</li>
</ul>
<p>☛ Certains logiciels risquent de <strong>mal fonctionner</strong> à cause de réglages ci-dessus. La majeure partie du temps, le problème est du à une procédure de <em>build</em> incorrecte et doit donc être corrigé par l’éditeur.</p>
<p>À titre d’exemple, l’agent Trend Micro Deep Security 20.0 peut ne pas fonctionner. Les messages d’audit (<em>AVC</em> — remontent un <code>avc:  denied  { execstack }</code>) signalent que la bibliothèque <code>libcrypto.so.1.0.0</code> ne peut être chargée (<em>error while loading shared libraries: libcrypto.so.1.0.0: cannot enable executable stack as shared object requires: Permission denied</em>). En utilisant l’utilitaire <code>execstack</code> pour supprimer le drapeau demandant la pile exécutable, l’agent fonctionne correctement :</p>
<p><code>execstack -c /opt/ds_agent/ds_agent/lib/libcrypto.so.1.0.0</code></p>
<p>Un bonne pratique est alors de reporter à l’éditeur du logiciel en question cette incompatibilité en précisant que ces réglages pourraient être les règles par défaut des futures Red Hat.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R67</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-57">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-096 :</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-96 : Paramétrage des booléens SELinux&quot;</span></span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="ex">setsebool</span> <span class="at">-P</span> allow_execheap=off</span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="ex">setsebool</span> <span class="at">-P</span> allow_execmod=off</span>
<span id="cb64-5"><a href="#cb64-5"></a><span class="ex">setsebool</span> <span class="at">-P</span> deny_execmem=on</span>
<span id="cb64-6"><a href="#cb64-6"></a><span class="ex">setsebool</span> <span class="at">-P</span> allow_execstack=off</span>
<span id="cb64-7"><a href="#cb64-7"></a><span class="co"># paramètrage appliqué dynamiquement à la fin du processus de boot,</span></span>
<span id="cb64-8"><a href="#cb64-8"></a><span class="co"># en fonction du mode maintenance : setsebool -P secure_mode_insmod=on</span></span>
<span id="cb64-9"><a href="#cb64-9"></a><span class="ex">setsebool</span> <span class="at">-P</span> ssh_sysadm_login=off</span>
<span id="cb64-10"><a href="#cb64-10"></a><span class="bu">echo</span></span>
<span id="cb64-11"><a href="#cb64-11"></a><span class="co"># Fin: HARDE-RHEL-96</span></span></code></pre></div>
<h3 id="méthode-daudit-61">Méthode d’audit</h3>
<h2 id="harde-rhel-097-confinement-des-utilisateurs-interactifs-non-privilégiés">HARDE-RHEL-097 : Confinement des utilisateurs interactifs non privilégiés</h2>
<p>Pour confiner un utilisateur à un rôle non privilégié avec SELinux, lancer la commande suivante : usermod -Z user_u utilisateur Les autres utilisateurs sont donc en mode unconfined_t</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R69</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-58">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-097 :</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb65-1"><a href="#cb65-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-97 : Confinement des utilisateurs interactifs non privilégiés&quot;</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co"># Find at least one user to add to sudogrp</span></span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="va">USER1000</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">grep</span> 1000 /etc/passwd <span class="kw">|</span> <span class="fu">awk</span> <span class="at">-F:</span> <span class="st">&#39;{print $1}&#39;</span><span class="va">)</span><span class="st">&quot;</span></span>
<span id="cb65-4"><a href="#cb65-4"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">&quot;Merci de préciser le nom d&#39;un utilisateur à qui donner des droits administrateur [</span><span class="va">$USER1000</span><span class="st">] ? &quot;</span></span>
<span id="cb65-5"><a href="#cb65-5"></a><span class="bu">read</span> <span class="at">-e</span> <span class="at">-i</span> <span class="st">&quot;</span><span class="va">$USER1000</span><span class="st">&quot;</span> <span class="at">-r</span> <span class="va">ADMINUSER</span></span>
<span id="cb65-6"><a href="#cb65-6"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb65-7"><a href="#cb65-7"></a>  <span class="va">ADMINUSER</span><span class="op">=</span><span class="st">&quot;</span><span class="va">${USER1000}</span><span class="st">&quot;</span></span>
<span id="cb65-8"><a href="#cb65-8"></a><span class="cf">fi</span></span>
<span id="cb65-9"><a href="#cb65-9"></a><span class="ex">groupadd</span> <span class="at">-r</span> <span class="at">-f</span> sudogrp</span>
<span id="cb65-10"><a href="#cb65-10"></a><span class="bu">echo</span> <span class="st">&quot;%sudogrp    ALL=(ALL)  TYPE=unconfined_t ROLE=unconfined_r    ALL&quot;</span> <span class="op">&gt;</span>/etc/sudoers.d/15group</span>
<span id="cb65-11"><a href="#cb65-11"></a><span class="co">#usermod -Z sysadm_u &quot;${ADMINUSER}&quot;</span></span>
<span id="cb65-12"><a href="#cb65-12"></a><span class="ex">semanage</span> login <span class="at">-a</span> <span class="at">-s</span> staff_u <span class="at">-rs0:c0.c1023</span> <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span> <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb65-13"><a href="#cb65-13"></a><span class="ex">usermod</span> <span class="at">-G</span> sudogrp <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span></span>
<span id="cb65-14"><a href="#cb65-14"></a><span class="co"># For unprivileged user, use usermod -Z user_u &lt;unprivileged&gt;</span></span>
<span id="cb65-15"><a href="#cb65-15"></a><span class="ex">semanage</span> login <span class="at">-m</span> <span class="at">-r</span> s0 <span class="at">-s</span> user_u __default__</span>
<span id="cb65-16"><a href="#cb65-16"></a><span class="co"># restorecon is required at this point and will be performed on reboot</span></span>
<span id="cb65-17"><a href="#cb65-17"></a><span class="co"># Fin: HARDE-RHEL-97</span></span></code></pre></div>
<h3 id="méthode-daudit-62">Méthode d’audit</h3>
<h2 id="harde-rhel-098-utiliser-une-source-de-temps">HARDE-RHEL-098 : Utiliser une source de temps</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.1.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.1 Utilize Three Synchronized Time Sources</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-59">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-098 :</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb66-1"><a href="#cb66-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-98 : Utiliser une source de temps&quot;</span></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="ex">dnf</span> install chrony</span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="co"># Fin: HARDE-RHEL-98</span></span></code></pre></div>
<h3 id="méthode-daudit-63">Méthode d’audit</h3>
<h2 id="harde-rhel-099-sassurer-que-chrony-est-configuré">HARDE-RHEL-099 : S’assurer que chrony est configuré</h2>
<p>S’assurer que le fichier /etc/chrony.conf contienne au moins une ligne server</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.1.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.1 Utilize Three Synchronized Time Sources</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-38">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-100-service-autofs-désactivé">HARDE-RHEL-100 : Service autofs désactivé</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.22</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">08.4 Configure Anti-Malware Scanning of Removable Devices<br>08.5 Configure Devices Not To Auto-run Content</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-39">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-101-supprimer-le-serveur-x">HARDE-RHEL-101 : Supprimer le serveur X</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.2.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">02.6 Address unapproved software</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-60">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-101 :</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb67-1"><a href="#cb67-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-101 : Supprimer le serveur X&quot;</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="ex">dnf</span> remove xorg-x11<span class="pp">*</span>.<span class="pp">*</span></span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="co"># Fin: HARDE-RHEL-101</span></span></code></pre></div>
<h3 id="méthode-daudit-64">Méthode d’audit</h3>
<h2 id="harde-rhel-102-sassurer-que-le-client-nis-nest-pas-installé">HARDE-RHEL-102 : S’assurer que le client NIS n’est pas installé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.3.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">02.6 Address unapproved software</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-61">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-102 :</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb68-1"><a href="#cb68-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-102 : S&#39;assurer que le client NIS n&#39;est pas installé&quot;</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="ex">dnf</span> remove ypbind</span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="co"># Fin: HARDE-RHEL-102</span></span></code></pre></div>
<h3 id="méthode-daudit-65">Méthode d’audit</h3>
<h2 id="harde-rhel-103-sassurer-que-le-client-telnet-nest-pas-installé">HARDE-RHEL-103 : S’assurer que le client telnet n’est pas installé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.3.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.5 Use Multifactor Authentication For All Administrative Access</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-62">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-103 :</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb69-1"><a href="#cb69-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-103 : S&#39;assurer que le client telnet n&#39;est pas installé&quot;</span></span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="ex">dnf</span> remove telnet</span>
<span id="cb69-3"><a href="#cb69-3"></a><span class="co"># Fin: HARDE-RHEL-103</span></span></code></pre></div>
<h3 id="méthode-daudit-66">Méthode d’audit</h3>
<h2 id="harde-rhel-104-sassurer-que-le-client-ldap-nest-pas-installé">HARDE-RHEL-104 : S’assurer que le client ldap n’est pas installé</h2>
<p>Si la machine ne fait pas partie d’un domaine Windows, dnf remove openldap-clients</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 2.3.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">02.6 Address unapproved software</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R1</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-40">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-105-sassurer-que-le-paramètre-ssh-allowtcpforwarding-est-désactivé">HARDE-RHEL-105 : S’assurer que le paramètre SSH AllowTcpForwarding est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.17</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-63">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-105 :</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb70-1"><a href="#cb70-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-105 : S&#39;assurer que le paramètre SSH AllowTcpForwarding est désactivé&quot;</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="at">-e</span> <span class="st">&#39;s/\(^AllowTcpForwarding yes\)/\#HARDE-RHEL-105: \1/&#39;</span> /etc/ssh/sshd_config</span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^AllowTcpForwarding&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;AllowTcpForwarding no&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb70-4"><a href="#cb70-4"></a><span class="co"># Fin: HARDE-RHEL-105</span></span></code></pre></div>
<h3 id="méthode-daudit-67">Méthode d’audit</h3>
<h2 id="harde-rhel-106-sassurer-que-le-transfert-x11-ssh-est-désactivé">HARDE-RHEL-106 : S’assurer que le transfert X11 SSH est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-64">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-106 :</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb71-1"><a href="#cb71-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-106 : S&#39;assurer que le transfert X11 SSH est désactivé&quot;</span></span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="at">-e</span> <span class="st">&#39;s/\(^X11Forwarding yes\)/\#HARDE-RHEL-106: \1/&#39;</span> /etc/ssh/sshd_config</span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^X11Forwarding\s+no&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;X11Forwarding no&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="co"># Fin: HARDE-RHEL-106</span></span></code></pre></div>
<h3 id="méthode-daudit-68">Méthode d’audit</h3>
<h2 id="harde-rhel-107-installer-sudo">HARDE-RHEL-107 : Installer sudo</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.3.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.3 Ensure the Use of Dedicated Administrative Accounts</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-65">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-107 :</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb72-1"><a href="#cb72-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-107 : Installer sudo&quot;</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="ex">dnf</span> install sudo</span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="co"># Fin: HARDE-RHEL-107</span></span></code></pre></div>
<h3 id="méthode-daudit-69">Méthode d’audit</h3>
<h2 id="harde-rhel-108-sassurer-que-les-commandes-sudo-utilisent-un-pseudo-tty-et-autres-directives">HARDE-RHEL-108 : S’assurer que les commandes sudo utilisent un pseudo-TTY et autres directives</h2>
<p>La commande suivante permet de bloquer les administrateurs qui, par défaut, ne peuvent donc pas lancer de commande en tant que root, seulement éditer des fichiers par sudoedit. En supprimant le noexec, ils pourront lancer une commande arbitraire. L’alternative est de spécifier une liste blanche en modifiant la liste dans /etc/sudoers.d/15group</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.3.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R58</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-66">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-108 :</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb73-1"><a href="#cb73-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-108 : S&#39;assurer que les commandes sudo utilisent un pseudo-TTY et autres directives&quot;</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sudoers.d/10secure <span class="op">&lt;&lt;EOF</span></span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="st">#Defaults noexec</span></span>
<span id="cb73-4"><a href="#cb73-4"></a><span class="st">#Defaults use_pty</span></span>
<span id="cb73-5"><a href="#cb73-5"></a><span class="st">Defaults requiretty,umask=0027</span></span>
<span id="cb73-6"><a href="#cb73-6"></a><span class="st">Defaults ignore_dot,env_reset,passwd_timeout=1</span></span>
<span id="cb73-7"><a href="#cb73-7"></a><span class="st">Defaults timestamp_timeout=5</span></span>
<span id="cb73-8"><a href="#cb73-8"></a><span class="op">EOF</span></span>
<span id="cb73-9"><a href="#cb73-9"></a><span class="co"># Fin: HARDE-RHEL-108</span></span></code></pre></div>
<h3 id="méthode-daudit-70">Méthode d’audit</h3>
<h2 id="harde-rhel-109-afficher-des-bannières-lors-de-la-connexion">HARDE-RHEL-109 : Afficher des bannières lors de la connexion</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.8.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-67">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-109 :</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb74-1"><a href="#cb74-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-109 : Afficher des bannières lors de la connexion&quot;</span></span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="cf">for</span> i <span class="kw">in</span> /etc/motd /etc/issue /etc/issue.net<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb74-3"><a href="#cb74-3"></a>  <span class="fu">cat</span> <span class="op">&gt;</span><span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb74-4"><a href="#cb74-4"></a><span class="st">***************************************************************************</span></span>
<span id="cb74-5"><a href="#cb74-5"></a><span class="st">*L’utilisation d’un poste classifié n’est autorisée qu’aux personnes ayant* </span></span>
<span id="cb74-6"><a href="#cb74-6"></a><span class="st">*le niveau d’habilitation requis.                                         *</span></span>
<span id="cb74-7"><a href="#cb74-7"></a><span class="st">*Tout manquement à cette règle est considéré comme une compromission du   *</span></span>
<span id="cb74-8"><a href="#cb74-8"></a><span class="st">* secret de la défense nationale et entraine une poursuite judicaire.     *    </span></span>
<span id="cb74-9"><a href="#cb74-9"></a><span class="st">*                                  (Art. 66. IGI 1300 du 30 novembre 2011)* </span></span>
<span id="cb74-10"><a href="#cb74-10"></a><span class="st">***************************************************************************</span></span>
<span id="cb74-11"><a href="#cb74-11"></a><span class="op">EOF</span></span>
<span id="cb74-12"><a href="#cb74-12"></a><span class="cf">done</span></span>
<span id="cb74-13"><a href="#cb74-13"></a><span class="co"># Fin: HARDE-RHEL-109</span></span></code></pre></div>
<h3 id="méthode-daudit-71">Méthode d’audit</h3>
<h2 id="harde-rhel-110-sassurer-que-le-paramètre-ssh-root-login-est-désactivé">HARDE-RHEL-110 : S’assurer que le paramètre SSH root login est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.10</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.3 Ensure the Use of Dedicated Administrative Accounts</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-68">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-110 :</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb75-1"><a href="#cb75-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-110 : S&#39;assurer que le paramètre SSH root login est désactivé&quot;</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="at">-e</span> <span class="st">&#39;s/\(^PermitRootLogin yes\)/\#HARDE-RHEL-110: \1/&#39;</span> /etc/ssh/sshd_config</span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^PermitRootLogin\s+no&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;PermitRootLogin no&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="co"># Fin: HARDE-RHEL-110</span></span></code></pre></div>
<h3 id="méthode-daudit-72">Méthode d’audit</h3>
<h2 id="harde-rhel-111-sassurer-que-le-paramètre-ssh-permitemptypasswords-est-désactivé">HARDE-RHEL-111 : S’assurer que le paramètre SSH PermitEmptyPasswords est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.11</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.3 Require Multi-factor Authentication</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-69">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-111 :</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb76-1"><a href="#cb76-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-111 : S&#39;assurer que le paramètre SSH PermitEmptyPasswords est désactivé&quot;</span></span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^PermitEmptyPasswords\s+no&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;PermitEmptyPasswords no&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="co"># Fin: HARDE-RHEL-111</span></span></code></pre></div>
<h3 id="méthode-daudit-73">Méthode d’audit</h3>
<h2 id="harde-rhel-112-sassurer-que-le-paramètre-ssh-permituserenvironment-est-désactivé">HARDE-RHEL-112 : S’assurer que le paramètre SSH PermitUserEnvironment est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.12</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-70">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-112 :</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb77-1"><a href="#cb77-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-112 : S&#39;assurer que le paramètre SSH PermitUserEnvironment est désactivé&quot;</span></span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^PermitUserEnvironment\s+no&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;PermitUserEnvironment no&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="co"># Fin: HARDE-RHEL-112</span></span></code></pre></div>
<h3 id="méthode-daudit-74">Méthode d’audit</h3>
<h2 id="harde-rhel-113-sassurer-que-le-paramètre-ssh-idle-timeout-interval-est-configuré">HARDE-RHEL-113 : S’assurer que le paramètre SSH Idle Timeout Interval est configuré</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.13</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.11 Lock Workstation Sessions After Inactivity</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-71">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-113 :</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb78-1"><a href="#cb78-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-113 : S&#39;assurer que le paramètre SSH Idle Timeout Interval est configuré&quot;</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^Client&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;ClientAliveInterval 300\nClientAliveCountMax 0&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="co"># Fin: HARDE-RHEL-113</span></span></code></pre></div>
<h3 id="méthode-daudit-75">Méthode d’audit</h3>
<h2 id="harde-rhel-114-sassurer-que-le-paramètre-ssh-logingracetime-est-positionné-à-une-minute-ou-moins">HARDE-RHEL-114 : S’assurer que le paramètre SSH LoginGraceTime est positionné à une minute ou moins</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.14</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-72">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-114 :</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb79-1"><a href="#cb79-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-114 : S&#39;assurer que le paramètre SSH LoginGraceTime est positionné à une minute ou moins&quot;</span></span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^LoginGraceTime&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;LoginGraceTime 60&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="co"># Fin: HARDE-RHEL-114</span></span></code></pre></div>
<h3 id="méthode-daudit-76">Méthode d’audit</h3>
<h2 id="harde-rhel-115-sassurer-que-la-bannière-ssh-est-configurée">HARDE-RHEL-115 : S’assurer que la bannière SSH est configurée</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.15</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-73">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-115 :</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb80-1"><a href="#cb80-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-115 : S&#39;assurer que la bannière SSH est configurée&quot;</span></span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^Banner&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;Banner /etc/issue.net&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="co"># Fin: HARDE-RHEL-115</span></span></code></pre></div>
<h3 id="méthode-daudit-77">Méthode d’audit</h3>
<h2 id="harde-rhel-116-sassurer-que-le-paramétrage-ssh-pam-est-activé">HARDE-RHEL-116 : S’assurer que le paramétrage SSH PAM est activé</h2>
<p>Conforme par défaut</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.16</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-74">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-116 :</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb81-1"><a href="#cb81-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-116 : S&#39;assurer que le paramètrage SSH PAM est activé&quot;</span></span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^UsePAM&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;UsePAM yes&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb81-3"><a href="#cb81-3"></a><span class="co"># Fin: HARDE-RHEL-116</span></span></code></pre></div>
<h3 id="méthode-daudit-78">Méthode d’audit</h3>
<h2 id="harde-rhel-117-sassurer-que-le-paramètre-ssh-maxstartups-est-configuré">HARDE-RHEL-117 : S’assurer que le paramètre SSH MaxStartups est configuré</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.18</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-75">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-117 :</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb82-1"><a href="#cb82-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-117 : S&#39;assurer que le paramètre SSH MaxStartups est configuré&quot;</span></span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^MaxStartups&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;MaxStartups 10:30:60&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="co"># Fin: HARDE-RHEL-117</span></span></code></pre></div>
<h3 id="méthode-daudit-79">Méthode d’audit</h3>
<h2 id="harde-rhel-118-sassurer-que-le-paramètre-ssh-maxsessions-est-positionné-à-4-ou-moins">HARDE-RHEL-118 : S’assurer que le paramètre SSH MaxSessions est positionné à 4 ou moins</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.19</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-76">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-118 :</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb83-1"><a href="#cb83-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-118 : S&#39;assurer que le paramètre SSH MaxSessions est positionné à 4 ou moins&quot;</span></span>
<span id="cb83-3"><a href="#cb83-3"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^MaxSessions\s+4&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb83-4"><a href="#cb83-4"></a>    <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(MaxSessions.*\)/#HARDE-RHEL-118 \1/&#39;</span> <span class="at">-i</span> /etc/ssh/sshd_config</span>
<span id="cb83-5"><a href="#cb83-5"></a>    <span class="bu">echo</span> <span class="st">&quot;MaxSessions 4&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config</span>
<span id="cb83-6"><a href="#cb83-6"></a><span class="cf">fi</span></span>
<span id="cb83-7"><a href="#cb83-7"></a><span class="co"># Fin: HARDE-RHEL-118</span></span></code></pre></div>
<h3 id="méthode-daudit-80">Méthode d’audit</h3>
<h2 id="harde-rhel-119-sassurer-que-le-paramètre-ssh-maxauthtries-est-positionné-à-4-ou-moins">HARDE-RHEL-119 : S’assurer que le paramètre SSH MaxAuthTries est positionné à 4 ou moins</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.7</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.13 Alert on Account Login Behavior Deviation</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-77">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-119 :</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb84-1"><a href="#cb84-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-119 : S&#39;assurer que le paramètre SSH MaxAuthTries est positionné à 4 ou moins&quot;</span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="bu">echo</span> <span class="st">&quot;MaxAuthTries 4&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config</span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="co"># Fin: HARDE-RHEL-119</span></span></code></pre></div>
<h3 id="méthode-daudit-81">Méthode d’audit</h3>
<h2 id="harde-rhel-120-sassurer-que-le-paramètre-ssh-ignorerhosts-est-activé">HARDE-RHEL-120 : S’assurer que le paramètre SSH IgnoreRhosts est activé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.8</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-78">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-120 :</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb85-1"><a href="#cb85-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-120 : S&#39;assurer que le paramètre SSH IgnoreRhosts est activé&quot;</span></span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^IgnoreRhosts\s+yes&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;IgnoreRhosts yes&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb85-3"><a href="#cb85-3"></a><span class="co"># Fin: HARDE-RHEL-120</span></span></code></pre></div>
<h3 id="méthode-daudit-82">Méthode d’audit</h3>
<h2 id="harde-rhel-121-sassurer-que-le-paramètre-ssh-hostbasedauthentication-est-désactivé">HARDE-RHEL-121 : S’assurer que le paramètre SSH HostbasedAuthentication est désactivé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.9</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.3 Require Multi-factor Authentication</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-41">Méthode d’implémentation</h3>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-121:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>  <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^HostbasedAuthentication\s+no&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;HostbasedAuthentication no&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fin: HARDE-RHEL-121</span></span></code></pre></div>
<h3 id="méthode-daudit-83">Méthode d’audit</h3>
<h2 id="harde-rhel-122-créer-un-profil-authselect-personnalisé">HARDE-RHEL-122 : Créer un profil authselect personnalisé</h2>
<p>Ne doit pas être implémenté sur les systèmes connectés à un annuaire Active Directory</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Ne pas implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.3.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-42">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-123-selectionner-le-profil-authselect">HARDE-RHEL-123 : Selectionner le profil authselect</h2>
<p>Ne doit pas être implémenté sur les systèmes connectés à un annuaire Active Directory</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Ne pas implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.3.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16 Account Monitoring and Control</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-43">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-124-sassurer-que-le-paramétrage-authselect-inclus-with-faillock">HARDE-RHEL-124 : S’assurer que le paramétrage authselect inclus with-faillock</h2>
<p>Ne doit pas être implémenté sur les systèmes connectés à un annuaire Active Directory</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Ne pas implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.3.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.7 Establish Process for Revoking Acs</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-44">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-125-sassurer-que-les-exigences-de-création-de-mot-de-passe-soient-correctes">HARDE-RHEL-125 : S’assurer que les exigences de création de mot de passe soient correctes</h2>
<p>La longueur minimum du mot de passe est fixé à 9 caractères, mais il est recommandé de porter cette limite à 14 pour les administrateurs</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.4.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.4 Use Unique Passwords</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-79">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-125 :</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb87-1"><a href="#cb87-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-125 : S&#39;assurer que les exigences de création de mot de passe soient correctes&quot;</span></span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^minlen&#39;</span> /etc/security/pwquality.conf<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;minlen = 9&quot;</span> <span class="op">&gt;&gt;</span>/etc/security/pwquality.conf<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb87-3"><a href="#cb87-3"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^minclass&#39;</span> /etc/security/pwquality.conf<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;minclass = 4&quot;</span> <span class="op">&gt;&gt;</span>/etc/security/pwquality.conf<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb87-4"><a href="#cb87-4"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^gecoscheck&#39;</span> /etc/security/pwquality.conf<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;gecoscheck = 1&quot;</span> <span class="op">&gt;&gt;</span>/etc/security/pwquality.conf<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^usercheck&#39;</span> /etc/security/pwquality.conf<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;usercheck = 1&quot;</span> <span class="op">&gt;&gt;</span>/etc/security/pwquality.conf<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb87-6"><a href="#cb87-6"></a><span class="co"># Fin: HARDE-RHEL-125</span></span></code></pre></div>
<h3 id="méthode-daudit-84">Méthode d’audit</h3>
<h2 id="harde-rhel-126-sassurer-que-le-verrouillage-après-des-tentatives-de-connexion-soit-configuré">HARDE-RHEL-126 : S’assurer que le verrouillage après des tentatives de connexion soit configuré</h2>
<p>Rajouter les lignes suivantes dans /etc/pam.d/password-auth et dans /etc/pam.d/system-auth: auth required pam_faillock.so preauth silent deny=5 unlock_time=1800 auth required pam_faillock.so authfail deny=5 unlock_time=1800</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.4.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.7 Establish Process for Revoking Acs</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-45">Méthode d’implémentation</h3>
<p>Ce réglage est implémenté par le script fourni par HARDE-RHEL-137.</p>
<h3 id="méthode-daudit-85">Méthode d’audit</h3>
<h2 id="harde-rhel-127-sassurer-que-la-réutilisation-danciens-mots-de-passe-soit-limitée">HARDE-RHEL-127 : S’assurer que la réutilisation d’anciens mots de passe soit limitée</h2>
<p>Rajouter les lignes suivantes dans /etc/pam.d/password-auth et dans /etc/pam.d/system-auth: password requisite pam_pwquality.so try_first_pass local_users_only enforce-for-root retry=3 remember=6 password sufficient pam_unix.so sha512 shadow try_first_pass use_authtok remember=6</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.4.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16 Account Monitoring and Control</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-80">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-127 :</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb88-1"><a href="#cb88-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-127 : S&#39;assurer que la réutilisation d&#39;anciens mots de passe soit limitée&quot;</span></span>
<span id="cb88-3"><a href="#cb88-3"></a><span class="co">#</span></span>
<span id="cb88-4"><a href="#cb88-4"></a><span class="fu">touch</span> /etc/security/opasswd</span>
<span id="cb88-5"><a href="#cb88-5"></a><span class="fu">chmod</span> 0600 /etc/security/opasswd</span>
<span id="cb88-6"><a href="#cb88-6"></a><span class="co"># ls -ldZ /etc/security/opasswd</span></span>
<span id="cb88-7"><a href="#cb88-7"></a><span class="co"># -rw-------. root root system_u:object_r:shadow_t:s0 /etc/security/opasswd</span></span>
<span id="cb88-8"><a href="#cb88-8"></a><span class="co">#</span></span>
<span id="cb88-9"><a href="#cb88-9"></a><span class="co"># La sécurisation est réalisée par HARDE-RHEL-137</span></span>
<span id="cb88-10"><a href="#cb88-10"></a><span class="co"># Fin: HARDE-RHEL-127</span></span></code></pre></div>
<h3 id="méthode-daudit-86">Méthode d’audit</h3>
<h2 id="harde-rhel-128-protection-des-mots-de-passe-stockés">HARDE-RHEL-128 : Protection des mots de passe stockés</h2>
<p>Red Hat 8 est partiellement conforme par défaut : - Supprimer la paramètre null_ok si présent dans /etc/pam.d/system-auth et /etc/pam.d/password-auth. - S’assurer que les fichiers /etc/pam.d/system-auth et /etc/pam.d/password-auth contienne: password required pam_unix.so obscure sha512 rounds=65536 - S’assurer que le fichier /etc/login.defs contienne : ENCRYPT_METHOD SHA512 SHA_CRYPT_MIN_ROUNDS 65536</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.4.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R32</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-81">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-128 :</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb89-1"><a href="#cb89-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-128 : Protection des mots de passe stockés&quot;</span></span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^ENCRYPT_METHOD\s+SHA512&#39;</span> /etc/login.defs<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb89-3"><a href="#cb89-3"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(ENCRYPT_METHOD.*\)/# \1/&#39;</span> <span class="at">-i</span> /etc/login.defs</span>
<span id="cb89-4"><a href="#cb89-4"></a>  <span class="bu">echo</span> <span class="st">&quot;ENCRYPT_METHOD SHA512&quot;</span> <span class="op">&gt;&gt;</span>/etc/login.defs</span>
<span id="cb89-5"><a href="#cb89-5"></a><span class="cf">fi</span></span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^SHA_CRYPT_MIN_ROUNDS\s+65536&#39;</span> /etc/login.defs<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb89-7"><a href="#cb89-7"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(SHA_CRYPT_MIN_ROUNDS.*\)/# \1/&#39;</span> <span class="at">-i</span> /etc/login.defs</span>
<span id="cb89-8"><a href="#cb89-8"></a>  <span class="bu">echo</span> <span class="st">&quot;SHA_CRYPT_MIN_ROUNDS 65536&quot;</span> <span class="op">&gt;&gt;</span>/etc/login.defs</span>
<span id="cb89-9"><a href="#cb89-9"></a><span class="cf">fi</span></span>
<span id="cb89-10"><a href="#cb89-10"></a><span class="va">AUTH_FILES</span><span class="op">=</span><span class="va">(</span></span>
<span id="cb89-11"><a href="#cb89-11"></a>  <span class="op">[</span><span class="dv">0</span><span class="op">]</span><span class="va">=</span><span class="st">&quot;/etc/pam.d/system-auth&quot;</span></span>
<span id="cb89-12"><a href="#cb89-12"></a>  <span class="op">[</span><span class="dv">1</span><span class="op">]</span><span class="va">=</span><span class="st">&quot;/etc/pam.d/password-auth&quot;</span></span>
<span id="cb89-13"><a href="#cb89-13"></a><span class="va">)</span></span>
<span id="cb89-14"><a href="#cb89-14"></a><span class="cf">for</span> pamFile <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${AUTH_FILES</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb89-15"><a href="#cb89-15"></a>  <span class="co"># suppress partial config and nullok</span></span>
<span id="cb89-16"><a href="#cb89-16"></a>  <span class="fu">sed</span> <span class="at">-i</span> <span class="at">--follow-symlinks</span> <span class="st">&quot;/^password.*sufficient.*pam_unix.so/ s/ nullok//&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span></span>
<span id="cb89-17"><a href="#cb89-17"></a>  <span class="fu">sed</span> <span class="at">-i</span> <span class="at">--follow-symlinks</span> <span class="st">&quot;/^password.*sufficient.*pam_unix.so/ s/ sha512//&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span></span>
<span id="cb89-18"><a href="#cb89-18"></a>  <span class="fu">sed</span> <span class="at">-i</span> <span class="at">--follow-symlinks</span> <span class="st">&quot;/^password.*sufficient.*pam_unix.so/ s/ obscure//&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span></span>
<span id="cb89-19"><a href="#cb89-19"></a>  <span class="fu">sed</span> <span class="at">-i</span> <span class="at">--follow-symlinks</span> <span class="st">&quot;/^password.*sufficient.*pam_unix.so/ s/ rounds=65536//&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span></span>
<span id="cb89-20"><a href="#cb89-20"></a>  <span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="st">&quot;^password.*sufficient.*pam_unix.so.*obscure sha512 rounds=65536&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb89-21"><a href="#cb89-21"></a>    <span class="fu">sed</span> <span class="at">-i</span> <span class="at">--follow-symlinks</span> <span class="st">&quot;/^password.*sufficient.*pam_unix.so/ s/$/ obscure sha512 rounds=65536/&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span></span>
<span id="cb89-22"><a href="#cb89-22"></a>  <span class="cf">fi</span></span>
<span id="cb89-23"><a href="#cb89-23"></a><span class="cf">done</span></span>
<span id="cb89-24"><a href="#cb89-24"></a><span class="co"># Fin: HARDE-RHEL-128</span></span></code></pre></div>
<h3 id="méthode-daudit-87">Méthode d’audit</h3>
<h2 id="harde-rhel-129-sassurer-que-lexpiration-des-mots-de-passe-soit-de-365-jours-ou-moins">HARDE-RHEL-129 : S’assurer que l’expiration des mots de passe soit de 365 jours ou moins</h2>
<p>S’assurer que la ligne suivante soit dans le fichier /etc/login.defs: PASS_MAX_DAYS 365</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.5.1.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.4 Use Unique Passwords</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-82">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-129 :</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb90-1"><a href="#cb90-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-129 : S&#39;assurer que l&#39;expiration des mots de passe soit de 365 jours ou moins&quot;</span></span>
<span id="cb90-2"><a href="#cb90-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^PASS_MAX_DAYS\s+365&#39;</span> /etc/login.defs<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb90-3"><a href="#cb90-3"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(PASS_MAX_DAYS.*\)/# \1/&#39;</span> <span class="at">-i</span> /etc/login.defs</span>
<span id="cb90-4"><a href="#cb90-4"></a>  <span class="bu">echo</span> <span class="st">&quot;PASS_MAX_DAYS 365&quot;</span> <span class="op">&gt;&gt;</span>/etc/login.defs</span>
<span id="cb90-5"><a href="#cb90-5"></a><span class="cf">fi</span></span>
<span id="cb90-6"><a href="#cb90-6"></a><span class="co"># Fin: HARDE-RHEL-129</span></span></code></pre></div>
<h3 id="méthode-daudit-88">Méthode d’audit</h3>
<h2 id="harde-rhel-130-sassurer-que-le-nombre-minimum-de-jours-entre-2-changements-de-mot-de-passe-soit-7-ou-plus">HARDE-RHEL-130 : S’assurer que le nombre minimum de jours entre 2 changements de mot de passe soit 7 ou plus</h2>
<p>S’assurer que la ligne suivante soit dans le fichier /etc/login.defs: PASS_MIN_DAYS 7</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.5.1.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.4 Use Unique Passwords</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-83">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-130 :</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb91-1"><a href="#cb91-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-130 : S&#39;assurer que le nombre minimum de jours entre 2 changements de mot de passe soit 7 ou plus&quot;</span></span>
<span id="cb91-2"><a href="#cb91-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^PASS_MIN_DAYS\s+365&#39;</span> /etc/login.defs<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb91-3"><a href="#cb91-3"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(PASS_MIN_DAYS.*\)/# \1/&#39;</span> <span class="at">-i</span> /etc/login.defs</span>
<span id="cb91-4"><a href="#cb91-4"></a>  <span class="bu">echo</span> <span class="st">&quot;PASS_MIN_DAYS 7&quot;</span> <span class="op">&gt;&gt;</span>/etc/login.defs</span>
<span id="cb91-5"><a href="#cb91-5"></a><span class="cf">fi</span></span>
<span id="cb91-6"><a href="#cb91-6"></a><span class="co"># Fin: HARDE-RHEL-130</span></span></code></pre></div>
<h3 id="méthode-daudit-89">Méthode d’audit</h3>
<h2 id="harde-rhel-131-sassurer-que-lalerte-pour-expiration-de-mot-de-passe-soit-émise-7-jours-ou-plus-avant-expiration-du-mot-de-passe">HARDE-RHEL-131 : S’assurer que l’alerte pour expiration de mot de passe soit émise 7 jours ou plus avant expiration du mot de passe</h2>
<p>S’assurer que la ligne suivante soit dans le fichier /etc/login.defs: PASS_WARN_AGE 14</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.5.1.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.4 Use Unique Passwords</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-84">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-131 :</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb92-1"><a href="#cb92-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-131 : S&#39;assurer que l&#39;alerte pour expiration de mot de passe soit émise 7 jours ou plus avant expiration du mot de passe&quot;</span></span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^PASS_WARN_AGE\s+14&#39;</span> /etc/login.defs<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb92-3"><a href="#cb92-3"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(PASS_WARN_AGE.*\)/# \1/&#39;</span> <span class="at">-i</span> /etc/login.defs</span>
<span id="cb92-4"><a href="#cb92-4"></a>  <span class="bu">echo</span> <span class="st">&quot;PASS_WARN_AGE 14&quot;</span> <span class="op">&gt;&gt;</span>/etc/login.defs</span>
<span id="cb92-5"><a href="#cb92-5"></a><span class="cf">fi</span></span>
<span id="cb92-6"><a href="#cb92-6"></a><span class="co"># Fin: HARDE-RHEL-131</span></span></code></pre></div>
<h3 id="méthode-daudit-90">Méthode d’audit</h3>
<h2 id="harde-rhel-132-sassurer-que-le-verrouillage-des-comptes-inutilisés-soit-de-30-jours-ou-moins">HARDE-RHEL-132 : S’assurer que le verrouillage des comptes inutilisés soit de 30 jours ou moins</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.5.1.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.4 Use Unique Passwords</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-85">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-132 :</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb93-1"><a href="#cb93-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb93-2"><a href="#cb93-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-132 : S&#39;assurer que le verrouillage des comptes inutilisés soit de 30 jours ou moins&quot;</span></span>
<span id="cb93-3"><a href="#cb93-3"></a><span class="ex">useradd</span> <span class="at">-D</span> <span class="at">-f</span> 30</span>
<span id="cb93-4"><a href="#cb93-4"></a><span class="co"># Fin: HARDE-RHEL-132</span></span></code></pre></div>
<h3 id="méthode-daudit-91">Méthode d’audit</h3>
<h2 id="harde-rhel-133-sassurer-que-toutes-les-dates-de-changement-de-mot-de-passe-sont-dans-le-passé">HARDE-RHEL-133 : S’assurer que toutes les dates de changement de mot de passe sont dans le passé</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.5.1.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.4 Use Unique Passwords</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-86">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-133 :</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb94-1"><a href="#cb94-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-133 : S&#39;assurer que toutes les dates de changement de mot de passe soient dans le passé&quot;</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="va">PATH</span><span class="op">=</span>/sbin:<span class="va">$PATH</span> <span class="fu">awk</span> <span class="at">-F:</span> <span class="st">&#39;($1!=&quot;root&quot; &amp;&amp; $1!=&quot;sync&quot; &amp;&amp; $1!=&quot;shutdown&quot; &amp;&amp; $1!=&quot;halt&quot; &amp;&amp; $1!~/^\+/ &amp;&amp; $3&lt;&#39;&quot;</span><span class="va">$(</span><span class="fu">awk</span> <span class="st">&#39;/^\s*UID_MIN/{print $2}&#39;</span> /etc/login.defs<span class="va">)</span><span class="st">&quot;&#39; &amp;&amp; $7!=&quot;&#39;&quot;</span><span class="va">$(</span><span class="fu">which</span> nologin<span class="va">)</span><span class="st">&quot;&#39;&quot; &amp;&amp; $7!=&quot;/bin/false&quot;) {print $1}&#39;</span> /etc/passwd <span class="kw">|</span> <span class="cf">while</span> <span class="bu">read</span> <span class="at">-r</span> <span class="va">user</span><span class="kw">;</span> <span class="cf">do</span> <span class="ex">usermod</span> <span class="at">-s</span> <span class="st">&quot;</span><span class="va">$(</span><span class="fu">which</span> nologin<span class="va">)</span><span class="st">&quot;</span> <span class="st">&quot;</span><span class="va">${user}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">done</span></span>
<span id="cb94-3"><a href="#cb94-3"></a><span class="fu">awk</span> <span class="at">-F:</span> <span class="st">&#39;($1!=&quot;root&quot; &amp;&amp; $1!~/^\+/ &amp;&amp; $3&lt;&#39;&quot;</span><span class="va">$(</span><span class="fu">awk</span> <span class="st">&#39;/^\s*UID_MIN/{print $2}&#39;</span> /etc/login.defs<span class="va">)</span><span class="st">&quot;&#39;) {print $1}&#39;</span> /etc/passwd <span class="kw">|</span> <span class="fu">xargs</span> <span class="at">-I</span> <span class="st">&#39;{}&#39;</span> passwd <span class="at">-S</span> <span class="st">&#39;{}&#39;</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;($2!=&quot;L&quot; &amp;&amp; $2!=&quot;LK&quot;) {print $1}&#39;</span> <span class="kw">|</span> <span class="cf">while</span> <span class="bu">read</span> <span class="at">-r</span> <span class="va">user</span><span class="kw">;</span> <span class="cf">do</span> <span class="ex">usermod</span> <span class="at">-L</span> <span class="st">&quot;</span><span class="va">${user}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">done</span></span>
<span id="cb94-4"><a href="#cb94-4"></a><span class="co"># Fin: HARDE-RHEL-133</span></span></code></pre></div>
<h3 id="méthode-daudit-92">Méthode d’audit</h3>
<h2 id="harde-rhel-134-sassurer-que-les-comptes-système-soient-sécurisés">HARDE-RHEL-134 : S’assurer que les comptes système soient sécurisés</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.5.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16 Account Monitoring and Control</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-87">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-134 :</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb95-1"><a href="#cb95-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb95-2"><a href="#cb95-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-134 : S&#39;assurer que les comptes système soient sécurisés&quot;</span></span>
<span id="cb95-3"><a href="#cb95-3"></a><span class="co"># Expire passwords now to enforce the new password policy</span></span>
<span id="cb95-4"><a href="#cb95-4"></a><span class="ex">chage</span> <span class="at">-d</span> 0 root</span>
<span id="cb95-5"><a href="#cb95-5"></a><span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">||</span> <span class="fu">getent</span> passwd <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span> <span class="op">&gt;</span>/dev/null <span class="kw">&amp;&amp;</span> <span class="ex">chage</span> <span class="at">-d</span> 0 <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span></span>
<span id="cb95-6"><a href="#cb95-6"></a><span class="co"># Fin: HARDE-RHEL-134</span></span></code></pre></div>
<h3 id="méthode-daudit-93">Méthode d’audit</h3>
<h2 id="harde-rhel-135-sassurer-que-la-temporisation-par-défaut-des-shell-utilisateurs-soit-de-900-secondes-ou-moins">HARDE-RHEL-135 : S’assurer que la temporisation par défaut des shell utilisateurs soit de 900 secondes ou moins</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.5.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.11 Lock Workstation Sessions After Inactivity</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R29</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-88">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-135 :</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb96-1"><a href="#cb96-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-135 : S&#39;assurer que la temporisation par défaut des shell utilisateurs soit de 900 secondes ou moins&quot;</span></span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/profile.d/tmout.sh <span class="op">&lt;&lt;EOF</span></span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="st">readonly TMOUT=900 ; export TMOUT</span></span>
<span id="cb96-4"><a href="#cb96-4"></a><span class="op">EOF</span></span>
<span id="cb96-5"><a href="#cb96-5"></a><span class="co"># Fin: HARDE-RHEL-135</span></span></code></pre></div>
<h3 id="méthode-daudit-94">Méthode d’audit</h3>
<h2 id="harde-rhel-136-sassurer-que-le-groupe-par-défaut-du-compte-root-est-0">HARDE-RHEL-136 : S’assurer que le groupe par défaut du compte root est 0</h2>
<p>Lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.5.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-89">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-136 :</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb97-1"><a href="#cb97-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-136 : S&#39;assurer que le groupe par défaut du compte root est 0&quot;</span></span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="ex">usermod</span> <span class="at">-g</span> 0 root</span>
<span id="cb97-3"><a href="#cb97-3"></a><span class="co"># Fin: HARDE-RHEL-136</span></span></code></pre></div>
<h3 id="méthode-daudit-95">Méthode d’audit</h3>
<h2 id="harde-rhel-137-sassurer-que-la-connexion-est-root-est-seulement-possible-sur-la-console-system">HARDE-RHEL-137 : S’assurer que la connexion est root est seulement possible sur la console system</h2>
<p>L’accès est restreint aux seules consoles physiquement connectées au serveur. Cette commande doit être adaptée s’il n’y a qu’une console série (par exemple ttyS1)</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-90">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-137 :</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb98-1"><a href="#cb98-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb98-2"><a href="#cb98-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-137 : S&#39;assurer que la connexion est root est seulement possible sur la console système&quot;</span></span>
<span id="cb98-3"><a href="#cb98-3"></a><span class="cf">for</span> i <span class="kw">in</span> 1 2 3 4 5 6<span class="kw">;</span> <span class="cf">do</span> <span class="bu">echo</span> <span class="st">&quot;tty</span><span class="va">$i</span><span class="st">&quot;</span> <span class="op">&gt;</span>/etc/securetty<span class="kw">;</span> <span class="cf">done</span></span>
<span id="cb98-4"><a href="#cb98-4"></a><span class="bu">echo</span> <span class="st">&quot;ttyS1&quot;</span> <span class="op">&gt;&gt;</span>/etc/securetty</span>
<span id="cb98-5"><a href="#cb98-5"></a><span class="co"># enable pam_securetty.so as well</span></span>
<span id="cb98-6"><a href="#cb98-6"></a><span class="va">AUTH_FILES</span><span class="op">=</span><span class="va">(</span></span>
<span id="cb98-7"><a href="#cb98-7"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">]</span><span class="va">=</span><span class="st">&quot;/etc/pam.d/system-auth&quot;</span></span>
<span id="cb98-8"><a href="#cb98-8"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">]</span><span class="va">=</span><span class="st">&quot;/etc/pam.d/password-auth&quot;</span></span>
<span id="cb98-9"><a href="#cb98-9"></a><span class="va">)</span></span>
<span id="cb98-10"><a href="#cb98-10"></a><span class="cf">for</span> pamFile <span class="kw">in</span> <span class="st">&quot;</span><span class="va">${AUTH_FILES</span><span class="op">[@]</span><span class="va">}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb98-11"><a href="#cb98-11"></a>    <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-e</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">.harde-backup&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span></span>
<span id="cb98-12"><a href="#cb98-12"></a>        <span class="fu">cp</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">.harde-backup&quot;</span></span>
<span id="cb98-13"><a href="#cb98-13"></a><span class="cf">done</span></span>
<span id="cb98-14"><a href="#cb98-14"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/pam.d/system-auth <span class="op">&lt;&lt;EOF</span></span>
<span id="cb98-15"><a href="#cb98-15"></a><span class="st">#%PAM-1.0</span></span>
<span id="cb98-16"><a href="#cb98-16"></a><span class="st"># This file is auto-generated.</span></span>
<span id="cb98-17"><a href="#cb98-17"></a><span class="st"># User changes will be destroyed the next time authselect is run.</span></span>
<span id="cb98-18"><a href="#cb98-18"></a><span class="st">auth        required      pam_env.so</span></span>
<span id="cb98-19"><a href="#cb98-19"></a><span class="st">auth        required      pam_securetty.so noconsole</span></span>
<span id="cb98-20"><a href="#cb98-20"></a><span class="st">auth        required      pam_faillock.so preauth silent deny=5 unlock_time=900</span></span>
<span id="cb98-21"><a href="#cb98-21"></a><span class="st">auth        sufficient    pam_unix.so try_first_pass</span></span>
<span id="cb98-22"><a href="#cb98-22"></a><span class="st"># auth        required      pam_faillock.so preauth silent deny=5 unlock_time=900</span></span>
<span id="cb98-23"><a href="#cb98-23"></a><span class="st">auth        required      pam_faillock.so authfail deny=5 unlock_time=900</span></span>
<span id="cb98-24"><a href="#cb98-24"></a><span class="st">auth        required      pam_deny.so</span></span>
<span id="cb98-25"><a href="#cb98-25"></a></span>
<span id="cb98-26"><a href="#cb98-26"></a><span class="st">account     required      pam_unix.so</span></span>
<span id="cb98-27"><a href="#cb98-27"></a></span>
<span id="cb98-28"><a href="#cb98-28"></a><span class="st">password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=</span></span>
<span id="cb98-29"><a href="#cb98-29"></a><span class="st">password    requisite     pam_pwhistory.so use_authtok remember=99</span></span>
<span id="cb98-30"><a href="#cb98-30"></a><span class="st">password    sufficient    pam_unix.so try_first_pass use_authtok shadow obscure sha512 rounds=65536</span></span>
<span id="cb98-31"><a href="#cb98-31"></a><span class="st">password    required      pam_deny.so</span></span>
<span id="cb98-32"><a href="#cb98-32"></a></span>
<span id="cb98-33"><a href="#cb98-33"></a><span class="st">session     optional      pam_keyinit.so revoke</span></span>
<span id="cb98-34"><a href="#cb98-34"></a><span class="st">session     required      pam_limits.so</span></span>
<span id="cb98-35"><a href="#cb98-35"></a><span class="st">-session     optional      pam_systemd.so</span></span>
<span id="cb98-36"><a href="#cb98-36"></a><span class="st">session     [success=1 default=ignore] pam_succeed_if.so service in crond quiet use_uid</span></span>
<span id="cb98-37"><a href="#cb98-37"></a><span class="st">session     required      pam_unix.so</span></span>
<span id="cb98-38"><a href="#cb98-38"></a><span class="op">EOF</span></span>
<span id="cb98-39"><a href="#cb98-39"></a><span class="fu">cp</span> /etc/pam.d/system-auth /etc/pam.d/password-auth</span>
<span id="cb98-40"><a href="#cb98-40"></a><span class="co"># Fin: HARDE-RHEL-137</span></span></code></pre></div>
<h3 id="méthode-daudit-96">Méthode d’audit</h3>
<h2 id="harde-rhel-138-sassurer-quaucun-mot-de-passe-nest-vide">HARDE-RHEL-138 : S’assurer qu’aucun mot de passe n’est vide</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.4 Use Unique Passwords</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-46">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-139-sassurer-que-quaucune-entrée-dans-etcpasswd-nutilise-le-code-historique">HARDE-RHEL-139 : S’assurer que qu’aucune entrée dans /etc/passwd n’utilise le code historique “+”</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.2 Configure Centralized Point of Authentication</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-47">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-140-sassurer-que-quaucune-entrée-dans-etcshadow-nutilise-le-code-historique">HARDE-RHEL-140 : S’assurer que qu’aucune entrée dans /etc/shadow n’utilise le code historique “+”</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.2 Configure Centralized Point of Authentication</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-48">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-141-sassurer-que-quaucune-entrée-dans-etcgroup-nutilise-le-code-historique">HARDE-RHEL-141 : S’assurer que qu’aucune entrée dans /etc/group n’utilise le code historique “+”</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.2 Configure Centralized Point of Authentication</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-49">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-142-sassurer-que-root-est-le-seul-compte-avec-uid-0">HARDE-RHEL-142 : S’assurer que root est le seul compte avec UID 0</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-50">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-143-désactivation-des-comptes-utilisateurs-inutilisés">HARDE-RHEL-143 : Désactivation des comptes utilisateurs inutilisés</h2>
<p>Maintenir une liste blanche et noire d’utilisateurs.</p>
<p>Pour vérrouiller un compte, lancer la commande suivante : usermod -L <compte> et pour désactiver son shell de commande : usermod -s /bin/false <compte></p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R26</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-51">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-144-désactivation-des-comptes-de-services">HARDE-RHEL-144 : Désactivation des comptes de services</h2>
<p>Désactiver les comptes de services</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R27</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-52">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-145-unicité-et-exclusivité-des-comptes-de-services">HARDE-RHEL-145 : Unicité et exclusivité des comptes de services</h2>
<p>Chaque service doit posséder son propre compte système qui doit lui être dédié exclusivement.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R28</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-53">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-146-délai-dexpiration-de-sessions-utilisateurs">HARDE-RHEL-146 : Délai d’expiration de sessions utilisateurs</h2>
<p>Les sessions utilisateurs doivent expirer. La directive pour les shells utilisateurs est HARDE-RHEL-135. Celle-ci couvre toutes les autres applications du système.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R29</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-54">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-147-applications-utilisant-pam">HARDE-RHEL-147 : Applications utilisant PAM</h2>
<p>Le nombre d’applications utilisant PAM doit être réduit au strict nécessaire afin de limiter l’exposition d’éléments d’authentification sensibles.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R30</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-55">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-148-sécurisation-des-services-réseau-dauthentification-pam">HARDE-RHEL-148 : Sécurisation des services réseau d’authentification PAM</h2>
<p>S’assurer que les flux d’authentification soit sécurisés.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R31</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-91">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-148 :</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb99-1"><a href="#cb99-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-148 : Sécurisation des services réseau d&#39;authentification PAM&quot;</span></span>
<span id="cb99-3"><a href="#cb99-3"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/pam.d/su <span class="op">&lt;&lt;EOF</span></span>
<span id="cb99-4"><a href="#cb99-4"></a><span class="st">#%PAM-1.0</span></span>
<span id="cb99-5"><a href="#cb99-5"></a><span class="st">auth            required        pam_env.so</span></span>
<span id="cb99-6"><a href="#cb99-6"></a><span class="st">auth            sufficient      pam_rootok.so</span></span>
<span id="cb99-7"><a href="#cb99-7"></a><span class="st"># Uncomment the following line to implicitly trust users in the &quot;&quot;wheel&quot;&quot; group.</span></span>
<span id="cb99-8"><a href="#cb99-8"></a><span class="st">#auth           sufficient      pam_wheel.so trust use_uid</span></span>
<span id="cb99-9"><a href="#cb99-9"></a><span class="st"># Uncomment the following line to require a user to be in the &quot;&quot;wheel&quot;&quot; group.</span></span>
<span id="cb99-10"><a href="#cb99-10"></a><span class="st">#auth           required        pam_wheel.so use_uid</span></span>
<span id="cb99-11"><a href="#cb99-11"></a><span class="st"># The following line requires a user to be in the &quot;&quot;sudogrp&quot;&quot; group.</span></span>
<span id="cb99-12"><a href="#cb99-12"></a><span class="st">auth            required        pam_wheel.so group=sudogrp</span></span>
<span id="cb99-13"><a href="#cb99-13"></a><span class="st">auth            substack        system-auth</span></span>
<span id="cb99-14"><a href="#cb99-14"></a><span class="st">auth            include         postlogin</span></span>
<span id="cb99-15"><a href="#cb99-15"></a><span class="st">account         sufficient      pam_succeed_if.so uid = 0 use_uid quiet</span></span>
<span id="cb99-16"><a href="#cb99-16"></a><span class="st">account         include         system-auth</span></span>
<span id="cb99-17"><a href="#cb99-17"></a><span class="st">password        include         system-auth</span></span>
<span id="cb99-18"><a href="#cb99-18"></a><span class="st">session         include         system-auth</span></span>
<span id="cb99-19"><a href="#cb99-19"></a><span class="st">session         include         postlogin</span></span>
<span id="cb99-20"><a href="#cb99-20"></a><span class="st">session         optional        pam_xauth.so</span></span>
<span id="cb99-21"><a href="#cb99-21"></a><span class="op">EOF</span></span>
<span id="cb99-22"><a href="#cb99-22"></a><span class="co"># Fin: HARDE-RHEL-148</span></span></code></pre></div>
<h3 id="méthode-daudit-97">Méthode d’audit</h3>
<h2 id="harde-rhel-149-sécurisation-des-accès-aux-bases-utilisateurs-distantes">HARDE-RHEL-149 : Sécurisation des accès aux bases utilisateurs distantes</h2>
<p>S’assurer que les flux d’authentification soit sécurisés.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R33</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-56">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-150-séparation-des-comptes-système-et-dadministrateur-de-lannuaire">HARDE-RHEL-150 : Séparation des comptes système et d’administrateur de l’annuaire</h2>
<p>Il est recommandé de ne pas avoir de recouvrement de compte entre ceux utilisés par le système d’exploitation et ceux utilisés pour administrer l’annuaire.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R34</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-57">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-151-groupe-dédié-à-lusage-de-sudo">HARDE-RHEL-151 : Groupe dédié à l’usage de sudo</h2>
<p>Créer un groupe sudoers pour les administrateurs et s’assurer que seul ce groupe peut éxécuter sudo. Ces commandes limitent aussi ce que peuvent faire les administrateurs (édition de fichiers seulement et tuer des processus):</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R57</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-92">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-151 :</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb100-1"><a href="#cb100-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-151 : Groupe dédié à l&#39;usage de sudo&quot;</span></span>
<span id="cb100-3"><a href="#cb100-3"></a><span class="co">#cat &gt;/etc/sudoers.d/15group &lt;&lt;EOF</span></span>
<span id="cb100-4"><a href="#cb100-4"></a><span class="co">#%sudogrp ALL=(ALL) ALL</span></span>
<span id="cb100-5"><a href="#cb100-5"></a><span class="co">#EOF</span></span>
<span id="cb100-6"><a href="#cb100-6"></a><span class="ex">groupadd</span> <span class="at">-r</span> <span class="at">-f</span> sudogrp</span>
<span id="cb100-7"><a href="#cb100-7"></a><span class="fu">chgrp</span> sudogrp /usr/bin/sudo</span>
<span id="cb100-8"><a href="#cb100-8"></a><span class="fu">chmod</span> u+s /usr/bin/sudo</span>
<span id="cb100-9"><a href="#cb100-9"></a><span class="fu">chmod</span> o-rwx /usr/bin/sudo</span>
<span id="cb100-10"><a href="#cb100-10"></a><span class="co"># Fin: HARDE-RHEL-151</span></span></code></pre></div>
<h3 id="méthode-daudit-98">Méthode d’audit</h3>
<h2 id="harde-rhel-152-authentification-des-utilisateurs-exécutant-sudo">HARDE-RHEL-152 : Authentification des utilisateurs exécutant sudo</h2>
<p>Ne pas utiliser la directive NOPASSWD</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R59</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-93">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-152 :</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb101-1"><a href="#cb101-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-152 : Authentification des utilisateurs exécutant sudo&quot;</span></span>
<span id="cb101-3"><a href="#cb101-3"></a><span class="cf">if</span> <span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&quot;^[^#].*NOPASSWD&quot;</span> /etc/sudoers<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb101-4"><a href="#cb101-4"></a>  <span class="bu">echo</span> <span class="st">&quot;Directive NOPASSWD à supprimer du fichier /etc/sudoers&quot;</span></span>
<span id="cb101-5"><a href="#cb101-5"></a><span class="cf">fi</span></span>
<span id="cb101-6"><a href="#cb101-6"></a><span class="co"># Fin: HARDE-RHEL-152</span></span></code></pre></div>
<h3 id="méthode-daudit-99">Méthode d’audit</h3>
<h2 id="harde-rhel-153-privilèges-des-utilisateurs-cibles-pour-une-commande-sudo">HARDE-RHEL-153 : Privilèges des utilisateurs cibles pour une commande sudo</h2>
<p>Limiter les utilisations autant que possible aux utilisateurs non-root</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R60</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-58">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-154-limitation-du-nombre-de-commandes-nécessitant-loption-exec">HARDE-RHEL-154 : Limitation du nombre de commandes nécessitant l’option EXEC</h2>
<p>Limiter l’utilisation des commandes permettant des sous-commandes</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R61</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-59">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-155-du-bon-usage-de-la-négation-dans-une-spécification-sudo">HARDE-RHEL-155 : Du bon usage de la négation dans une spécification sudo</h2>
<p>Pas de négation dans les directives sudo</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R62</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-60">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-156-arguments-explicites-dans-les-spécifications-sudo">HARDE-RHEL-156 : Arguments explicites dans les spécifications sudo</h2>
<p>Spécifier explicitement les paramètres si nécessaire en utilisant “” et en limitant l’utilisation de *</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R63</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-61">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-157-du-bon-usage-de-sudoedit">HARDE-RHEL-157 : Du bon usage de sudoedit</h2>
<p>Utilise sudoedit pour modifier les fichiers de configuration du système. Cela permet en effet d’utiliser un éditeur complet sans privilège administrateur.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R64</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-62">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-158-sticky-bit-et-droits-daccès-en-écriture">HARDE-RHEL-158 : Sticky bit et droits d’accès en écriture</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.21</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R40</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-63">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-159-installer-aide">HARDE-RHEL-159 : Installer AIDE</h2>
<p>Installer AIDE</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.4.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.9 Enforce Detail Logging for Access or Changes to Sensitive Data</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-94">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-159 :</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb102-1"><a href="#cb102-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-159 : Installer AIDE&quot;</span></span>
<span id="cb102-2"><a href="#cb102-2"></a><span class="ex">dnf</span> install aide</span>
<span id="cb102-3"><a href="#cb102-3"></a><span class="co"># Fin: HARDE-RHEL-159</span></span></code></pre></div>
<h3 id="méthode-daudit-100">Méthode d’audit</h3>
<h2 id="harde-rhel-160-vérification-régulière-de-lintégrité-de-système-de-fichiers">HARDE-RHEL-160 : Vérification régulière de l’intégrité de système de fichiers</h2>
<p>Configurer AIDE</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.4.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.9 Enforce Detail Logging for Access or Changes to Sensitive Data</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R51</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-95">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-160 :</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb103-1"><a href="#cb103-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-160 : Vérification régulière de l&#39;intégrité de système de fichiers&quot;</span></span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/system/aidecheck.timer <span class="op">&lt;&lt;EOF</span></span>
<span id="cb103-3"><a href="#cb103-3"></a><span class="st">[Unit]</span></span>
<span id="cb103-4"><a href="#cb103-4"></a><span class="st">Description=Aide check every day at midnight</span></span>
<span id="cb103-5"><a href="#cb103-5"></a></span>
<span id="cb103-6"><a href="#cb103-6"></a><span class="st">[Timer]</span></span>
<span id="cb103-7"><a href="#cb103-7"></a><span class="st">OnCalendar=*-*-* 00:00:00</span></span>
<span id="cb103-8"><a href="#cb103-8"></a><span class="st">Unit=aidecheck.service</span></span>
<span id="cb103-9"><a href="#cb103-9"></a></span>
<span id="cb103-10"><a href="#cb103-10"></a><span class="st">[Install]</span></span>
<span id="cb103-11"><a href="#cb103-11"></a><span class="st">WantedBy=multi-user.target</span></span>
<span id="cb103-12"><a href="#cb103-12"></a><span class="op">EOF</span></span>
<span id="cb103-13"><a href="#cb103-13"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/system/aidecheck.service <span class="op">&lt;&lt;EOF</span></span>
<span id="cb103-14"><a href="#cb103-14"></a><span class="st">[Unit]</span></span>
<span id="cb103-15"><a href="#cb103-15"></a><span class="st">Description=Aide Check</span></span>
<span id="cb103-16"><a href="#cb103-16"></a></span>
<span id="cb103-17"><a href="#cb103-17"></a><span class="st">[Service]</span></span>
<span id="cb103-18"><a href="#cb103-18"></a><span class="st">Type=simple</span></span>
<span id="cb103-19"><a href="#cb103-19"></a><span class="st">ExecStart=/sbin/aide --check</span></span>
<span id="cb103-20"><a href="#cb103-20"></a></span>
<span id="cb103-21"><a href="#cb103-21"></a><span class="st">[Install]</span></span>
<span id="cb103-22"><a href="#cb103-22"></a><span class="st">WantedBy=multi-user.target</span></span>
<span id="cb103-23"><a href="#cb103-23"></a><span class="op">EOF</span></span>
<span id="cb103-24"><a href="#cb103-24"></a><span class="fu">chmod</span> 0644 /etc/systemd/system/aidecheck.<span class="pp">*</span></span>
<span id="cb103-25"><a href="#cb103-25"></a><span class="ex">systemctl</span> reenable aidecheck.timer</span>
<span id="cb103-26"><a href="#cb103-26"></a><span class="ex">systemctl</span> restart aidecheck.timer</span>
<span id="cb103-27"><a href="#cb103-27"></a><span class="ex">systemctl</span> daemon-reload</span>
<span id="cb103-28"><a href="#cb103-28"></a><span class="co"># do this at the end, to minimize the number of changes</span></span>
<span id="cb103-29"><a href="#cb103-29"></a><span class="co"># aide --init</span></span>
<span id="cb103-30"><a href="#cb103-30"></a><span class="co"># mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz</span></span>
<span id="cb103-31"><a href="#cb103-31"></a><span class="co"># Fin: HARDE-RHEL-160</span></span></code></pre></div>
<h3 id="méthode-daudit-101">Méthode d’audit</h3>
<h2 id="harde-rhel-161-sassurer-que-les-permissions-sur-etccrontab-soient-correctes">HARDE-RHEL-161 : S’assurer que les permissions sur /etc/crontab soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.1.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-96">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-161 :</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb104-1"><a href="#cb104-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-161 : S&#39;assurer que les permissions sur /etc/crontab soient correctes&quot;</span></span>
<span id="cb104-2"><a href="#cb104-2"></a><span class="fu">chown</span> root:root /etc/crontab</span>
<span id="cb104-3"><a href="#cb104-3"></a><span class="fu">chmod</span> og-rwx /etc/crontab</span>
<span id="cb104-4"><a href="#cb104-4"></a><span class="co"># Fin: HARDE-RHEL-161</span></span></code></pre></div>
<h3 id="méthode-daudit-102">Méthode d’audit</h3>
<h2 id="harde-rhel-162-sassurer-que-les-permissions-sur-etccron.hourly-soient-correctes">HARDE-RHEL-162 : S’assurer que les permissions sur /etc/cron.hourly soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.1.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-97">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-162 :</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb105-1"><a href="#cb105-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-162 : S&#39;assurer que les permissions sur /etc/cron.hourly soient correctes&quot;</span></span>
<span id="cb105-2"><a href="#cb105-2"></a><span class="fu">chown</span> root:root /etc/cron.hourly</span>
<span id="cb105-3"><a href="#cb105-3"></a><span class="fu">chmod</span> og-rwx /etc/cron.hourly</span>
<span id="cb105-4"><a href="#cb105-4"></a><span class="co"># Fin: HARDE-RHEL-162</span></span></code></pre></div>
<h3 id="méthode-daudit-103">Méthode d’audit</h3>
<h2 id="harde-rhel-163-sassurer-que-les-permissions-sur-etccron.daily-soient-correctes">HARDE-RHEL-163 : S’assurer que les permissions sur /etc/cron.daily soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.1.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-98">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-163 :</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb106-1"><a href="#cb106-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-163 : S&#39;assurer que les permissions sur /etc/cron.daily soient correctes&quot;</span></span>
<span id="cb106-2"><a href="#cb106-2"></a><span class="fu">chown</span> root:root /etc/cron.daily</span>
<span id="cb106-3"><a href="#cb106-3"></a><span class="fu">chmod</span> og-rwx /etc/cron.daily</span>
<span id="cb106-4"><a href="#cb106-4"></a><span class="co"># Fin: HARDE-RHEL-163</span></span></code></pre></div>
<h3 id="méthode-daudit-104">Méthode d’audit</h3>
<h2 id="harde-rhel-164-sassurer-que-les-permissions-sur-etccron.weekly-soient-correctes">HARDE-RHEL-164 : S’assurer que les permissions sur /etc/cron.weekly soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.1.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-99">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-164 :</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb107-1"><a href="#cb107-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-164 : S&#39;assurer que les permissions sur /etc/cron.weekly soient correctes&quot;</span></span>
<span id="cb107-2"><a href="#cb107-2"></a><span class="fu">chown</span> root:root /etc/cron.weekly</span>
<span id="cb107-3"><a href="#cb107-3"></a><span class="fu">chmod</span> og-rwx /etc/cron.weekly</span>
<span id="cb107-4"><a href="#cb107-4"></a><span class="co"># Fin: HARDE-RHEL-164</span></span></code></pre></div>
<h3 id="méthode-daudit-105">Méthode d’audit</h3>
<h2 id="harde-rhel-165-sassurer-que-les-permissions-sur-etccron.monthly-soient-correctes">HARDE-RHEL-165 : S’assurer que les permissions sur /etc/cron.monthly soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.1.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-100">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-165 :</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb108-1"><a href="#cb108-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-165 : S&#39;assurer que les permissions sur /etc/cron.monthly soient correctes&quot;</span></span>
<span id="cb108-2"><a href="#cb108-2"></a><span class="fu">chown</span> root:root /etc/cron.monthly</span>
<span id="cb108-3"><a href="#cb108-3"></a><span class="fu">chmod</span> og-rwx /etc/cron.monthly</span>
<span id="cb108-4"><a href="#cb108-4"></a><span class="co"># Fin: HARDE-RHEL-165</span></span></code></pre></div>
<h3 id="méthode-daudit-106">Méthode d’audit</h3>
<h2 id="harde-rhel-166-sassurer-que-les-permissions-sur-etccron.d-soient-correctes">HARDE-RHEL-166 : S’assurer que les permissions sur /etc/cron.d soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.1.7</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-101">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-166 :</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb109-1"><a href="#cb109-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-166 : S&#39;assurer que les permissions sur /etc/cron.d soient correctes&quot;</span></span>
<span id="cb109-2"><a href="#cb109-2"></a><span class="fu">chown</span> root:root /etc/cron.d</span>
<span id="cb109-3"><a href="#cb109-3"></a><span class="fu">chmod</span> og-rwx /etc/cron.d</span>
<span id="cb109-4"><a href="#cb109-4"></a><span class="co"># Fin: HARDE-RHEL-166</span></span></code></pre></div>
<h3 id="méthode-daudit-107">Méthode d’audit</h3>
<h2 id="harde-rhel-167-sassurer-que-les-permissions-sur-etcsshsshd_config-soient-correctes">HARDE-RHEL-167 : S’assurer que les permissions sur /etc/ssh/sshd_config soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-102">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-167 :</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb110-1"><a href="#cb110-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-167 : S&#39;assurer que les permissions sur /etc/ssh/sshd_config soient correctes&quot;</span></span>
<span id="cb110-2"><a href="#cb110-2"></a><span class="fu">chown</span> root:root /etc/ssh/sshd_config</span>
<span id="cb110-3"><a href="#cb110-3"></a><span class="fu">chmod</span> og-rwx /etc/ssh/sshd_config</span>
<span id="cb110-4"><a href="#cb110-4"></a><span class="co"># Fin: HARDE-RHEL-167</span></span></code></pre></div>
<h3 id="méthode-daudit-108">Méthode d’audit</h3>
<h2 id="harde-rhel-168-sassurer-que-les-permissions-sur-les-clés-privées-dhôte-ssh-soient-correctes">HARDE-RHEL-168 : S’assurer que les permissions sur les clés privées d’hôte SSH soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-103">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-168 :</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb111-1"><a href="#cb111-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-168 : S&#39;assurer que les permissions sur les clés privées d&#39;hôte SSH soient correctes&quot;</span></span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="fu">find</span> /etc/ssh <span class="at">-xdev</span> <span class="at">-type</span> f <span class="at">-name</span> <span class="st">&#39;ssh_host_*_key&#39;</span> <span class="at">-exec</span> chown root:root <span class="st">&quot;{}&quot;</span> <span class="st">&quot;;&quot;</span></span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="fu">find</span> /etc/ssh <span class="at">-xdev</span> <span class="at">-type</span> f <span class="at">-name</span> <span class="st">&#39;ssh_host_*_key&#39;</span> <span class="at">-exec</span> chmod 0600 <span class="st">&quot;{}&quot;</span> <span class="st">&quot;;&quot;</span></span>
<span id="cb111-4"><a href="#cb111-4"></a><span class="co"># Fin: HARDE-RHEL-168</span></span></code></pre></div>
<h3 id="méthode-daudit-109">Méthode d’audit</h3>
<h2 id="harde-rhel-169-sassurer-que-les-permissions-sur-les-clés-publiques-dhôte-soient-correctes">HARDE-RHEL-169 : S’assurer que les permissions sur les clés publiques d’hôte soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-104">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-169 :</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb112-1"><a href="#cb112-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-169 : S&#39;assurer que les permissions sur les clés publiques d&#39;hôte soient correctes&quot;</span></span>
<span id="cb112-2"><a href="#cb112-2"></a><span class="fu">find</span> /etc/ssh <span class="at">-xdev</span> <span class="at">-type</span> f <span class="at">-name</span> <span class="st">&#39;ssh_host_*_key.pub&#39;</span> <span class="at">-exec</span> chmod 0644 <span class="st">&quot;{}&quot;</span> <span class="st">&quot;;&quot;</span></span>
<span id="cb112-3"><a href="#cb112-3"></a><span class="fu">find</span> /etc/ssh <span class="at">-xdev</span> <span class="at">-type</span> f <span class="at">-name</span> <span class="st">&#39;ssh_host_*_key.pub&#39;</span> <span class="at">-exec</span> chown root:root <span class="st">&quot;{}&quot;</span> <span class="st">&quot;;&quot;</span></span>
<span id="cb112-4"><a href="#cb112-4"></a><span class="co"># Fin: HARDE-RHEL-169</span></span></code></pre></div>
<h3 id="méthode-daudit-110">Méthode d’audit</h3>
<h2 id="harde-rhel-170-sassurer-que-lumask-utilisateur-est-ou-plus-restrictif">HARDE-RHEL-170 : S’assurer que l’umask utilisateur est ou plus restrictif</h2>
<p>Le umask système doit être positionné à 0027 (par défaut, tout fichier créé n’est lisible que par l’utilisateur et son groupe, et modifiable uniquement par son propriétaire). Le umask pour les utilisateurs doit être positionné à 0077 (tout fichier créé par un utilisateur n’est lisible et modifiable que par lui)</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.5.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations<br>13 Data Protection</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R35</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-105">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-170 :</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb113-1"><a href="#cb113-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-170 : S&#39;assurer que l&#39;umask utilisateur est ou plus restrictif&quot;</span></span>
<span id="cb113-2"><a href="#cb113-2"></a><span class="co"># Shells non-interactifs</span></span>
<span id="cb113-3"><a href="#cb113-3"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="at">-e</span> <span class="st">&#39;s/umask 0../umask 027/&#39;</span> /etc/bashrc</span>
<span id="cb113-4"><a href="#cb113-4"></a><span class="co"># Shells interactifs</span></span>
<span id="cb113-5"><a href="#cb113-5"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/profile.d/umask.sh <span class="op">&lt;&lt;EOF</span></span>
<span id="cb113-6"><a href="#cb113-6"></a><span class="st">umask 027</span></span>
<span id="cb113-7"><a href="#cb113-7"></a><span class="op">EOF</span></span>
<span id="cb113-8"><a href="#cb113-8"></a><span class="co"># Fin: HARDE-RHEL-170</span></span></code></pre></div>
<h3 id="méthode-daudit-111">Méthode d’audit</h3>
<h2 id="harde-rhel-171-auditer-les-permissions-du-système-de-fichiers">HARDE-RHEL-171 : Auditer les permissions du système de fichiers</h2>
<p>Il s’agit d’utiliser les fonctionnalités du système de paquets de Red Hat pour vérifier qu’il n’y a pas eu de modifications de permissions sur les fichiers installés</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.6 Protect Information through Access Control Lists</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-64">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-172-sassurer-quaucun-fichier-en-écriture-pour-tout-le-monde-nexiste">HARDE-RHEL-172 : S’assurer qu’aucun fichier en écriture pour tout le monde n’existe</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.10</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations<br>13 Data Protection</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-65">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-173-sassurer-que-tous-les-fichiers-ont-un-propriétaire">HARDE-RHEL-173 : S’assurer que tous les fichiers ont un propriétaire</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.11</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">13.2 Remove Sensitive Data or Systems Not Regularly Accessed by Organization</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-66">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-174-sassurer-que-tous-les-fichiers-ont-un-groupe">HARDE-RHEL-174 : S’assurer que tous les fichiers ont un groupe</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.12</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">13.2 Remove Sensitive Data or Systems Not Regularly Accessed by Organization</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-67">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-175-auditer-les-exécutables-suid">HARDE-RHEL-175 : Auditer les exécutables SUID</h2>
<p>Les exécutables setuid doivent être le moins nombreux possible. Lorsqu’il est attendu que seuls les administrateurs de la machine les exécutent, il faut leur retirer le bit set-uid et leur préférer des commandes comme su ou sudo, qui peuvent être surveillées.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.13</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R37</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-106">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-175 :</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb114-1"><a href="#cb114-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-175 : Auditer les exécutables SUID&quot;</span></span>
<span id="cb114-2"><a href="#cb114-2"></a><span class="fu">df</span> <span class="at">--local</span> <span class="at">-P</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{if (NR!=1) print $6}&#39;</span> <span class="kw">|</span> <span class="fu">xargs</span> <span class="at">-I</span> <span class="st">&#39;{}&#39;</span> find <span class="st">&#39;{}&#39;</span> <span class="at">-xdev</span> <span class="at">-type</span> f <span class="at">-perm</span> <span class="at">-4000</span> <span class="at">-ls</span> <span class="op">&gt;</span><span class="st">&quot;</span><span class="va">$HOME</span><span class="st">/</span><span class="va">$0</span><span class="st">-suid-</span><span class="va">$(</span><span class="fu">date</span> +<span class="st">&#39;%Y-%m-%d&#39;</span><span class="va">)</span><span class="st">.txt&quot;</span></span>
<span id="cb114-3"><a href="#cb114-3"></a><span class="co"># Fin: HARDE-RHEL-175</span></span></code></pre></div>
<h3 id="méthode-daudit-112">Méthode d’audit</h3>
<h2 id="harde-rhel-176-auditer-les-exécutables-sgid">HARDE-RHEL-176 : Auditer les exécutables SGID</h2>
<p>Seuls les programmes spécifiquement conçus pour être utilisés avec les bits setuid (ou setgid) peuvent avoir ces bits de privilèges positionnés.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.14</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R38</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-107">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-176 :</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb115-1"><a href="#cb115-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-176 : Auditer les exécutables SGID&quot;</span></span>
<span id="cb115-2"><a href="#cb115-2"></a><span class="fu">df</span> <span class="at">--local</span> <span class="at">-P</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{if (NR!=1) print $6}&#39;</span> <span class="kw">|</span> <span class="fu">xargs</span> <span class="at">-I</span> <span class="st">&#39;{}&#39;</span> find <span class="st">&#39;{}&#39;</span> <span class="at">-xdev</span> <span class="at">-type</span> f <span class="at">-perm</span> <span class="at">-2000</span> <span class="at">-ls</span> <span class="op">&gt;</span><span class="st">&quot;</span><span class="va">$HOME</span><span class="st">/</span><span class="va">$0</span><span class="st">-sgid-</span><span class="va">$(</span><span class="fu">date</span> +<span class="st">&#39;%Y-%m-%d&#39;</span><span class="va">)</span><span class="st">.txt&quot;</span></span>
<span id="cb115-3"><a href="#cb115-3"></a><span class="co"># Fin: HARDE-RHEL-176</span></span></code></pre></div>
<h3 id="méthode-daudit-113">Méthode d’audit</h3>
<h2 id="harde-rhel-177-sassurer-que-les-permissions-sur-etcpasswd-soient-correctes">HARDE-RHEL-177 : S’assurer que les permissions sur /etc/passwd soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-108">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-177 :</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb116-1"><a href="#cb116-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-177 : S&#39;assurer que les permissions sur /etc/passwd soient correctes&quot;</span></span>
<span id="cb116-2"><a href="#cb116-2"></a><span class="fu">chown</span> root:root /etc/passwd</span>
<span id="cb116-3"><a href="#cb116-3"></a><span class="fu">chmod</span> 644 /etc/passwd</span>
<span id="cb116-4"><a href="#cb116-4"></a><span class="co"># Fin: HARDE-RHEL-177</span></span></code></pre></div>
<h3 id="méthode-daudit-114">Méthode d’audit</h3>
<h2 id="harde-rhel-178-sassurer-que-les-permissions-sur-etcshadow-soient-correctes">HARDE-RHEL-178 : S’assurer que les permissions sur /etc/shadow soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-109">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-178 :</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb117-1"><a href="#cb117-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-178 : S&#39;assurer que les permissions sur /etc/shadow soient correctes&quot;</span></span>
<span id="cb117-2"><a href="#cb117-2"></a><span class="fu">chown</span> root:root /etc/shadow</span>
<span id="cb117-3"><a href="#cb117-3"></a><span class="fu">chmod</span> o-rwx,g-wx /etc/shadow</span>
<span id="cb117-4"><a href="#cb117-4"></a><span class="co"># Fin: HARDE-RHEL-178</span></span></code></pre></div>
<h3 id="méthode-daudit-115">Méthode d’audit</h3>
<h2 id="harde-rhel-179-sassurer-que-les-permissions-sur-etcgroup-soient-correctes">HARDE-RHEL-179 : S’assurer que les permissions sur /etc/group soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-110">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-179 :</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb118-1"><a href="#cb118-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-179 : S&#39;assurer que les permissions sur /etc/group soient correctes&quot;</span></span>
<span id="cb118-2"><a href="#cb118-2"></a><span class="fu">chown</span> root:root /etc/group</span>
<span id="cb118-3"><a href="#cb118-3"></a><span class="fu">chmod</span> 644 /etc/group</span>
<span id="cb118-4"><a href="#cb118-4"></a><span class="co"># Fin: HARDE-RHEL-179</span></span></code></pre></div>
<h3 id="méthode-daudit-116">Méthode d’audit</h3>
<h2 id="harde-rhel-180-sassurer-que-les-permissions-sur-etcgshadow-soient-correctes">HARDE-RHEL-180 : S’assurer que les permissions sur /etc/gshadow soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-111">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-180 :</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb119-1"><a href="#cb119-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-180 : S&#39;assurer que les permissions sur /etc/gshadow soient correctes&quot;</span></span>
<span id="cb119-2"><a href="#cb119-2"></a><span class="fu">chown</span> root:root /etc/gshadow</span>
<span id="cb119-3"><a href="#cb119-3"></a><span class="fu">chmod</span> o-rwx,g-rw /etc/gshadow</span>
<span id="cb119-4"><a href="#cb119-4"></a><span class="co"># Fin: HARDE-RHEL-180</span></span></code></pre></div>
<h3 id="méthode-daudit-117">Méthode d’audit</h3>
<h2 id="harde-rhel-181-sassurer-que-les-permissions-sur-etcpasswd--soient-correctes">HARDE-RHEL-181 : S’assurer que les permissions sur /etc/passwd- soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-112">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-181 :</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb120-1"><a href="#cb120-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-181 : S&#39;assurer que les permissions sur /etc/passwd- soient correctes&quot;</span></span>
<span id="cb120-2"><a href="#cb120-2"></a><span class="fu">chown</span> root:root /etc/passwd-</span>
<span id="cb120-3"><a href="#cb120-3"></a><span class="fu">chmod</span> u-x,go-rwx /etc/passwd-</span>
<span id="cb120-4"><a href="#cb120-4"></a><span class="co"># Fin: HARDE-RHEL-181</span></span></code></pre></div>
<h3 id="méthode-daudit-118">Méthode d’audit</h3>
<h2 id="harde-rhel-182-sassurer-que-les-permissions-sur-etcshadow--soient-correctes">HARDE-RHEL-182 : S’assurer que les permissions sur /etc/shadow- soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.7</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-113">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-182 :</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb121-1"><a href="#cb121-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-182 : S&#39;assurer que les permissions sur /etc/shadow- soient correctes&quot;</span></span>
<span id="cb121-2"><a href="#cb121-2"></a><span class="fu">chown</span> root:root /etc/shadow-</span>
<span id="cb121-3"><a href="#cb121-3"></a><span class="fu">chmod</span> u-x,go-rwx /etc/shadow-</span>
<span id="cb121-4"><a href="#cb121-4"></a><span class="co"># Fin: HARDE-RHEL-182</span></span></code></pre></div>
<h3 id="méthode-daudit-119">Méthode d’audit</h3>
<h2 id="harde-rhel-183-sassurer-que-les-permissions-sur-etcgroup--soient-correctes">HARDE-RHEL-183 : S’assurer que les permissions sur /etc/group- soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.8</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-114">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-183 :</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb122-1"><a href="#cb122-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-183 : S&#39;assurer que les permissions sur /etc/group- soient correctes&quot;</span></span>
<span id="cb122-2"><a href="#cb122-2"></a><span class="fu">chown</span> root:root /etc/group-</span>
<span id="cb122-3"><a href="#cb122-3"></a><span class="fu">chmod</span> u-x,go-wx /etc/group-</span>
<span id="cb122-4"><a href="#cb122-4"></a><span class="co"># Fin: HARDE-RHEL-183</span></span></code></pre></div>
<h3 id="méthode-daudit-120">Méthode d’audit</h3>
<h2 id="harde-rhel-184-sassurer-que-les-permissions-sur-etcgshadow--soient-correctes">HARDE-RHEL-184 : S’assurer que les permissions sur /etc/gshadow- soient correctes</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.1.9</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-115">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-184 :</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb123-1"><a href="#cb123-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-184 : S&#39;assurer que les permissions sur /etc/gshadow- soient correctes&quot;</span></span>
<span id="cb123-2"><a href="#cb123-2"></a><span class="fu">chown</span> root:root /etc/gshadow-</span>
<span id="cb123-3"><a href="#cb123-3"></a><span class="fu">chmod</span> o-rwx,g-rw /etc/gshadow-</span>
<span id="cb123-4"><a href="#cb123-4"></a><span class="co"># Fin: HARDE-RHEL-184</span></span></code></pre></div>
<h3 id="méthode-daudit-121">Méthode d’audit</h3>
<h2 id="harde-rhel-185-sassurer-que-les-utilisateurs-nont-pas-de-fichier-.forward">HARDE-RHEL-185 : S’assurer que les utilisateurs n’ont pas de fichier .forward</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.10</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-68">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-186-sassurer-que-les-utilisateurs-nont-pas-de-fichier-.netrc">HARDE-RHEL-186 : S’assurer que les utilisateurs n’ont pas de fichier .netrc</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.11</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-69">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-187-sassurer-que-les-fichiers-.netrc-ne-soint-pas-accessibles-en-écriture">HARDE-RHEL-187 : S’assurer que les fichiers .netrc ne soint pas accessibles en écriture</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.12</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.6 Protect Information through Access Control Lists</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-70">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-188-sassurer-quil-nexiste-pas-de-fichier-.rhosts">HARDE-RHEL-188 : S’assurer qu’il n’existe pas de fichier .rhosts</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.13</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16.4 Encrypt or Hash all Authentication Credentials</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-71">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-189-sassurer-que-tous-les-groupes-de-etcpasswd-existent-dans-etcgroup">HARDE-RHEL-189 : S’assurer que tous les groupes de /etc/passwd existent dans /etc/group</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.14</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16 Account Monitoring and Control</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-72">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-190-sassurer-quil-ny-a-pas-duids-dupliqués">HARDE-RHEL-190 : S’assurer qu’il n’y a pas d’UIDs dupliqués</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.15</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16 Account Monitoring and Control</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-73">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-191-sassurer-quil-ny-a-pas-de-gids-dupliqués">HARDE-RHEL-191 : S’assurer qu’il n’y a pas de GIDs dupliqués</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.16</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16 Account Monitoring and Control</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-74">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-192-sassurer-quil-ny-a-pas-de-de-doublons-dans-les-noms-dutilisateur">HARDE-RHEL-192 : S’assurer qu’il n’y a pas de de doublons dans les noms d’utilisateur</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.17</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16 Account Monitoring and Control</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-75">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-193-sassurer-que-quil-ny-a-pas-de-de-doublons-dans-les-noms-de-groupe">HARDE-RHEL-193 : S’assurer que qu’il n’y a pas de de doublons dans les noms de groupe</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.18</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">16 Account Monitoring and Control</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-76">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-194-sassurer-quil-ny-a-pas-de-groupe-shadow">HARDE-RHEL-194 : S’assurer qu’il n’y a pas de groupe shadow</h2>
<p>Red Hat 8 est conforme par défaut : pas de groupe shadow</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.19</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-77">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-195-vérifier-que-tous-les-utilisateurs-aient-un-répertoire-daccueil">HARDE-RHEL-195 : Vérifier que tous les utilisateurs aient un répertoire d’accueil</h2>
<p>Conforme par défaut</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.20</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-78">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-196-sassurer-que-les-permissions-sur-les-répertoire-daccueil-des-utilisateurs-soit-750-ou-plus-restrictif">HARDE-RHEL-196 : S’assurer que les permissions sur les répertoire d’accueil des utilisateurs soit 750 ou plus restrictif</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.7</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.6 Protect Information through Access Control Lists</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-79">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-197-sassurer-que-les-utilisateurs-possèdent-leurs-répertoires-daccueil">HARDE-RHEL-197 : S’assurer que les utilisateurs possèdent leurs répertoires d’accueil</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.8</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.6 Protect Information through Access Control Lists</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-80">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-198-sassurer-que-les-fichiers-de-configuration-des-utilisateurs-ne-soient-pas-ouverts-en-écriture-au-groupe-ou-à-tout-le-monde">HARDE-RHEL-198 : S’assurer que les fichiers de configuration des utilisateurs ne soient pas ouverts en écriture au groupe ou à tout le monde</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 6.2.9</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.6 Protect Information through Access Control Lists</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-81">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-199-droits-daccès-aux-fichiers-de-contenu-sensible">HARDE-RHEL-199 : Droits d’accès aux fichiers de contenu sensible</h2>
<p>Les fichiers à contenu sensible ne doivent être lisibles que par les utilisateurs ayant le strict besoin d’en connaître.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R36</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-82">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-200-sécurisation-des-accès-pour-les-sockets-et-pipes">HARDE-RHEL-200 : Sécurisation des accès pour les sockets et pipes</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R41</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-83">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-201-protection-de-la-base-de-données-des-scellés">HARDE-RHEL-201 : Protection de la base de données des scellés</h2>
<p>Copier la base aide pour pouvoir en cas de besoin l’utiliser comme référence</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R52</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-84">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-202-désactiver-la-création-de-core-dumps">HARDE-RHEL-202 : Désactiver la création de core dumps</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.6.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R23</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-116">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-202 :</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb124-1"><a href="#cb124-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-202 : Désactiver la création de core dumps&quot;</span></span>
<span id="cb124-2"><a href="#cb124-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/15suid_dumpable.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb124-3"><a href="#cb124-3"></a><span class="st"># Pas de core dump des exécutables setuid</span></span>
<span id="cb124-4"><a href="#cb124-4"></a><span class="st">fs.suid_dumpable = 0</span></span>
<span id="cb124-5"><a href="#cb124-5"></a><span class="op">EOF</span></span>
<span id="cb124-6"><a href="#cb124-6"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/security/limits.d/10core.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb124-7"><a href="#cb124-7"></a><span class="st">* hard core 0</span></span>
<span id="cb124-8"><a href="#cb124-8"></a><span class="op">EOF</span></span>
<span id="cb124-9"><a href="#cb124-9"></a><span class="co"># Fin: HARDE-RHEL-202</span></span></code></pre></div>
<h3 id="méthode-daudit-122">Méthode d’audit</h3>
<h2 id="harde-rhel-203-activer-laléatoire-dans-lorganisation-de-lespace-dadressage">HARDE-RHEL-203 : Activer l’aléatoire dans l’organisation de l’espace d’adressage</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.6.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">08.3 Enable Operating System Anti-Exploitation Features/ Deploy Anti-Exploit Technologies</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R23</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-117">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-203 :</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb125-1"><a href="#cb125-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-203 : Activer l&#39;aléatoire dans l&#39;organisation de l&#39;espace d&#39;adressage&quot;</span></span>
<span id="cb125-2"><a href="#cb125-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/20aslr.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb125-3"><a href="#cb125-3"></a><span class="st"># Activation de l&#39;ASLR</span></span>
<span id="cb125-4"><a href="#cb125-4"></a><span class="st">kernel.randomize_va_space = 2</span></span>
<span id="cb125-5"><a href="#cb125-5"></a><span class="op">EOF</span></span>
<span id="cb125-6"><a href="#cb125-6"></a><span class="co"># Fin: HARDE-RHEL-203</span></span></code></pre></div>
<h3 id="méthode-daudit-123">Méthode d’audit</h3>
<h2 id="harde-rhel-204-paramétrage-des-sysctl-système">HARDE-RHEL-204 : Paramétrage des sysctl système</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R23</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-118">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-204 :</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb126-1"><a href="#cb126-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-204 : Paramètrage des sysctl système&quot;</span></span>
<span id="cb126-2"><a href="#cb126-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/10anssi.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb126-3"><a href="#cb126-3"></a><span class="st"># Désactivation des SysReq</span></span>
<span id="cb126-4"><a href="#cb126-4"></a><span class="st">kernel.sysrq = 0</span></span>
<span id="cb126-5"><a href="#cb126-5"></a><span class="st"># Interdiction de déréférencer des liens vers des fichiers dont</span></span>
<span id="cb126-6"><a href="#cb126-6"></a><span class="st"># l&#39;utilisateur courant n&#39;est pas le propriétaire</span></span>
<span id="cb126-7"><a href="#cb126-7"></a><span class="st"># Peut empêcher certains programmes de fonctionner correctement</span></span>
<span id="cb126-8"><a href="#cb126-8"></a><span class="st">fs.protected_symlinks = 1</span></span>
<span id="cb126-9"><a href="#cb126-9"></a><span class="st">fs.protected_hardlinks = 1</span></span>
<span id="cb126-10"><a href="#cb126-10"></a><span class="st"># Interdiction de mapper de la mémoire dans les adresses basses (0)</span></span>
<span id="cb126-11"><a href="#cb126-11"></a><span class="st">vm.mmap_min_addr = 65536</span></span>
<span id="cb126-12"><a href="#cb126-12"></a><span class="st"># Espace de choix plus grand pour les valeurs de PID</span></span>
<span id="cb126-13"><a href="#cb126-13"></a><span class="st">kernel.pid_max = 65536</span></span>
<span id="cb126-14"><a href="#cb126-14"></a><span class="st"># Obfuscation des adresses mémoire kernel</span></span>
<span id="cb126-15"><a href="#cb126-15"></a><span class="st">kernel.kptr_restrict = 1</span></span>
<span id="cb126-16"><a href="#cb126-16"></a><span class="st"># Restriction d&#39;accès au buffer dmesg</span></span>
<span id="cb126-17"><a href="#cb126-17"></a><span class="st">kernel.dmesg_restrict = 1</span></span>
<span id="cb126-18"><a href="#cb126-18"></a><span class="st"># Restreint l&#39;utilisation du sous système perf</span></span>
<span id="cb126-19"><a href="#cb126-19"></a><span class="st">kernel.perf_event_paranoid = 2</span></span>
<span id="cb126-20"><a href="#cb126-20"></a><span class="st">kernel.perf_event_max_sample_rate = 1</span></span>
<span id="cb126-21"><a href="#cb126-21"></a><span class="st">kernel.perf_cpu_time_max_percent = 1</span></span>
<span id="cb126-22"><a href="#cb126-22"></a><span class="op">EOF</span></span>
<span id="cb126-23"><a href="#cb126-23"></a><span class="co"># Fin: HARDE-RHEL-204</span></span></code></pre></div>
<h3 id="méthode-daudit-124">Méthode d’audit</h3>
<h2 id="harde-rhel-205-désactivation-du-chargement-des-modules-noyau">HARDE-RHEL-205 : Désactivation du chargement des modules noyau</h2>
<p>Le chargement des modules est empeche par un service custom lancé à la fin du processus de démarrage</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R24</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-119">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-205 :</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb127-1"><a href="#cb127-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb127-2"><a href="#cb127-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-205 : Désactivation du chargement des modules noyau&quot;</span></span>
<span id="cb127-3"><a href="#cb127-3"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/maintenance_mode.sh <span class="op">&lt;&lt;EOF</span></span>
<span id="cb127-4"><a href="#cb127-4"></a><span class="st">#! /bin/bash</span></span>
<span id="cb127-5"><a href="#cb127-5"></a><span class="st">[ </span><span class="va">$(</span><span class="ex">getsebool</span> secure_mode_insmod <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $3}&#39;</span><span class="va">)</span><span class="st"> = &quot;off&quot; ]  &amp;&amp; echo &quot;Currently in maintenance mode&quot;</span></span>
<span id="cb127-6"><a href="#cb127-6"></a><span class="st">if [ ! -f /SECURE_INSMOD_DISABLED ] ; then</span></span>
<span id="cb127-7"><a href="#cb127-7"></a><span class="st">    touch /SECURE_INSMOD_DISABLED</span></span>
<span id="cb127-8"><a href="#cb127-8"></a><span class="st">    echo &quot;Maintenance mode will be enabled on next boot.&quot;</span></span>
<span id="cb127-9"><a href="#cb127-9"></a><span class="st">    echo &quot;Run again to disable.&quot;</span></span>
<span id="cb127-10"><a href="#cb127-10"></a><span class="st">else</span></span>
<span id="cb127-11"><a href="#cb127-11"></a><span class="st">    rm /SECURE_INSMOD_DISABLED</span></span>
<span id="cb127-12"><a href="#cb127-12"></a><span class="st">    echo &quot;Maintenance mode will *NOT* be enabled on next boot.&quot;</span></span>
<span id="cb127-13"><a href="#cb127-13"></a><span class="st">fi</span></span>
<span id="cb127-14"><a href="#cb127-14"></a><span class="op">EOF</span></span>
<span id="cb127-15"><a href="#cb127-15"></a><span class="fu">chmod</span> 0700 /etc/maintenance_mode.sh</span>
<span id="cb127-16"><a href="#cb127-16"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/secure_insmod.sh <span class="op">&lt;&lt;EOF</span></span>
<span id="cb127-17"><a href="#cb127-17"></a><span class="st">#! /bin/bash</span></span>
<span id="cb127-18"><a href="#cb127-18"></a><span class="st">declare -a blacklist</span></span>
<span id="cb127-19"><a href="#cb127-19"></a><span class="st">blacklist=(</span></span>
<span id="cb127-20"><a href="#cb127-20"></a><span class="st">    [0]=&quot;usb-storage&quot;</span></span>
<span id="cb127-21"><a href="#cb127-21"></a><span class="st">    [1]=&quot;cramfs&quot;</span></span>
<span id="cb127-22"><a href="#cb127-22"></a><span class="st">    [2]=&quot;freevxfs&quot;</span></span>
<span id="cb127-23"><a href="#cb127-23"></a><span class="st">    [3]=&quot;jffs2&quot;</span></span>
<span id="cb127-24"><a href="#cb127-24"></a><span class="st">    [4]=&quot;hfs&quot;</span></span>
<span id="cb127-25"><a href="#cb127-25"></a><span class="st">    [5]=&quot;hfsplus&quot;</span></span>
<span id="cb127-26"><a href="#cb127-26"></a><span class="st">    [6]=&quot;squashfs&quot;</span></span>
<span id="cb127-27"><a href="#cb127-27"></a><span class="st">    [7]=&quot;crc-itu-t&quot;</span></span>
<span id="cb127-28"><a href="#cb127-28"></a><span class="st">    [8]=&quot;udf&quot;</span></span>
<span id="cb127-29"><a href="#cb127-29"></a><span class="st">    [9]=&quot;fat&quot;</span></span>
<span id="cb127-30"><a href="#cb127-30"></a><span class="st">    [10]=&quot;vfat&quot;</span></span>
<span id="cb127-31"><a href="#cb127-31"></a><span class="st">)</span></span>
<span id="cb127-32"><a href="#cb127-32"></a><span class="st">if [ ! -f /SECURE_INSMOD_DISABLED ] ; then</span></span>
<span id="cb127-33"><a href="#cb127-33"></a><span class="st">    # Explicitely disable some modules</span></span>
<span id="cb127-34"><a href="#cb127-34"></a><span class="st">    for module in &quot;</span><span class="dt">\$</span><span class="st">{blacklist[@]}&quot;; do</span></span>
<span id="cb127-35"><a href="#cb127-35"></a><span class="st">        [ -e &quot;/etc/modprobe.d/</span><span class="dt">\$</span><span class="st">module.conf&quot; ] || echo &quot;install </span><span class="dt">\$</span><span class="st">module /bin/true&quot; &gt;&quot;/etc/modprobe.d/</span><span class="dt">\$</span><span class="st">module.conf&quot;</span></span>
<span id="cb127-36"><a href="#cb127-36"></a><span class="st">    done</span></span>
<span id="cb127-37"><a href="#cb127-37"></a><span class="st">    setsebool secure_mode_insmod on</span></span>
<span id="cb127-38"><a href="#cb127-38"></a><span class="st">    sysctl -w kernel.modules_disabled=1</span></span>
<span id="cb127-39"><a href="#cb127-39"></a><span class="st">    exit 0</span></span>
<span id="cb127-40"><a href="#cb127-40"></a><span class="st">else</span></span>
<span id="cb127-41"><a href="#cb127-41"></a><span class="st">    # Re-instate disabled modules</span></span>
<span id="cb127-42"><a href="#cb127-42"></a><span class="st">    for module in &quot;</span><span class="dt">\$</span><span class="st">{blacklist[@]}&quot;; do</span></span>
<span id="cb127-43"><a href="#cb127-43"></a><span class="st">        rm -f &quot;/etc/modprobe.d/</span><span class="dt">\$</span><span class="st">module.conf&quot;</span></span>
<span id="cb127-44"><a href="#cb127-44"></a><span class="st">    done</span></span>
<span id="cb127-45"><a href="#cb127-45"></a><span class="st">    setsebool secure_mode_insmod off</span></span>
<span id="cb127-46"><a href="#cb127-46"></a><span class="st">    mount /boot</span></span>
<span id="cb127-47"><a href="#cb127-47"></a><span class="st">    mount /boot/efi</span></span>
<span id="cb127-48"><a href="#cb127-48"></a><span class="st">    modprobe iso9660</span></span>
<span id="cb127-49"><a href="#cb127-49"></a><span class="st">    echo &quot;Secure insmod is DISABLED.&quot;</span></span>
<span id="cb127-50"><a href="#cb127-50"></a><span class="st">    rm -f /SECURE_INSMOD_DISABLED</span></span>
<span id="cb127-51"><a href="#cb127-51"></a><span class="st">fi</span></span>
<span id="cb127-52"><a href="#cb127-52"></a><span class="st">exit 0</span></span>
<span id="cb127-53"><a href="#cb127-53"></a><span class="op">EOF</span></span>
<span id="cb127-54"><a href="#cb127-54"></a><span class="fu">chmod</span> 0700 /etc/secure_insmod.sh</span>
<span id="cb127-55"><a href="#cb127-55"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/system/secure_insmod.service <span class="op">&lt;&lt;EOF</span></span>
<span id="cb127-56"><a href="#cb127-56"></a><span class="st">[Unit]</span></span>
<span id="cb127-57"><a href="#cb127-57"></a><span class="st">Description=Script to prevents any further module loading</span></span>
<span id="cb127-58"><a href="#cb127-58"></a><span class="st">After=default.target</span></span>
<span id="cb127-59"><a href="#cb127-59"></a></span>
<span id="cb127-60"><a href="#cb127-60"></a><span class="st">[Service]</span></span>
<span id="cb127-61"><a href="#cb127-61"></a><span class="st">Type=oneshot</span></span>
<span id="cb127-62"><a href="#cb127-62"></a><span class="st">ExecStart=/etc/secure_insmod.sh</span></span>
<span id="cb127-63"><a href="#cb127-63"></a><span class="st">ExecStop=/etc/secure_insmod.sh</span></span>
<span id="cb127-64"><a href="#cb127-64"></a><span class="st">TimeoutStartSec=0</span></span>
<span id="cb127-65"><a href="#cb127-65"></a></span>
<span id="cb127-66"><a href="#cb127-66"></a><span class="st">[Install]</span></span>
<span id="cb127-67"><a href="#cb127-67"></a><span class="st">WantedBy=default.target</span></span>
<span id="cb127-68"><a href="#cb127-68"></a><span class="op">EOF</span></span>
<span id="cb127-69"><a href="#cb127-69"></a><span class="ex">systemctl</span> enable secure_insmod</span>
<span id="cb127-70"><a href="#cb127-70"></a><span class="co"># Fin: HARDE-RHEL-205</span></span></code></pre></div>
<h3 id="méthode-daudit-125">Méthode d’audit</h3>
<h2 id="harde-rhel-206-configuration-sysctl-du-module-yama">HARDE-RHEL-206 : Configuration sysctl du module Yama</h2>
<p>Créer le fichier de configuration en lançant la commande suivante. Ce paramètrage n’est pris en compte qu’au redémarrage ou au lancement de la commande /sbin/sysctl –system.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R25</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-120">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-206 :</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb128-1"><a href="#cb128-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-206 : Configuration sysctl du module Yama&quot;</span></span>
<span id="cb128-2"><a href="#cb128-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/25yama.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb128-3"><a href="#cb128-3"></a><span class="st">kernel.yama.ptrace_scope = 1</span></span>
<span id="cb128-4"><a href="#cb128-4"></a><span class="op">EOF</span></span>
<span id="cb128-5"><a href="#cb128-5"></a><span class="co"># Fin: HARDE-RHEL-206</span></span></code></pre></div>
<h3 id="méthode-daudit-126">Méthode d’audit</h3>
<h2 id="harde-rhel-207-partition-séparée-pour-varlog">HARDE-RHEL-207 : Partition séparée pour /var/log</h2>
<p>/var/log doit être installé dans une partition séparé d’au moins 4GB avec les options nodev</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.11</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.4 Ensure adequate storage for logs</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R47</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-121">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-207 :</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb129-1"><a href="#cb129-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-207 : Partition séparée pour /var/log&quot;</span></span>
<span id="cb129-2"><a href="#cb129-2"></a><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;/var/log\s&#39;</span> <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;/var/log n&#39;est pas une partition séparée !&quot;</span></span>
<span id="cb129-3"><a href="#cb129-3"></a><span class="co"># Fin: HARDE-RHEL-207</span></span></code></pre></div>
<h3 id="méthode-daudit-127">Méthode d’audit</h3>
<h2 id="harde-rhel-208-partition-séparée-pour-varlogaudit">HARDE-RHEL-208 : Partition séparée pour /var/log/audit</h2>
<p>/var/log/audit doit être installé dans une partition séparé d’au moins 4GB avec les options nodev</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.1.12</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.4 Ensure adequate storage for logs</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R47</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-122">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-208 :</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb130-1"><a href="#cb130-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-208 : Partition séparée pour /var/log/audit&quot;</span></span>
<span id="cb130-2"><a href="#cb130-2"></a><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;/var/log/audit\s&#39;</span> <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;/var/log/audit n&#39;est pas une partition séparée !&quot;</span></span>
<span id="cb130-3"><a href="#cb130-3"></a><span class="co"># Fin: HARDE-RHEL-208</span></span></code></pre></div>
<h3 id="méthode-daudit-128">Méthode d’audit</h3>
<h2 id="harde-rhel-209-journal-spécifique-pour-sudo">HARDE-RHEL-209 : Journal spécifique pour sudo</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 1.3.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-123">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-209 :</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb131-1"><a href="#cb131-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-209 : Journal spécifique pour sudo&quot;</span></span>
<span id="cb131-2"><a href="#cb131-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sudoers.d/05log <span class="op">&lt;&lt;EOF</span></span>
<span id="cb131-3"><a href="#cb131-3"></a><span class="st">Defaults logfile=&quot;/var/log/sudo/sudo.log&quot;</span></span>
<span id="cb131-4"><a href="#cb131-4"></a><span class="op">EOF</span></span>
<span id="cb131-5"><a href="#cb131-5"></a><span class="fu">mkdir</span> /var/log/sudo</span>
<span id="cb131-6"><a href="#cb131-6"></a><span class="ex">semanage</span> fcontext <span class="at">--add</span> <span class="at">-t</span> sudo_log_t /var/log/sudo</span>
<span id="cb131-7"><a href="#cb131-7"></a><span class="ex">restorecon</span> <span class="at">-R</span> <span class="at">-v</span> /var/log/sudo</span>
<span id="cb131-8"><a href="#cb131-8"></a><span class="co"># Fin: HARDE-RHEL-209</span></span></code></pre></div>
<h3 id="méthode-daudit-129">Méthode d’audit</h3>
<h2 id="harde-rhel-210-sassurer-quauditd-est-installé">HARDE-RHEL-210 : S’assurer qu’auditd est installé</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.1.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-124">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-210 :</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb132-1"><a href="#cb132-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-210 : S&#39;assurer qu&#39;auditd est installé&quot;</span></span>
<span id="cb132-2"><a href="#cb132-2"></a><span class="ex">dnf</span> install audit audit-libs</span>
<span id="cb132-3"><a href="#cb132-3"></a><span class="co"># Fin: HARDE-RHEL-210</span></span></code></pre></div>
<h3 id="méthode-daudit-130">Méthode d’audit</h3>
<h2 id="harde-rhel-211-sassurer-que-le-service-auditd-est-activé">HARDE-RHEL-211 : S’assurer que le service auditd est activé</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.1.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-125">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-211 :</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb133-1"><a href="#cb133-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-211 : S&#39;assurer que le service auditd est activé&quot;</span></span>
<span id="cb133-2"><a href="#cb133-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> enable auditd</span>
<span id="cb133-3"><a href="#cb133-3"></a><span class="co"># Fin: HARDE-RHEL-211</span></span></code></pre></div>
<h3 id="méthode-daudit-131">Méthode d’audit</h3>
<h2 id="harde-rhel-212-sassurer-que-laudit-commence-au-plus-tôt">HARDE-RHEL-212 : S’assurer que l’audit commence au plus tôt</h2>
<p>Éditer /etc/default/grub et modifier le paramètre GRUB_CMDLINE_LINUX pour inclure auditd=1 puis lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.1.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-126">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-212 :</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb134-1"><a href="#cb134-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-212 : S&#39;assurer que l&#39;audit commence au plus tôt&quot;</span></span>
<span id="cb134-2"><a href="#cb134-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;auditd=&#39;</span> /etc/default/grub<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb134-3"><a href="#cb134-3"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(GRUB_CMDLINE_LINUX=&quot;[^&quot;]*\)&quot;/\1 auditd=1&quot;/&#39;</span> <span class="at">-i</span> /etc/default/grub</span>
<span id="cb134-4"><a href="#cb134-4"></a>  <span class="bu">echo</span> <span class="st">&quot;Parameter auditd added.&quot;</span></span>
<span id="cb134-5"><a href="#cb134-5"></a><span class="cf">fi</span></span>
<span id="cb134-6"><a href="#cb134-6"></a><span class="ex">grub2-mkconfig</span> –o /boot/grub2/grub.cfg <span class="op">&gt;</span>/dev/null</span>
<span id="cb134-7"><a href="#cb134-7"></a><span class="ex">grub2-mkconfig</span> –o /boot/efi/EFI/grub.cfg <span class="op">&gt;</span>/dev/null</span>
<span id="cb134-8"><a href="#cb134-8"></a><span class="co"># Fin: HARDE-RHEL-212</span></span></code></pre></div>
<h3 id="méthode-daudit-132">Méthode d’audit</h3>
<h2 id="harde-rhel-213-sassurer-que-la-valeur-daudit_backlog_limit-est-suffisante">HARDE-RHEL-213 : S’assurer que la valeur d’audit_backlog_limit est suffisante</h2>
<p>Éditer /etc/default/grub et modifier le paramètre GRUB_CMDLINE_LINUX pour inclure audit_backlog_limit=8192 puis lancer la commande suivante :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.1.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-127">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-213 :</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb135-1"><a href="#cb135-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-213 : S&#39;assurer que la valeur d&#39;audit_backlog_limit est suffisante&quot;</span></span>
<span id="cb135-2"><a href="#cb135-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;audit_backlog_limit=&#39;</span> /etc/default/grub<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb135-3"><a href="#cb135-3"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(GRUB_CMDLINE_LINUX=&quot;[^&quot;]*\)&quot;/\1 audit_backlog_limit=8192&quot;/&#39;</span> <span class="at">-i</span> /etc/default/grub</span>
<span id="cb135-4"><a href="#cb135-4"></a>  <span class="bu">echo</span> <span class="st">&quot;Parameter audit_backlog_limit added.&quot;</span></span>
<span id="cb135-5"><a href="#cb135-5"></a><span class="cf">fi</span></span>
<span id="cb135-6"><a href="#cb135-6"></a><span class="ex">grub2-mkconfig</span> –o /boot/grub2/grub.cfg <span class="op">&gt;</span>/dev/null</span>
<span id="cb135-7"><a href="#cb135-7"></a><span class="ex">grub2-mkconfig</span> –o /boot/efi/EFI/grub.cfg <span class="op">&gt;</span>/dev/null</span>
<span id="cb135-8"><a href="#cb135-8"></a><span class="co"># Fin: HARDE-RHEL-213</span></span></code></pre></div>
<h3 id="méthode-daudit-133">Méthode d’audit</h3>
<h2 id="harde-rhel-214-tracer-les-tentatives-daccès-aux-fichiers-refusées">HARDE-RHEL-214 : Tracer les tentatives d’accès aux fichiers refusées</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.10</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">14.9 Enforce Detail Logging for Access or Changes to Sensitive Data</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-128">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-214 :</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb136-1"><a href="#cb136-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-214 : Tracer les tentatives d&#39;accès aux fichiers refusées &quot;</span></span>
<span id="cb136-2"><a href="#cb136-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/35access.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb136-3"><a href="#cb136-3"></a><span class="st">-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=4294967295 -k access</span></span>
<span id="cb136-4"><a href="#cb136-4"></a><span class="st">-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=4294967295 -k access</span></span>
<span id="cb136-5"><a href="#cb136-5"></a><span class="st">-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=4294967295 -k access</span></span>
<span id="cb136-6"><a href="#cb136-6"></a><span class="st">-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=4294967295 -k access</span></span>
<span id="cb136-7"><a href="#cb136-7"></a><span class="op">EOF</span></span>
<span id="cb136-8"><a href="#cb136-8"></a><span class="co"># Fin: HARDE-RHEL-214</span></span></code></pre></div>
<h3 id="méthode-daudit-134">Méthode d’audit</h3>
<h2 id="harde-rhel-215-tracer-les-modifications-dutilisateurs">HARDE-RHEL-215 : Tracer les modifications d’utilisateurs</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.11</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.8 Log and Alert on Changes to Administrative Group Membership</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-129">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-215 :</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb137-1"><a href="#cb137-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-215 : Tracer les modifications d&#39;utilisateurs&quot;</span></span>
<span id="cb137-2"><a href="#cb137-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/40identity.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb137-3"><a href="#cb137-3"></a><span class="st">-w /etc/group -p wa -k identity</span></span>
<span id="cb137-4"><a href="#cb137-4"></a><span class="st">-w /etc/passwd -p wa -k identity</span></span>
<span id="cb137-5"><a href="#cb137-5"></a><span class="st">-w /etc/gshadow -p wa -k identity</span></span>
<span id="cb137-6"><a href="#cb137-6"></a><span class="st">-w /etc/shadow -p wa -k identity</span></span>
<span id="cb137-7"><a href="#cb137-7"></a><span class="st">-w /etc/security/opasswd -p wa -k identity</span></span>
<span id="cb137-8"><a href="#cb137-8"></a><span class="op">EOF</span></span>
<span id="cb137-9"><a href="#cb137-9"></a><span class="co"># Fin: HARDE-RHEL-215</span></span></code></pre></div>
<h3 id="méthode-daudit-135">Méthode d’audit</h3>
<h2 id="harde-rhel-216-journalisation-de-lactivité-par-auditd">HARDE-RHEL-216 : Journalisation de l’activité par auditd</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.12<br>RHEL 8 4.1.17</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations<br>06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R50</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-130">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-216 :</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb138-1"><a href="#cb138-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb138-2"><a href="#cb138-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-216 : Journalisation de l&#39;activité par auditd&quot;</span></span>
<span id="cb138-3"><a href="#cb138-3"></a><span class="co"># Remove any pre-existing rules</span></span>
<span id="cb138-4"><a href="#cb138-4"></a><span class="fu">rm</span> <span class="at">-f</span> /etc/audit/rules.d/audit.rules <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb138-5"><a href="#cb138-5"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/00audit.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb138-6"><a href="#cb138-6"></a><span class="st">## First rule - delete all</span></span>
<span id="cb138-7"><a href="#cb138-7"></a><span class="st">-D</span></span>
<span id="cb138-8"><a href="#cb138-8"></a><span class="st">## Increase the buffers to survive stress events.</span></span>
<span id="cb138-9"><a href="#cb138-9"></a><span class="st">## Make this bigger for busy systems</span></span>
<span id="cb138-10"><a href="#cb138-10"></a><span class="st">-b 8192</span></span>
<span id="cb138-11"><a href="#cb138-11"></a><span class="st">## This determine how long to wait in burst of events</span></span>
<span id="cb138-12"><a href="#cb138-12"></a><span class="st">--backlog_wait_time 60000</span></span>
<span id="cb138-13"><a href="#cb138-13"></a><span class="st">## Set failure mode to syslog</span></span>
<span id="cb138-14"><a href="#cb138-14"></a><span class="st">-f 1</span></span>
<span id="cb138-15"><a href="#cb138-15"></a><span class="op">EOF</span></span>
<span id="cb138-16"><a href="#cb138-16"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/10etc.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb138-17"><a href="#cb138-17"></a><span class="st"># Journaliser les modifications dans /etc/</span></span>
<span id="cb138-18"><a href="#cb138-18"></a><span class="st">-w /etc/ -p wa</span></span>
<span id="cb138-19"><a href="#cb138-19"></a><span class="op">EOF</span></span>
<span id="cb138-20"><a href="#cb138-20"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/20mount.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb138-21"><a href="#cb138-21"></a><span class="st"># Surveillance de montage/démontage</span></span>
<span id="cb138-22"><a href="#cb138-22"></a><span class="st">-a exit,always -F arch=b32 -S mount -S umount2 -k mounts</span></span>
<span id="cb138-23"><a href="#cb138-23"></a><span class="st">-a exit,always -F arch=b64 -S mount -S umount2 -k mounts</span></span>
<span id="cb138-24"><a href="#cb138-24"></a><span class="op">EOF</span></span>
<span id="cb138-25"><a href="#cb138-25"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/30syscalls.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb138-26"><a href="#cb138-26"></a><span class="st"># Appels de syscalls x86 suspects</span></span>
<span id="cb138-27"><a href="#cb138-27"></a><span class="st">-a exit,always -F arch=b32 -S ioperm -S modify_ldt</span></span>
<span id="cb138-28"><a href="#cb138-28"></a><span class="st">-a exit,always -F arch=b64 -S ioperm -S modify_ldt</span></span>
<span id="cb138-29"><a href="#cb138-29"></a><span class="st"># Appels de syscalls qui doivent être rares et surveillés de près</span></span>
<span id="cb138-30"><a href="#cb138-30"></a><span class="st">-a exit,always -F arch=b32 -S get_kernel_syms -S ptrace</span></span>
<span id="cb138-31"><a href="#cb138-31"></a><span class="st">-a exit,always -F arch=b64 -S get_kernel_syms -S ptrace</span></span>
<span id="cb138-32"><a href="#cb138-32"></a><span class="st">-a exit,always -F arch=b32 -S prctl</span></span>
<span id="cb138-33"><a href="#cb138-33"></a><span class="st">-a exit,always -F arch=b64 -S prctl</span></span>
<span id="cb138-34"><a href="#cb138-34"></a><span class="op">EOF</span></span>
<span id="cb138-35"><a href="#cb138-35"></a><span class="co"># Fin: HARDE-RHEL-216</span></span></code></pre></div>
<h3 id="méthode-daudit-136">Méthode d’audit</h3>
<h2 id="harde-rhel-217-tracer-lutilisation-des-commandes-privilégiés">HARDE-RHEL-217 : Tracer l’utilisation des commandes privilégiés</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.13</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-131">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-217 :</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb139-1"><a href="#cb139-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-217 : Tracer l&#39;utilisation des commandes privilégiés&quot;</span></span>
<span id="cb139-2"><a href="#cb139-2"></a><span class="fu">find</span> / /usr /srv <span class="at">-xdev</span> <span class="dt">\(</span> <span class="at">-perm</span> <span class="at">-4000</span> <span class="at">-o</span> <span class="at">-perm</span> <span class="at">-2000</span> <span class="dt">\)</span> <span class="at">-type</span> f <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print &quot;-a always,exit -F path=&quot; $1 &quot; -F perm=x -F auid&gt;=&#39;&quot;</span><span class="va">$(</span><span class="fu">awk</span> <span class="st">&#39;/^\s*UID_MIN/{print $2}&#39;</span> /etc/login.defs<span class="va">)</span><span class="st">&quot;&#39; -F auid!=4294967295 -k privileged&quot; }&#39;</span> <span class="op">&gt;</span>/etc/audit/rules.d/25privileged.rules</span>
<span id="cb139-3"><a href="#cb139-3"></a><span class="co"># Fin: HARDE-RHEL-217</span></span></code></pre></div>
<h3 id="méthode-daudit-137">Méthode d’audit</h3>
<h2 id="harde-rhel-218-tracer-les-suppressions-de-fichiers">HARDE-RHEL-218 : Tracer les suppressions de fichiers</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.14</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">13 Data Protection</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-132">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-218 :</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb140-1"><a href="#cb140-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-218 : Tracer les suppressions de fichiers&quot;</span></span>
<span id="cb140-2"><a href="#cb140-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/45delete.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb140-3"><a href="#cb140-3"></a><span class="st">-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=1000 -F auid!=4294967295 -k delete</span></span>
<span id="cb140-4"><a href="#cb140-4"></a><span class="st">-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=1000 -F auid!=4294967295 -k delete</span></span>
<span id="cb140-5"><a href="#cb140-5"></a><span class="op">EOF</span></span>
<span id="cb140-6"><a href="#cb140-6"></a><span class="co"># Fin: HARDE-RHEL-218</span></span></code></pre></div>
<h3 id="méthode-daudit-138">Méthode d’audit</h3>
<h2 id="harde-rhel-219-tracer-le-chargementdéchargement-de-modules">HARDE-RHEL-219 : Tracer le chargement/déchargement de modules</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.15</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-133">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-219 :</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb141-1"><a href="#cb141-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-219 : Tracer le chargement/déchargement de modules&quot;</span></span>
<span id="cb141-2"><a href="#cb141-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/50modules.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb141-3"><a href="#cb141-3"></a><span class="st">-w /sbin/insmod -p x -k modules</span></span>
<span id="cb141-4"><a href="#cb141-4"></a><span class="st">-w /sbin/rmmod -p x -k modules</span></span>
<span id="cb141-5"><a href="#cb141-5"></a><span class="st">-w /sbin/modprobe -p x -k modules</span></span>
<span id="cb141-6"><a href="#cb141-6"></a><span class="st">-a always,exit -F arch=b64 -S init_module -S delete_module -k modules</span></span>
<span id="cb141-7"><a href="#cb141-7"></a><span class="op">EOF</span></span>
<span id="cb141-8"><a href="#cb141-8"></a><span class="co"># Fin: HARDE-RHEL-219</span></span></code></pre></div>
<h3 id="méthode-daudit-139">Méthode d’audit</h3>
<h2 id="harde-rhel-220-tracer-les-actions-des-administrateurs">HARDE-RHEL-220 : Tracer les actions des administrateurs</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.16</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.9 Log and Alert on Unsuccessful Administrative Account Login</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-134">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-220 :</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb142-1"><a href="#cb142-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-220 : Tracer les actions des administrateurs&quot;</span></span>
<span id="cb142-2"><a href="#cb142-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/55actions.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb142-3"><a href="#cb142-3"></a><span class="st">-w /var/log/sudo.log -p wa -k actions</span></span>
<span id="cb142-4"><a href="#cb142-4"></a><span class="op">EOF</span></span>
<span id="cb142-5"><a href="#cb142-5"></a><span class="co"># Fin: HARDE-RHEL-220</span></span></code></pre></div>
<h3 id="méthode-daudit-140">Méthode d’audit</h3>
<h2 id="harde-rhel-221-sassurer-que-la-configuration-auditd-nest-pas-modifiable">HARDE-RHEL-221 : S’assurer que la configuration auditd n’est pas modifiable</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.17</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-135">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-221 :</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb143-1"><a href="#cb143-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-221 : S&#39;assurer que la configuration auditd n&#39;est pas modifiable&quot;</span></span>
<span id="cb143-2"><a href="#cb143-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/zz_lock.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb143-3"><a href="#cb143-3"></a><span class="st"># Verrouillage de la configuration de auditd</span></span>
<span id="cb143-4"><a href="#cb143-4"></a><span class="st">-e 2</span></span>
<span id="cb143-5"><a href="#cb143-5"></a><span class="op">EOF</span></span>
<span id="cb143-6"><a href="#cb143-6"></a><span class="co"># Fin: HARDE-RHEL-221</span></span></code></pre></div>
<h3 id="méthode-daudit-141">Méthode d’audit</h3>
<h2 id="harde-rhel-222-sassurer-que-la-taille-de-stockage-est-spécifiée">HARDE-RHEL-222 : S’assurer que la taille de stockage est spécifiée</h2>
<p>Red Hat 8 est conforme par défaut.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.2.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.4 Ensure adequate storage for logs</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-136">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-222 :</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb144-1"><a href="#cb144-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-222 : S&#39;assurer que la taille de stockage est spécifiée&quot;</span></span>
<span id="cb144-2"><a href="#cb144-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^max_log_file = 8&#39;</span> /etc/audit/auditd.conf<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb144-3"><a href="#cb144-3"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(max_log_file .*\)/#HARDE-RHEL-222: \1/&#39;</span> <span class="at">-i</span> /etc/audit/auditd.conf</span>
<span id="cb144-4"><a href="#cb144-4"></a>  <span class="bu">echo</span> <span class="st">&quot;max_log_file = 8&quot;</span> <span class="op">&gt;&gt;</span>/etc/audit/auditd.conf</span>
<span id="cb144-5"><a href="#cb144-5"></a><span class="cf">fi</span></span>
<span id="cb144-6"><a href="#cb144-6"></a><span class="co"># Fin: HARDE-RHEL-222</span></span></code></pre></div>
<h3 id="méthode-daudit-142">Méthode d’audit</h3>
<h2 id="harde-rhel-223-sassurer-que-les-logs-daudit-ne-soient-pas-purgés">HARDE-RHEL-223 : S’assurer que les logs d’audit ne soient pas purgés</h2>
<p>dans /etc/audit/auditd.conf, s’assurer que le paramètre max_log_file_action soit positionné à keep_logs</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.2.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.4 Ensure adequate storage for logs</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-137">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-223 :</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb145-1"><a href="#cb145-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb145-2"><a href="#cb145-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-223 : S&#39;assurer que les logs d&#39;audit ne soient pas purgés&quot;</span></span>
<span id="cb145-3"><a href="#cb145-3"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^max_log_file_action = keep_logs&#39;</span> /etc/audit/auditd.conf<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb145-4"><a href="#cb145-4"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(max_log_file_action.*\)/#HARDE-RHEL-223: \1/&#39;</span> <span class="dt">\</span></span>
<span id="cb145-5"><a href="#cb145-5"></a>    <span class="at">-i</span> /etc/audit/auditd.conf</span>
<span id="cb145-6"><a href="#cb145-6"></a>  <span class="bu">echo</span> <span class="st">&quot;max_log_file_action = keep_logs&quot;</span> <span class="op">&gt;&gt;</span>/etc/audit/auditd.conf</span>
<span id="cb145-7"><a href="#cb145-7"></a><span class="cf">fi</span></span>
<span id="cb145-8"><a href="#cb145-8"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/cron.daily/auditd <span class="op">&lt;&lt;&#39;EOF&#39;</span></span>
<span id="cb145-9"><a href="#cb145-9"></a><span class="st">#! /bin/bash</span></span>
<span id="cb145-10"><a href="#cb145-10"></a><span class="st">NUM_LOGS=30</span></span>
<span id="cb145-11"><a href="#cb145-11"></a><span class="st"># /var/log/audit/audit.log.XX</span></span>
<span id="cb145-12"><a href="#cb145-12"></a><span class="st"># Only keep the files where XX &gt; NUM_LOGS</span></span>
<span id="cb145-13"><a href="#cb145-13"></a><span class="st">for log in /var/log/audit/audit.log.*</span></span>
<span id="cb145-14"><a href="#cb145-14"></a><span class="st">do</span></span>
<span id="cb145-15"><a href="#cb145-15"></a><span class="st">    extension=&quot;${log##*.}&quot;</span></span>
<span id="cb145-16"><a href="#cb145-16"></a><span class="st">    # Ignore non-numeric extensions</span></span>
<span id="cb145-17"><a href="#cb145-17"></a><span class="st">    [ &quot;$extension&quot; -eq &quot;$extension&quot; ] 2&gt;/dev/null || continue </span></span>
<span id="cb145-18"><a href="#cb145-18"></a><span class="st">    [ &quot;$extension&quot; -gt $NUM_LOGS ] &amp;&amp; /bin/rm -f &quot;$log&quot;</span></span>
<span id="cb145-19"><a href="#cb145-19"></a><span class="st">done</span></span>
<span id="cb145-20"><a href="#cb145-20"></a><span class="st">kill -USR1 &quot;$(/sbin/pidof auditd)&quot;</span></span>
<span id="cb145-21"><a href="#cb145-21"></a><span class="op">EOF</span></span>
<span id="cb145-22"><a href="#cb145-22"></a><span class="fu">chmod</span> 0500 /etc/cron.daily/auditd</span>
<span id="cb145-23"><a href="#cb145-23"></a><span class="co"># Fin: HARDE-RHEL-223</span></span></code></pre></div>
<h3 id="méthode-daudit-143">Méthode d’audit</h3>
<h2 id="harde-rhel-224-sassurer-que-le-système-sarrête-si-le-système-daudit-est-plein">HARDE-RHEL-224 : S’assurer que le système s’arrête si le système d’audit est plein</h2>
<p>Dans /etc/audit/auditd.conf, s’assurer que le paramètre admin_space_left_action soit positionné à halt. Cela suppose que l’espace disque est supervisé, une partition d’audit remplie entrainant un arrêt du système.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.2.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-138">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-224 :</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb146-1"><a href="#cb146-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb146-2"><a href="#cb146-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-224 : S&#39;assurer que le système s&#39;arrête si le système d&#39;audit est plein&quot;</span></span>
<span id="cb146-3"><a href="#cb146-3"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^admin_space_left_action = halt&#39;</span> /etc/audit/auditd.conf<span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb146-4"><a href="#cb146-4"></a>  <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/\(admin_space_left_action .*\)/#HARDE-RHEL-224: \1/&#39;</span> <span class="at">-i</span> /etc/audit/auditd.conf</span>
<span id="cb146-5"><a href="#cb146-5"></a>  <span class="bu">echo</span> <span class="st">&quot;admin_space_left_action = halt&quot;</span> <span class="op">&gt;&gt;</span>/etc/audit/auditd.conf</span>
<span id="cb146-6"><a href="#cb146-6"></a><span class="cf">fi</span></span>
<span id="cb146-7"><a href="#cb146-7"></a><span class="co"># Fin: HARDE-RHEL-224</span></span></code></pre></div>
<h3 id="méthode-daudit-144">Méthode d’audit</h3>
<h2 id="harde-rhel-225-auditer-tout-changement-du-fichier-sudoers">HARDE-RHEL-225 : Auditer tout changement du fichier sudoers</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.8 Log and Alert on Changes to Administrative Group Membership</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-139">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-225 :</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb147-1"><a href="#cb147-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-225 : Auditer tout changement du fichier sudoers&quot;</span></span>
<span id="cb147-2"><a href="#cb147-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/60scope.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb147-3"><a href="#cb147-3"></a><span class="st">-w /etc/sudoers -p wa -k scope</span></span>
<span id="cb147-4"><a href="#cb147-4"></a><span class="st">-w /etc/sudoers.d/ -p wa -k scope</span></span>
<span id="cb147-5"><a href="#cb147-5"></a><span class="op">EOF</span></span>
<span id="cb147-6"><a href="#cb147-6"></a><span class="co"># Fin: HARDE-RHEL-225</span></span></code></pre></div>
<h3 id="méthode-daudit-145">Méthode d’audit</h3>
<h2 id="harde-rhel-226-auditer-toute-connexiondéconnexion">HARDE-RHEL-226 : Auditer toute connexion/déconnexion</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.9 Log and Alert on Unsuccessful Administrative Account Login<br>16.13 Alert on Account Login Behavior Deviation</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-140">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-226 :</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb148-1"><a href="#cb148-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb148-2"><a href="#cb148-2"></a><span class="co"># See https://workbench.cisecurity.org/tickets/13291</span></span>
<span id="cb148-3"><a href="#cb148-3"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-226 : Auditer toute connexion/déconnexion&quot;</span></span>
<span id="cb148-4"><a href="#cb148-4"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/65audit.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb148-5"><a href="#cb148-5"></a><span class="st">-w /var/log/faillog -p wa -k logins</span></span>
<span id="cb148-6"><a href="#cb148-6"></a><span class="st">-w /var/log/lastlog -p wa -k logins</span></span>
<span id="cb148-7"><a href="#cb148-7"></a><span class="op">EOF</span></span>
<span id="cb148-8"><a href="#cb148-8"></a><span class="co"># Fin: HARDE-RHEL-226</span></span></code></pre></div>
<h3 id="méthode-daudit-146">Méthode d’audit</h3>
<h2 id="harde-rhel-227-collecter-toutes-les-informations-de-session">HARDE-RHEL-227 : Collecter toutes les informations de session</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">04.9 Log and Alert on Unsuccessful Administrative Account Login<br>16.13 Alert on Account Login Behavior Deviation</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-141">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-227 :</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb149-1"><a href="#cb149-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-227 : Collecter toutes les informations de session&quot;</span></span>
<span id="cb149-2"><a href="#cb149-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/70logins.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb149-3"><a href="#cb149-3"></a><span class="st">-w /var/run/utmp -p wa -k session</span></span>
<span id="cb149-4"><a href="#cb149-4"></a><span class="st">-w /var/log/wtmp -p wa -k logins</span></span>
<span id="cb149-5"><a href="#cb149-5"></a><span class="st">-w /var/log/btmp -p wa -k logins</span></span>
<span id="cb149-6"><a href="#cb149-6"></a><span class="op">EOF</span></span>
<span id="cb149-7"><a href="#cb149-7"></a><span class="co"># Fin: HARDE-RHEL-227</span></span></code></pre></div>
<h3 id="méthode-daudit-147">Méthode d’audit</h3>
<h2 id="harde-rhel-228-sassurer-que-les-évènements-de-changements-horaires-soient-tracés">HARDE-RHEL-228 : S’assurer que les évènements de changements horaires soient tracés</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.5 Implement Automated Configuration Monitoring Systems</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-142">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-228 :</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb150-1"><a href="#cb150-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-228 : S&#39;assurer que les évenement de changements horaires soient tracés&quot;</span></span>
<span id="cb150-2"><a href="#cb150-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/75time-change.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb150-3"><a href="#cb150-3"></a><span class="st">-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change</span></span>
<span id="cb150-4"><a href="#cb150-4"></a><span class="st">-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change</span></span>
<span id="cb150-5"><a href="#cb150-5"></a><span class="st">-a always,exit -F arch=b64 -S clock_settime -k time-change</span></span>
<span id="cb150-6"><a href="#cb150-6"></a><span class="st">-a always,exit -F arch=b32 -S clock_settime -k time-change</span></span>
<span id="cb150-7"><a href="#cb150-7"></a><span class="st">-w /etc/localtime -p wa -k time-change</span></span>
<span id="cb150-8"><a href="#cb150-8"></a><span class="op">EOF</span></span>
<span id="cb150-9"><a href="#cb150-9"></a><span class="co"># Fin: HARDE-RHEL-228</span></span></code></pre></div>
<h3 id="méthode-daudit-148">Méthode d’audit</h3>
<h2 id="harde-rhel-229-sassurer-que-les-évènements-modifiant-les-mac-soient-collectés">HARDE-RHEL-229 : S’assurer que les évènements modifiant les MAC soient collectés</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.7</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.5 Implement Automated Configuration Monitoring Systems</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-143">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-229 :</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb151-1"><a href="#cb151-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-229 : S&#39;assurer que les événements modifiant les MAC soient collectéees&quot;</span></span>
<span id="cb151-2"><a href="#cb151-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/80MAC-policy.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb151-3"><a href="#cb151-3"></a><span class="st">-w /etc/selinux/ -p wa -k MAC-policy</span></span>
<span id="cb151-4"><a href="#cb151-4"></a><span class="st">-w /usr/share/selinux/ -p wa -k MAC-policy</span></span>
<span id="cb151-5"><a href="#cb151-5"></a><span class="op">EOF</span></span>
<span id="cb151-6"><a href="#cb151-6"></a><span class="co"># Fin: HARDE-RHEL-229</span></span></code></pre></div>
<h3 id="méthode-daudit-149">Méthode d’audit</h3>
<h2 id="harde-rhel-230-tracer-les-évènements-changeant-lenvironnement-réseau">HARDE-RHEL-230 : Tracer les évènements changeant l’environnement réseau</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.8</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.5 Implement Automated Configuration Monitoring Systems</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-144">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-230 :</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb152-1"><a href="#cb152-1"></a><span class="co">#! /bin/bash</span></span>
<span id="cb152-2"><a href="#cb152-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-230 : Tracer les événements changeant l&#39;environnement réseau&quot;</span></span>
<span id="cb152-3"><a href="#cb152-3"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/85system-locale.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb152-4"><a href="#cb152-4"></a><span class="st">-a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale</span></span>
<span id="cb152-5"><a href="#cb152-5"></a><span class="st">-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale</span></span>
<span id="cb152-6"><a href="#cb152-6"></a><span class="st">-w /etc/issue -p wa -k system-locale</span></span>
<span id="cb152-7"><a href="#cb152-7"></a><span class="st">-w /etc/issue.net -p wa -k system-locale</span></span>
<span id="cb152-8"><a href="#cb152-8"></a><span class="st">-w /etc/hosts -p wa -k system-locale</span></span>
<span id="cb152-9"><a href="#cb152-9"></a><span class="st">-w /etc/sysconfig/network -p wa -k system-locale</span></span>
<span id="cb152-10"><a href="#cb152-10"></a><span class="st">-w /etc/sysconfig/network-scripts -p wa -k system-locale</span></span>
<span id="cb152-11"><a href="#cb152-11"></a><span class="op">EOF</span></span>
<span id="cb152-12"><a href="#cb152-12"></a><span class="co"># Fin: HARDE-RHEL-230</span></span></code></pre></div>
<h3 id="méthode-daudit-150">Méthode d’audit</h3>
<h2 id="harde-rhel-231-tracer-les-changements-de-permission">HARDE-RHEL-231 : Tracer les changements de permission</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.1.9</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.5 Implement Automated Configuration Monitoring Systems</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-145">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-231 :</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb153-1"><a href="#cb153-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-231 : Tracer les changements de permission&quot;</span></span>
<span id="cb153-2"><a href="#cb153-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/90perm_mod.rules <span class="op">&lt;&lt;EOF</span></span>
<span id="cb153-3"><a href="#cb153-3"></a><span class="st">-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</span></span>
<span id="cb153-4"><a href="#cb153-4"></a><span class="st">-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</span></span>
<span id="cb153-5"><a href="#cb153-5"></a><span class="st">-a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</span></span>
<span id="cb153-6"><a href="#cb153-6"></a><span class="st">-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</span></span>
<span id="cb153-7"><a href="#cb153-7"></a><span class="st">-a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</span></span>
<span id="cb153-8"><a href="#cb153-8"></a><span class="st">-a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</span></span>
<span id="cb153-9"><a href="#cb153-9"></a><span class="op">EOF</span></span>
<span id="cb153-10"><a href="#cb153-10"></a><span class="co"># Fin: HARDE-RHEL-231</span></span></code></pre></div>
<h3 id="méthode-daudit-151">Méthode d’audit</h3>
<h2 id="harde-rhel-232-installer-le-service-rsyslog">HARDE-RHEL-232 : Installer le service rsyslog</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.2.1.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R43</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-146">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-232 :</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb154-1"><a href="#cb154-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-232 : Installer le service rsyslog&quot;</span></span>
<span id="cb154-2"><a href="#cb154-2"></a><span class="ex">dnf</span> install rsyslog</span>
<span id="cb154-3"><a href="#cb154-3"></a><span class="co"># Fin: HARDE-RHEL-232</span></span></code></pre></div>
<h3 id="méthode-daudit-152">Méthode d’audit</h3>
<h2 id="harde-rhel-233-activer-le-service-syslog">HARDE-RHEL-233 : Activer le service syslog</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.2.1.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R43</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-147">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-233 :</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb155-1"><a href="#cb155-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-233 : Activer le service syslog&quot;</span></span>
<span id="cb155-2"><a href="#cb155-2"></a><span class="ex">systemctl</span> <span class="at">--now</span> enable rsyslog</span>
<span id="cb155-3"><a href="#cb155-3"></a><span class="co"># Fin: HARDE-RHEL-233</span></span></code></pre></div>
<h3 id="méthode-daudit-153">Méthode d’audit</h3>
<h2 id="harde-rhel-234-configurer-les-permissions-des-fichiers-journaux">HARDE-RHEL-234 : Configurer les permissions des fichiers journaux</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.2.1.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R43</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-148">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-234 :</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb156-1"><a href="#cb156-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-234 : Configurer les permissions des fichiers journaux&quot;</span></span>
<span id="cb156-2"><a href="#cb156-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/rsyslog.d/10FileCreate.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb156-3"><a href="#cb156-3"></a><span class="dt">\$</span><span class="st">FileCreateMode 0640</span></span>
<span id="cb156-4"><a href="#cb156-4"></a><span class="op">EOF</span></span>
<span id="cb156-5"><a href="#cb156-5"></a><span class="co"># Fin: HARDE-RHEL-234</span></span></code></pre></div>
<h3 id="méthode-daudit-154">Méthode d’audit</h3>
<h2 id="harde-rhel-235-définir-les-fichiers-journaux">HARDE-RHEL-235 : Définir les fichiers journaux</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.2.1.4</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R43</td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-149">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-235 :</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb157-1"><a href="#cb157-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-235 : Définir les fichiers journaux&quot;</span></span>
<span id="cb157-2"><a href="#cb157-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/rsyslog.d/files.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb157-3"><a href="#cb157-3"></a><span class="st"># Everybody gets emergency messages</span></span>
<span id="cb157-4"><a href="#cb157-4"></a><span class="st">*.emerg         :omusrmsg:*</span></span>
<span id="cb157-5"><a href="#cb157-5"></a><span class="st"># The authpriv file has restricted access.</span></span>
<span id="cb157-6"><a href="#cb157-6"></a><span class="st">auth,authpriv.*     /var/log/secure</span></span>
<span id="cb157-7"><a href="#cb157-7"></a><span class="st"># Log cron stuff</span></span>
<span id="cb157-8"><a href="#cb157-8"></a><span class="st">cron.*          /var/log/cron</span></span>
<span id="cb157-9"><a href="#cb157-9"></a><span class="st">mail.*          -/var/log/mail</span></span>
<span id="cb157-10"><a href="#cb157-10"></a><span class="st">mail.info       -/var/log/mail.info</span></span>
<span id="cb157-11"><a href="#cb157-11"></a><span class="st">mail.warning        -/var/log/mail.warn</span></span>
<span id="cb157-12"><a href="#cb157-12"></a><span class="st">mail.err        /var/log/mail.err</span></span>
<span id="cb157-13"><a href="#cb157-13"></a><span class="st">news.crit       -/var/log/news/news.crit</span></span>
<span id="cb157-14"><a href="#cb157-14"></a><span class="st">news.err        -/var/log/news/news.err</span></span>
<span id="cb157-15"><a href="#cb157-15"></a><span class="st">news.notice         -/var/log/news/news.notice</span></span>
<span id="cb157-16"><a href="#cb157-16"></a><span class="st">*.=warning;*.=err   -/var/log/warn</span></span>
<span id="cb157-17"><a href="#cb157-17"></a><span class="st">*.crit          /var/log/warn</span></span>
<span id="cb157-18"><a href="#cb157-18"></a><span class="st"># Log anything (except mail) of level info or higher.</span></span>
<span id="cb157-19"><a href="#cb157-19"></a><span class="st"># Don&#39;t log private authentication messages!</span></span>
<span id="cb157-20"><a href="#cb157-20"></a><span class="st">*.info;mail.none;authpriv.none;cron.none    -/var/log/messages</span></span>
<span id="cb157-21"><a href="#cb157-21"></a><span class="st">local0.*,local1.*   -/var/log/localmessages</span></span>
<span id="cb157-22"><a href="#cb157-22"></a><span class="st">local2.*,local3.*   -/var/log/localmessages</span></span>
<span id="cb157-23"><a href="#cb157-23"></a><span class="st">local4.*,local5.*   -/var/log/localmessages</span></span>
<span id="cb157-24"><a href="#cb157-24"></a><span class="st">local6.*        -/var/log/localmessages</span></span>
<span id="cb157-25"><a href="#cb157-25"></a><span class="st">local7.*        /var/log/boot.log</span></span>
<span id="cb157-26"><a href="#cb157-26"></a><span class="st"># Save news errors of level crit and higher in a special file.</span></span>
<span id="cb157-27"><a href="#cb157-27"></a><span class="st">uucp,news.crit      /var/log/spooler</span></span>
<span id="cb157-28"><a href="#cb157-28"></a><span class="op">EOF</span></span>
<span id="cb157-29"><a href="#cb157-29"></a><span class="co"># Fin: HARDE-RHEL-235</span></span></code></pre></div>
<h3 id="méthode-daudit-155">Méthode d’audit</h3>
<h2 id="harde-rhel-236-renvoyer-les-journaux-vers-un-hôte-distant">HARDE-RHEL-236 : Renvoyer les journaux vers un hôte distant</h2>
<p>Lancer les commandes suivantes en remplaçant $SYSLOGSERVER par le nom ou l’adresse du puits de logs:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.2.1.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.6 Deploy SIEM or Log Analytic tool<br>06.8 Regularly Tune SIEM</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-150">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-236 :</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb158-1"><a href="#cb158-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-236 : Renvoyer les journaux vers un hôte distant&quot;</span></span>
<span id="cb158-2"><a href="#cb158-2"></a><span class="co"># ask for the syslog server</span></span>
<span id="cb158-3"><a href="#cb158-3"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="st">&quot;Merci de préciser l&#39;adresse ou le nom du serveur SYSLOG distant :&quot;</span></span>
<span id="cb158-4"><a href="#cb158-4"></a><span class="bu">read</span> <span class="at">-e</span> <span class="at">-i</span> <span class="st">&#39;127.0.0.1&#39;</span> <span class="at">-r</span> <span class="va">SYSLOGSERVER</span></span>
<span id="cb158-5"><a href="#cb158-5"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/rsyslog.d/loghost.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb158-6"><a href="#cb158-6"></a><span class="st"># TCP version *.*     @@</span><span class="va">$SYSLOGSERVER</span><span class="st">:514</span></span>
<span id="cb158-7"><a href="#cb158-7"></a><span class="st">*.*     @</span><span class="va">$SYSLOGSERVER</span><span class="st">:514</span></span>
<span id="cb158-8"><a href="#cb158-8"></a><span class="op">EOF</span></span>
<span id="cb158-9"><a href="#cb158-9"></a><span class="co"># Fin: HARDE-RHEL-236</span></span></code></pre></div>
<h3 id="méthode-daudit-156">Méthode d’audit</h3>
<h2 id="harde-rhel-237-sassurer-que-seuls-les-puits-de-logs-peuvent-recevoir-des-logs">HARDE-RHEL-237 : S’assurer que seuls les puits de logs peuvent recevoir des logs</h2>
<p>Dans le projet, aucune machine Red Hat n’est configurée en puits de logs et RHEL 8 n’est pas configuré par défaut pour accepter les logs depuis une machine distante.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Ne pas implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.2.1.6</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">09.2 Ensure Only Approved Ports, Protocols and Services Are Running</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-85">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-238-sassurer-que-journald-est-redirigé-vers-rsyslog">HARDE-RHEL-238 : S’assurer que journald est redirigé vers rsyslog</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.2.2.1</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.5 Central Log Management</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-151">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-238 :</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb159-1"><a href="#cb159-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-238 : S&#39;assurer que journald est redirigé vers rsyslog&quot;</span></span>
<span id="cb159-2"><a href="#cb159-2"></a><span class="ex">systemctl</span> stop systemd-journald</span>
<span id="cb159-3"><a href="#cb159-3"></a><span class="ex">systemctl</span> disable systemd-journald</span>
<span id="cb159-4"><a href="#cb159-4"></a><span class="fu">mkdir</span> <span class="at">-p</span> /etc/systemd/journald.conf.d/</span>
<span id="cb159-5"><a href="#cb159-5"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/journald.conf.d/00-forwardsyslog.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb159-6"><a href="#cb159-6"></a><span class="st">[Journal]</span></span>
<span id="cb159-7"><a href="#cb159-7"></a><span class="st">ForwardToSyslog=yes</span></span>
<span id="cb159-8"><a href="#cb159-8"></a><span class="op">EOF</span></span>
<span id="cb159-9"><a href="#cb159-9"></a><span class="co"># Fin: HARDE-RHEL-238</span></span></code></pre></div>
<h3 id="méthode-daudit-157">Méthode d’audit</h3>
<h2 id="harde-rhel-239-sassurer-que-journald-compresse-les-journaux-de-grande-taille">HARDE-RHEL-239 : S’assurer que journald compresse les journaux de grande taille</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.2.2.2</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.4 Ensure adequate storage for logs</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-152">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-239 :</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb160-1"><a href="#cb160-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-239 : S&#39;assurer que journald compresse les journaux de grande taille&quot;</span></span>
<span id="cb160-2"><a href="#cb160-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/journald.conf.d/10-compress.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb160-3"><a href="#cb160-3"></a><span class="st">[Journal]</span></span>
<span id="cb160-4"><a href="#cb160-4"></a><span class="st">Compress=yes</span></span>
<span id="cb160-5"><a href="#cb160-5"></a><span class="op">EOF</span></span>
<span id="cb160-6"><a href="#cb160-6"></a><span class="co"># Fin: HARDE-RHEL-239</span></span></code></pre></div>
<h3 id="méthode-daudit-158">Méthode d’audit</h3>
<h2 id="harde-rhel-240-sassurer-que-journald-écrit-les-journaux-sur-disque">HARDE-RHEL-240 : S’assurer que journald écrit les journaux sur disque</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.2.2.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-153">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-240 :</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb161-1"><a href="#cb161-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-240 : S&#39;assurer que journald écrit les journaux sur disque&quot;</span></span>
<span id="cb161-2"><a href="#cb161-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/journald.conf.d/20-persistent.conf <span class="op">&lt;&lt;EOF</span></span>
<span id="cb161-3"><a href="#cb161-3"></a><span class="st">[Journal]</span></span>
<span id="cb161-4"><a href="#cb161-4"></a><span class="st">Storage=persistent</span></span>
<span id="cb161-5"><a href="#cb161-5"></a><span class="op">EOF</span></span>
<span id="cb161-6"><a href="#cb161-6"></a><span class="co"># Fin: HARDE-RHEL-240</span></span></code></pre></div>
<h3 id="méthode-daudit-159">Méthode d’audit</h3>
<h2 id="harde-rhel-241-sassurer-de-la-permission-des-fichiers-journaux">HARDE-RHEL-241 : S’assurer de la permission des fichiers journaux</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.2.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">05.1 Establish Secure Configurations</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-154">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-241 :</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb162-1"><a href="#cb162-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb162-2"><a href="#cb162-2"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-241 : S&#39;assurer de la permission des fichiers journaux&quot;</span></span>
<span id="cb162-3"><a href="#cb162-3"></a><span class="co"># this is a one time solution since systemd resets permissions on reboot</span></span>
<span id="cb162-4"><a href="#cb162-4"></a><span class="co">#   find /var/log -type f -exec chmod g-wx,o-rwx &quot;{}&quot; + -o -type d -exec chmod g-w,o-rwx &quot;{}&quot; &quot;;&quot;</span></span>
<span id="cb162-5"><a href="#cb162-5"></a><span class="co"># systemd way:</span></span>
<span id="cb162-6"><a href="#cb162-6"></a><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s,d /var/log 0755,d /var/log 0751,&#39;</span> <span class="at">-i</span> /usr/lib/tmpfiles.d/var.conf</span>
<span id="cb162-7"><a href="#cb162-7"></a><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s,f /var/log/wtmp 0664,f /var/log/wtmp 0640,&#39;</span> <span class="at">-i</span> /usr/lib/tmpfiles.d/var.conf</span>
<span id="cb162-8"><a href="#cb162-8"></a><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s,f /var/log/lastlog 0664,f /var/log/lastlog 0640,&#39;</span> <span class="at">-i</span> /usr/lib/tmpfiles.d/var.conf</span>
<span id="cb162-9"><a href="#cb162-9"></a><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s,f /var/log/btmp 0660,f /var/log/btmp 0640,&#39;</span> <span class="at">-i</span> /usr/lib/tmpfiles.d/var.conf</span>
<span id="cb162-10"><a href="#cb162-10"></a><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s,z /var/log/journal 2755,z /var/log/journal 2750,&#39;</span> <span class="at">-i</span> /usr/lib/tmpfiles.d/systemd.conf</span>
<span id="cb162-11"><a href="#cb162-11"></a><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s,z /var/log/journal/%m 2755,z /var/log/journal/%m 2750,&#39;</span> <span class="at">-i</span> /usr/lib/tmpfiles.d/systemd.conf</span>
<span id="cb162-12"><a href="#cb162-12"></a><span class="co"># Fin: HARDE-RHEL-241</span></span></code></pre></div>
<h3 id="méthode-daudit-160">Méthode d’audit</h3>
<h2 id="harde-rhel-242-sassurer-que-logrotate-est-configuré">HARDE-RHEL-242 : S’assurer que logrotate est configuré</h2>
<p>Revoir la configuration dans /etc/logrotate.conf et /etc/logrotate.d/*</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 4.3</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.4 Ensure adequate storage for logs</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-155">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-242 :</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb163-1"><a href="#cb163-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-242 : S&#39;assurer que logrotate est configuré&quot;</span></span>
<span id="cb163-2"><a href="#cb163-2"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/logrotate.d/wtmp <span class="op">&lt;&lt;EOF</span></span>
<span id="cb163-3"><a href="#cb163-3"></a><span class="st"># no packages own wtmp -- we&#39;ll rotate it here</span></span>
<span id="cb163-4"><a href="#cb163-4"></a><span class="st">/var/log/wtmp {</span></span>
<span id="cb163-5"><a href="#cb163-5"></a><span class="st">    missingok</span></span>
<span id="cb163-6"><a href="#cb163-6"></a><span class="st">    monthly</span></span>
<span id="cb163-7"><a href="#cb163-7"></a><span class="st">    create 0600 root utmp</span></span>
<span id="cb163-8"><a href="#cb163-8"></a><span class="st">    minsize 1M</span></span>
<span id="cb163-9"><a href="#cb163-9"></a><span class="st">    rotate 12</span></span>
<span id="cb163-10"><a href="#cb163-10"></a><span class="st">}</span></span>
<span id="cb163-11"><a href="#cb163-11"></a><span class="op">EOF</span></span>
<span id="cb163-12"><a href="#cb163-12"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/logrotate.d/lastlog <span class="op">&lt;&lt;EOF</span></span>
<span id="cb163-13"><a href="#cb163-13"></a><span class="st"># no packages own lastlog -- we&#39;ll rotate it here</span></span>
<span id="cb163-14"><a href="#cb163-14"></a><span class="st">/var/log/lastlog {</span></span>
<span id="cb163-15"><a href="#cb163-15"></a><span class="st">    missingok</span></span>
<span id="cb163-16"><a href="#cb163-16"></a><span class="st">    monthly</span></span>
<span id="cb163-17"><a href="#cb163-17"></a><span class="st">    create 0600 root utmp</span></span>
<span id="cb163-18"><a href="#cb163-18"></a><span class="st">    minsize 1M</span></span>
<span id="cb163-19"><a href="#cb163-19"></a><span class="st">    rotate 12</span></span>
<span id="cb163-20"><a href="#cb163-20"></a><span class="st">}</span></span>
<span id="cb163-21"><a href="#cb163-21"></a><span class="op">EOF</span></span>
<span id="cb163-22"><a href="#cb163-22"></a><span class="fu">cat</span> <span class="op">&gt;</span>/etc/logrotate.d/btmp <span class="op">&lt;&lt;EOF</span></span>
<span id="cb163-23"><a href="#cb163-23"></a><span class="st"># no packages own btmp -- we&#39;ll rotate it here</span></span>
<span id="cb163-24"><a href="#cb163-24"></a><span class="st">/var/log/btmp {</span></span>
<span id="cb163-25"><a href="#cb163-25"></a><span class="st">    missingok</span></span>
<span id="cb163-26"><a href="#cb163-26"></a><span class="st">    monthly</span></span>
<span id="cb163-27"><a href="#cb163-27"></a><span class="st">    create 0600 root utmp</span></span>
<span id="cb163-28"><a href="#cb163-28"></a><span class="st">    rotate 12</span></span>
<span id="cb163-29"><a href="#cb163-29"></a><span class="st">}</span></span>
<span id="cb163-30"><a href="#cb163-30"></a><span class="op">EOF</span></span>
<span id="cb163-31"><a href="#cb163-31"></a><span class="co"># Fin: HARDE-RHEL-242</span></span></code></pre></div>
<h3 id="méthode-daudit-161">Méthode d’audit</h3>
<h2 id="harde-rhel-243-sassurer-que-le-paramètre-ssh-loglevel-est-approprié">HARDE-RHEL-243 : S’assurer que le paramètre SSH LogLevel est approprié</h2>
<p>Lancer les commandes suivantes :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;">RHEL 8 5.2.5</td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;">06.2 Activate audit logging<br>06.3 Enable Detailed Logging</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="méthode-à-suivre-156">Méthode à suivre</h3>
<p>Pour implémenter cette règle, utiliser le script fourni, dont voici un extrait du code source concernant HARDE-RHEL-243 :</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash"><span id="cb164-1"><a href="#cb164-1"></a><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-243 : S&#39;assurer que le paramètre SSH LogLevel est approprié&quot;</span></span>
<span id="cb164-2"><a href="#cb164-2"></a><span class="cf">if</span> <span class="ot">! </span><span class="fu">grep</span> <span class="at">-q</span> <span class="at">-E</span> <span class="st">&#39;^LogLevel\s+(VERBOSE|INFO)&#39;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">then</span> <span class="bu">echo</span> <span class="st">&quot;LogLevel VERBOSE&quot;</span> <span class="op">&gt;&gt;</span>/etc/ssh/sshd_config<span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb164-3"><a href="#cb164-3"></a><span class="co"># Fin: HARDE-RHEL-243</span></span></code></pre></div>
<h3 id="méthode-daudit-162">Méthode d’audit</h3>
<h2 id="harde-rhel-244-durcissement-et-configuration-du-service-syslog">HARDE-RHEL-244 : Durcissement et configuration du service syslog</h2>
<p>La configuration du service doit être réalisée suivant les Recommandations de sécurité pour la mise en œuvre d’un système de journalisation accessible sur le site de l’ANSSI.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R43</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-86">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-245-cloisonnement-du-service-syslog-par-chroot">HARDE-RHEL-245 : Cloisonnement du service syslog par chroot</h2>
<p>rsyslog ne permet pas nativement la fonction chroot.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Ne pas implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R44</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-87">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-246-cloisonnement-du-service-syslog-par-conteneur">HARDE-RHEL-246 : Cloisonnement du service syslog par conteneur</h2>
<p>Pas de technologie de containerisation prévue.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Ne pas implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R45</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-88">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<h2 id="harde-rhel-247-journaux-dactivité-de-service">HARDE-RHEL-247 : Journaux d’activité de service</h2>
<p>S’assurer d’avoir un journal dédié par service</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">À implémenter</th>
<th style="text-align: left;"></th>
<th style="text-align: right;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><em>Niveau</em></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>Référence</em> <a href="https://www.cisecurity.org/benchmark/red_hat_linux/" title="Securing Red Hat Linux 8">CIS</a></td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><em>Contrôle</em></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: left;"><a href="https://www.ssi.gouv.fr/entreprise/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/" title="Recommandations de configuration d’un système GNU/Linux - v1.2">ANSSI</a></td>
<td style="text-align: right;"></td>
<td style="text-align: left;">R46</td>
</tr>
</tbody>
</table>
<h3 id="méthode-dimplémentation-89">Méthode d’implémentation</h3>
<p>À déterminer ### Méthode d’audit</p>
<div style=""></div>
<h1 id="utilisation-du-système">UTILISATION DU SYSTÈME</h1>
<h2 id="ajouter-un-utilisateur">Ajouter un utilisateur</h2>
<p>La commande useradd permet de créer un utilisateur :</p>
<p><code>useradd robert</code></p>
<p>La commande passwd permet de définir/changer son mot de passe :</p>
<p><code>passwd robert</code></p>
<p>À noter que l’utilisateur est créé par défaut avec le role SELinux user_u.</p>
<h2 id="supprimer-un-utilisateur">Supprimer un utilisateur</h2>
<p>La commande userdel permet de supprimer un utilisateur du système (l’option <code>-r</code> permet de supprimer son répertoire d’accueil).</p>
<p>Par exemple :</p>
<p><code>userdel -r -Z untel</code></p>
<h2 id="ajouter-un-administrateur">Ajouter un administrateur</h2>
<p>Il faut créer un utilisateur selon le paragraphe précédent puis lui donner des droits via la commande suivante :</p>
<p><code>usermod -G sudogrp -Z staff_u durand</code></p>
<p>☛ Si l’ordinateur est connecté à un annuaire LDAP/AD, les administrateurs doivent être obligatoirement ajoutés à ce groupe pour pouvoir exécuter <code>sudo</code>.</p>
<h2 id="supprimer-un-administrateur">Supprimer un administrateur</h2>
<p>Un administrateur peut être supprimé comme un utilisateur (via la commande <code>userdel</code>). S’il s’agit de supprimer son accès administrateur seulement, il faut lancer les commandes suivantes :</p>
<p><code>semanage login --delete durand</code></p>
<p><code>gpasswd -d durand sudogrp</code></p>
<h2 id="ajouter-un-service">Ajouter un service</h2>
<p>Il est possible de rajouter des services en portant une attention particulière à SELinux et firewalld. SELinux peut empêcher un processus d’envoyer un email ou de se comporter en serveur HTTP. Par exemple, après avoir installé un serveur Apache, la commande suivante est nécessaire :</p>
<p><code>setsebool -P httpd_can_network_connect 1</code></p>
<p>D’autre part, il faut également ouvrir le port grâce à firewalld, par exemple, pour un serveur Apache :</p>
<p><code>firewall-cmd --permanent --zone=public --add-service=http</code></p>
<p>Évidemment, les options à activer dépendent du service, et une description complète déborde du cadre de ce guide.</p>
<h2 id="se-connecter-en-root">Se connecter en root</h2>
<p>Il n’est possible de se connecter en root que sur une console « physique » c’est-à-dire les consoles (tty de 1 à 6) disponibles sur l’écran/clavier connectés directement à l’ordinateur. Pour les autres connexions, il faut passer par <code>sudo</code> (via <code>sudo -i</code>).</p>
<h2 id="monter-une-partition">Monter une partition</h2>
<p>À cause de l’utilisation de pam_namespace, il est recommandé de modifier /etc/fstab (puis redémarrer) pour tous les points de montage destinés à être « permanents » ou visibles de tous les utilisateurs. Utiliser mount dans une session sudo ne rendra ce point de montage visible que dans la session courante (et sera donc invisible des autres utilisateurs).</p>
<p>D’autre part, la sécurisation par défaut empêche le chargement de modules noyaux, ce qui bloque donc l’utilisation de clés USB ou de CD/DVD (même sous la forme de fichiers ISO). Il faudra donc dans ces cas-là autoriser temporairement le chargement de modules noyaux :</p>
<h3 id="images-iso-physiques-ou-virtuelles">Images ISO (physiques ou virtuelles)</h3>
<p>Suivant le format, les images ISO requièrent le module iso9660 ou udf. Ceux-ci n’étant pas chargés par défaut, il faut donc passer en mode de maintenance pour autoriser le chargement des modules.</p>
<p>Pour se faire, lancer la commande suivante :</p>
<p><code>sudo /etc/maintenance_mode.sh</code></p>
<p>Le script vous demande de redémarrer. Une fois le système à nouveau accessible, il devient possible d’utiliser de monter des images ISO.</p>
<h3 id="clés-usb">Clés USB</h3>
<p>Là encore, il n’est pas possible d’utiliser de clés USB en mode normal et il faut donc passer en mode de maintenance.</p>
<p>Pour se faire, lancer la commande suivante :</p>
<p><code>sudo /etc/maintenance_mode.sh</code></p>
<p>Le script vous demande de redémarrer. Une fois le système à nouveau accessible, il devient possible d’utiliser des clés USB.</p>
<h3 id="accéder-à-la-partition-boot">Accéder à la partition /boot</h3>
<p>Avant d’appliquer une mise à jour, il faut monter /boot et /boot/efi (souvent nécessaire lors des mises à jour) : il faut donc autoriser le chargement des modules:</p>
<p><code>sudo /etc/maintenance_mode.sh</code></p>
<p>Puis redémarrer. Ensuite monter le système de fichier :</p>
<p><code>mount /boot &amp;&amp; mount /boot/efi</code></p>
<p>Une fois la mise à jour faite, redémarrer pour revenir en situation normale.</p>
<h2 id="diagnostic-selinux">Diagnostic SELinux</h2>
<p>La commande ausearch permet de repérer les évènements liés à un blocage par SELinux.</p>
<p>Cette commande est très puissante et décrire l’ensemble des options possibles dépasse du cadre de ce guide. Pour plus d’information, nous renvoyons vers ce site : <a href="https://wiki.centos.org/HowTos/SELinux" class="uri">https://wiki.centos.org/HowTos/SELinux</a>.</p>
<p>À titre d’exemple, la commande suivante est lancée et nous reporte un évènement « bloqué » :</p>
<p><code>ausearch -m AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR -i</code></p>
<p>Résultat :</p>
<pre class="text"><code>type=PROCTITLE msg=audit(12/09/2020 07:18:11.625:4768) : proctitle=ausearch -m AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR -i
type=PATH msg=audit(12/09/2020 07:18:11.625:4768) : item=0 name=/var/log/audit/audit.log nametype=UNKNOWN cap_fp=none cap_fi=none cap_fe=0 cap_fver=0
type=CWD msg=audit(12/09/2020 07:18:11.625:4768) : cwd=/root
type=SYSCALL msg=audit(12/09/2020 07:18:11.625:4768) : arch=x86_64 syscall=openat success=no exit=EACCES(Permission non accordée) a0=0xffffff9c a1=0x55fd00b078f0 a2=O_RDONLY a3=0x0 items=1 ppid=6470 pid=6489 auid=blanchet uid=root gid=root euid=root suid=root fsuid=root egid=root sgid=root fsgid=root tty=pts1 ses=22 comm=ausearch exe=/usr/sbin/ausearch subj=staff_u:staff_r:staff_t:s0-s0:c0.c1023 key=access
type=AVC msg=audit(12/09/2020 07:18:11.625:4768) : avc:  denied  { search } for  pid=6489 comm=ausearch name=/ dev=&quot;dm-4&quot; ino=128 scontext=staff_u:staff_r:staff_t:s0-s0:c0.c1023 tcontext=system_u:object_r:auditd_log_t:s0 tclass=dir permissive=0</code></pre>
<p>Il s’agit d’un utilisateur n’ayant pas pu exécuter la commande ausearch. La commande <code>audit2why</code> permet de comprendre la raison du blocage :</p>
<pre class="text"><code>grep &#39;625:4768&#39; /var/log/audit/audit.log | audit2why
type=AVC msg=audit(1599887891.625:4768): avc:  denied  { search } for  pid=6489 comm=&quot;ausearch&quot; name=&quot;/&quot; dev=&quot;dm-4&quot; ino=128 scontext=staff_u:staff_r:staff_t:s0-s0:c0.c1023 tcontext=system_u:object_r:auditd_log_t:s0 tclass=dir permissive=0

        Was caused by:
                Missing type enforcement (TE) allow rule.

                You can use audit2allow to generate a loadable module to allow this access.</code></pre>
<p>Une solution peut être de rajouter une permission à la politique SELinux via une nouvelle règle. La commande audit2allow permet de la générer :</p>
<pre class="text"><code>grep &#39;625:4768&#39; /var/log/audit/audit.log | audit2allow _M ausearch


#============= staff_t ==============
allow staff_t auditd_log_t:dir search;</code></pre>
<p>Il faut alors lancer les commandes suivantes pour les charger :</p>
<p><code>semodule -i ausearch.pp</code></p>
<p><code>checkmodule -m -M sudolog.te -o ausearch.mod</code></p>
<p>Il peut être plus simple de passer en mode <em>permissive</em> pour établir l’ensemble des règles nécessaires au bon fonctionnement d’un service ou tester si ce sont les règles SELinux qui empêchent le bon fonctionnement d’un service. Ceci doit être réalisé dans un environnement de développement sécurisé. En mode <em>permissive</em>, seuls les logs sont générés et peuvent donc être manipulés par <code>ausearch</code>, <code>audit2why</code> et <code>audit2allow</code>.</p>
<h2 id="agrandir-une-partition">Agrandir une partition</h2>
<p>Il suffit d’utiliser les outils classiques de LVM pour rajouter des disques ou étendre des partitions.</p>
<h2 id="modifier-le-mot-de-passe-de-démarrage">Modifier le mot de passe de démarrage</h2>
<p>Le mot de passe de démarrage qui protège les paramètres de «boot» est stocké dans le répertoire /boot. Pour pouvoir le modifier, il faut donc d’abord suivre la procédure de passage en mode «maintenance». Une fois la partition accessible, lancer :</p>
<p><code>grub2-setpassword -o /boot/grub2</code></p>
<p>Et ensuite :</p>
<p><code>cp /boot/grub2/user.cfg /boot/efi/EFI/redhat/</code></p>
<h2 id="modifier-le-serveur-syslog-distant">Modifier le serveur SYSLOG distant</h2>
<p>Il faut modifier le fichier /etc/rsyslog.d/loghost.conf</p>
<h2 id="modifier-la-source-de-référence-de-temps">Modifier la source de référence de temps</h2>
<p>Il faut modifier le fichier /etc/chrony.conf et remplacer la directive par défaut débutant par <code>pool x.rhel.pool.ntp.org …</code> par <code>server *adresse IP ou nom*</code>, puis relancer chrony.</p>
<h2 id="joindre-un-domaine-windows">Joindre un domaine Windows</h2>
<p>Lancer la commande suivante pour joindre un domaine, remplacer domain.com par le domaine cible, user1 par le nom d’administrateur et SERVERS pour l’OU destination :</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> realm join domain.com <span class="at">-U</span> <span class="st">&#39;user1&#39;</span> <span class="at">--computer-ou</span><span class="op">=</span>OU=SERVERS <span class="at">--os-name</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">uname</span> <span class="at">-o</span><span class="va">)</span><span class="st">&quot;</span> <span class="at">--os-version</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">uname</span> <span class="at">-rsv</span><span class="va">)</span><span class="st">&quot;</span> <span class="at">--install</span><span class="op">=</span><span class="st">&#39;/&#39;</span> <span class="at">--verbose</span></span></code></pre></div>
<p>Pour restreindre la connexion à un certain groupe/OU seulement (ici SUDOERS), lancer :</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> realm deny <span class="at">-R</span> domain.com <span class="at">-a</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> realm permit <span class="at">-R</span> domain.com <span class="at">-g</span> SUDOERS</span></code></pre></div>
<p>Si en plus les utilisateurs de ce groupe doivent avoir accès à sudo, il faut les rajouter un à un au groupe sudogrp via :</p>
<p><code>usermod -G sudogrp -Z staff_u durand</code></p>
            </div>
        </div>
                <script src="https://vjs.zencdn.net/7.15.4/video.min.js"></script>
    </div>
</body>

</html>