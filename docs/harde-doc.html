<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>HARDEning RHEL</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header>
<h1 class="title">HARDEning RHEL</h1>
</header>
<h1 id="harde--sécurisation-dun-système-red-hat-8x">HARDE : SÉCURISATION D'UN SYSTÈME RED HAT 8.x</h1>
<p>0.1. <a href="#sécurisation">Sécurisation</a><br />
0.2. <a href="#installationdusysteme">INSTALLATION DU SYSTEME</a><br />
0.3. <a href="#securisation">SECURISATION</a><br />
0.4. <a href="#documentsàétablir">Documents à établir</a><br />
0.5. <a href="#audit-1">AUDIT</a><br />
0.6. <a href="#cataloguedesreglesdesecurisation">CATALOGUE DES REGLES DE SECURISATION</a><br />
0.7. <a href="#harde-rhel-001:minimisationdesservicesinstallés">HARDE-RHEL-001 : Minimisation des services installés</a><br />
1. <a href="#=============staff_t==============">============= staff_t ==============</a></p>
<p><a name="sécurisation"></a></p>
<h2 id="01-sécurisation">0.1. Sécurisation</h2>
<h3 id="installation">Installation</h3>
<p>Certains des paramètres de sécurisation sont uniquement ou plus facilement sélectionnables lors de l’installation. Ce sont, en particulier, la répartition des partitions et la sélection initiale de logiciels à installer. Ce guide décrit la procédure d’installation à suivre pour un Red Hat Linux Entreprise 8.1, 8.2 ou 8.3. Si ce guide n’a pas été suivi dès l’installation du système, il sera compliqué voire très fastidieux de mettre en place l’ensemble des règles définies dans ce guide. L’installation du système est décrite au chapitre 3, page 6. La documentation Red Hat est disponible sur le site : <a href="https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index" class="uri">https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/8/html-single/performing_a_standard_rhel_installation/index</a> Pour rappel, pendant l’installation et avant l’installation des correctifs de sécurité, l’ordinateur est potentiellement vulnérable et doit donc être déconnecté ou au pire connecté à un réseau maitrisé.</p>
<h3 id="application-automatique">Application automatique</h3>
<p>Quand cela est possible, les règles de sécurisation ont été traduites dans un script qui permet d’appliquer les paramètres demandés sans interaction de l’utilisateur.</p>
<h3 id="opérations-manuelles">Opérations manuelles</h3>
<p>Un certain nombre d’opérations (trop complexes ou dépendantes du réseau d’installation) sont à réaliser manuellement, et sont décrites dans le chapitre 4.2.</p>
<h3 id="audit">Audit</h3>
<p>L’audit permet de s’assurer que le système est correctement configuré. Il est à réaliser à intervalles réguliers pour s’assurer qu’il n’y a pas de déviations ou de dérive du système. En particulier, les mises à jour du système peuvent modifier des permissions sur le système de fichiers. L’audit est décrit au chapitre 5, page 12.</p>
<p><a name="installationdusysteme"></a></p>
<h2 id="02-installation-du-systeme">0.2. INSTALLATION DU SYSTEME</h2>
<h3 id="sur-une-machine-virtuelle">Sur une machine virtuelle</h3>
<p>Il est conseillé de s’assurer que le matériel virtualisé soit réduit au minimum : par exemple pas de carte son, pas de port série … pour limiter la surface d’attaque. Le disque dur alloué doit être au minimum de 48 Go</p>
<h3 id="depuis-une-image-iso">Depuis une image ISO</h3>
<p>Démarrer le système depuis l’image ISO, puis dès que l’installateur graphique est démarré, sélectionner France, Français(France) comme paramètres linguistiques. S’assurer que le clavier est positionné à fr(oss) après avoir cliqué sur Continuer.</p>
<p>Depuis l’écran Résumé de l’installation, positionner la Sélection Logiciel à « Installation minimale » :</p>
<p><img src="file:///./images/2020-09-11%2010_46_32-Window.png" title="Installation Mininale" alt="Copie d&#39;écran : Sélection Logiciel1" /></p>
<p>![Copie d'écran : Sélection Logiciel2](./images/2020-09-11 10_46_32-Window.png)</p>
<p>![Copie d'écran : Sélection Logiciel3](.\images\2020-09-11 10_46_32-Window.png)</p>
<p>Depuis l’écran Résumé de l’installation, positionner le paramètre KDUMP à désactivé :</p>
<p>Depuis l’écran Résumé de l’installation, cliquer sur « Nom du réseau &amp;…» pour activer la carte réseau et modifier les différents paramètres réseau (dont le nom DNS).</p>
<p>Depuis l’écran principal, régler l’heure &amp; date pour pointer vers le fuseau horaire cible et si disponible, définir une ou plusieurs sources NTP fiables. Depuis l’écran Résumé de l’installation, pour le partitionnement du disque dur, choisissez ‘Personnalisé’ (cliquer sur Fait) puis garder les options par défaut pour le disque (LVM) et cliquer sur + pour créer les partitions suivantes :</p>
<table>
<thead>
<tr class="header">
<th>Point de montage</th>
<th>Taille Minimum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>/</td>
<td>4 Gio</td>
</tr>
<tr class="even">
<td>/boot</td>
<td>1 Gio</td>
</tr>
<tr class="odd">
<td>/boot/efi</td>
<td>512 Mio</td>
</tr>
<tr class="even">
<td>/usr</td>
<td>12 Gio</td>
</tr>
<tr class="odd">
<td>/tmp</td>
<td>1 Gio</td>
</tr>
<tr class="even">
<td>/home</td>
<td>2 Gio</td>
</tr>
<tr class="odd">
<td>/var</td>
<td>4 Gio</td>
</tr>
<tr class="even">
<td>/var/log</td>
<td>4 Gio</td>
</tr>
<tr class="odd">
<td>/var/tmp</td>
<td>4 Gio</td>
</tr>
<tr class="even">
<td>/var/log/audit</td>
<td>4 Gio</td>
</tr>
<tr class="odd">
<td>/srv ou /opt</td>
<td>6 Gio</td>
</tr>
<tr class="even">
<td>swap</td>
<td>4 Gio (ou 20% de la mémoire vive)</td>
</tr>
</tbody>
</table>
<p>Ne pas sélectionner de politique de sécurité. Le chapitre But du système est optionnel et pour information seulement. Cliquer sur Commencer l’installation.</p>
<p>Définir un mot de passe administrateur (root) et créer un compte utilisateur. Veiller à choisir des mots de passe conformes à la politique de sécurité. Redémarrer une fois l’installation terminée :</p>
<p>Passer ensuite à la sécurisation dans le chapitre ci-dessous.</p>
<p><a name="securisation"></a></p>
<h2 id="03-securisation">0.3. SECURISATION</h2>
<p>Une fois l’installation terminée selon le chapitre précédent, la sécurisation proprement dite se passe en deux étapes :</p>
<ol>
<li>Appliquer les correctifs et mises à jour de sécurité.</li>
<li>Effectuer les opérations manuelles détaillés ci-dessous.</li>
<li>Lancer le script fourni en attachement.</li>
</ol>
<h3 id="correctifs">Correctifs</h3>
<p>Pour rappel, il est évidemment nécessaire d’installer au plus tôt les dernières mises à jour de sécurité.</p>
<p>En plus des mises à jour de sécurité, des correctifs fonctionnels peuvent être nécessaires. Par exemple, Red Hat Enterprise 8.1 nécessite d’avoir les correctifs/erratas suivants installés pour un fonctionnement correct du système (liste non exhaustive) :</p>
<ul>
<li><a href="https://access.redhat.com/errata/RHBA-2020:0334" class="uri">https://access.redhat.com/errata/RHBA-2020:0334</a></li>
<li><a href="https://access.redhat.com/errata/RHBA-2020:1773" class="uri">https://access.redhat.com/errata/RHBA-2020:1773</a></li>
</ul>
<h3 id="opérations-manuelles-1">Opérations Manuelles</h3>
<p>Editer le fichier /etc/fstab pour rajouter les options sur les points de montage suivant le tableau suivant :</p>
<table>
<thead>
<tr class="header">
<th>Point de Montage</th>
<th>Options</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>/</td>
<td><sans option> Partition racine, contient le reste de l’arborescence</td>
<td></td>
</tr>
<tr class="even">
<td>/boot et /boot/efi</td>
<td>nodev,nosuid,noexec,noauto</td>
<td>Contient le noyau et le chargeur de démarrage. Pas d’accès nécessaire une fois le boot terminé (sauf mise à jour)</td>
</tr>
<tr class="odd">
<td>/dev/shm</td>
<td>nodev,nosuid,noexec</td>
<td>Contient les segments de mémoire partagés</td>
</tr>
<tr class="even">
<td>/home</td>
<td>nodev,nosuid,noexec</td>
<td>Contient les HOME utilisateurs. Montage en lecture seule si non utilisé</td>
</tr>
<tr class="odd">
<td>/opt</td>
<td>nosuid,nodev (ro optionnel)</td>
<td>Packages additionnels au système. Montage en lecture seule si non utilisé</td>
</tr>
<tr class="even">
<td>/proc</td>
<td>hidepid=2,gid=sudogrp</td>
<td>Contient des informations sur les processus et le système</td>
</tr>
<tr class="odd">
<td>/srv ou /opt</td>
<td>nosuid,nodev (noexec,ro optionnels)</td>
<td>Contient des fichiers servis par un service type web, ftp, etc.</td>
</tr>
<tr class="even">
<td>/tmp</td>
<td>nodev,nosuid,noexec</td>
<td>Fichiers temporaires. Ne doit contenir que des éléments non exécutables. Nettoyé après redémarrage ou préférablement de type tmpfs</td>
</tr>
<tr class="odd">
<td>/usr</td>
<td>nodev (ro optionnel)</td>
<td>Contient la majorité des utilitaires et fichiers système</td>
</tr>
<tr class="even">
<td>/var</td>
<td>nodev,nosuid,noexec</td>
<td>Partition contenant des fichiers variables pendant la vie du système (mails, fichiers PID, bases de données d’un service)</td>
</tr>
<tr class="odd">
<td>/var/log</td>
<td>nodev,nosuid,noexec</td>
<td>Contient les logs du système</td>
</tr>
<tr class="even">
<td>/var/log</td>
<td>nodev,nosuid,noexec</td>
<td>Contient les logs d'audit du système</td>
</tr>
<tr class="odd">
<td>/var/tmp</td>
<td>nodev,nosuid,noexec</td>
<td>Fichiers temporaires conservés après extinction</td>
</tr>
</tbody>
</table>
<p>Rajouter les lignes suivantes : proc /proc proc rw,nosuid,nodev,noexec,relatime,hidepid=2,gid=sudoers 0 0 none /dev/shm tmpfs nosuid,nodev,noexec,defaults 0 0</p>
<p>À titre d’exemple, voici le fichier édité pour une machine virtuelle (sans les options « ro » de lecture seule) :</p>
<pre><code>#
# /etc/fstab
# Created by anaconda on Fri Sep 11 11:21:06 2020
#
# Accessible filesystems, by reference, are maintained under &#39;/dev/disk/&#39;.
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.
#
# After editing this file, run &#39;systemctl daemon-reload&#39; to update systemd
# units generated from this file.
#
/dev/mapper/rhel_lab-root           /                       xfs     defaults                        0 0
UUID=3fe99bee-938f-4751-a956-b4335bc32e7c   /boot                   xfs     nosuid,nodev,noexec,noauto,defaults             0 0
UUID=16FD-1FB3                      /boot/efi           vfat    nosuid,nodev,noexec,noauto,umask=0077,shortname=winnt   0 2
/dev/mapper/rhel_lab-home           /home               xfs     nosuid,nodev,noexec,defaults                    0 0
/dev/mapper/rhel_lab-srv            /srv            xfs     nosuid,nodev,defaults                       0 0
/dev/mapper/rhel_lab-tmp            /tmp            xfs     nosuid,nodev,noexec,defaults                    0 0
/dev/mapper/rhel_lab-usr            /usr                xfs     nodev,defaults                          0 0
/dev/mapper/rhel_lab-var            /var                xfs     nosuid,nodev,noexec,defaults                    0 0
/dev/mapper/rhel_lab-var_log            /var/log            xfs     nosuid,nodev,noexec,defaults                    0 0
/dev/mapper/rhel_lab-var_log_audit      /var/log/audit      xfs     nosuid,nodev,noexec,defaults                    0 0
/dev/mapper/rhel_lab-var_tmp            /var/tmp            xfs     nosuid,nodev,noexec,defaults                    0 0
/dev/mapper/rhel_lab-swap           swap                    swap    defaults                            0 0
proc                        /proc           proc    rw,nosuid,nodev,noexec,relatime,hidepid=2,gid=sudogrp   0 0
none                        /dev/shm            tmpfs   nosuid,nodev,noexec,defaults                0 0
</code></pre>
<h3 id="lancer-le-script-de-sécurisation">Lancer le script de sécurisation</h3>
<p>Copier le script fourni en attachement dans le répertoire /root, puis le lancer dans une session root (ou dans une session sudo). Il est obligatoire d’avoir inséré un DVD d’installation dans le lecteur (ou à défaut d’avoir monté l’image ISO sur le répertoire /mnt/disc). Une fois lancé, le script pose quelques questions pour affiner le paramétrage. Une fois la sécurisation effectuée (et le système redémarré), il n’est plus possible de relancer le script : le montage des images ISO n’étant plus possible. Voir le chapitre 7.7 pour les procédures à appliquer pour utiliser des supports externes. <a name="documentsàétablir"></a></p>
<h2 id="04-documents-à-établir">0.4. Documents à établir</h2>
<p>La directive HARDE-RHEL-51 demande à ce qu’une liste blanche des démons (services résidents) soit établie. La directive HARDE-RHEL-143 demande à ce qu’une liste blanche et une liste noire des utilisateurs soient établies. <a name="audit-1"></a></p>
<h2 id="05-audit">0.5. AUDIT</h2>
<p>Le catalogue des règles de sécurisation donne le détail des étapes à réaliser pour auditer le système. Comme pour la sécurisation, lorsque cela a été possible, ces étapes ont été automatisées à l’aide d’un script audit.sh fourni en attachement. Ce script a été écrit en utilisant le framework bats-core (également fourni en attachement).</p>
<p><a name="cataloguedesreglesdesecurisation"></a></p>
<h2 id="06-catalogue-des-regles-de-securisation">0.6. CATALOGUE DES REGLES DE SECURISATION</h2>
<p>Ce catalogue contient des règles définies à partir des recommandations ANSSI ([REF2]) et du benchmark CIS ([REF 3]). Certaines de ces règles sont positionnées à « Ne pas implémenter » car elles ont été jugées non pertinentes ou non applicables dans le cadre de ce projet. Elles sont néanmoins présentes pour offrir une vision globale des recommandations. La majorité de ces règles sont mis en place par un paramétrage du système mais certaines demandent la mise en place de procédures organisationnelles</p>
<p><a name="harde-rhel-001:minimisationdesservicesinstallés"></a></p>
<h2 id="07-harde-rhel-001--minimisation-des-services-installés">0.7. HARDE-RHEL-001 : Minimisation des services installés</h2>
<h3 id="description">Description</h3>
<p>Supprimer les services non nécessaires. Une liste de paquets le plus souvent inutiles et désinstallée par le script de sécurisation.</p>
<h3 id="références">Références</h3>
<h4 id="cis">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi">ANSSI</h4>
<p>Référence ANSSI: R1</p>
<h4 id="niveau-de-durcissement-1">Niveau de Durcissement: 1</h4>
<h4 id="méthode-à-suivre">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-001:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-1 : Minimisation des services installés&quot;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co"># If we&#39;re online update</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="ex">dnf</span> update</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># packages that we depends on</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="ex">dnf</span> install --assumeyes net-tools tar policycoreutils-python-utils setools-console chrony rsyslog bzip2 firewalld audit usbguard rng-tools openscap-scanner libcap-ng-utils aide rsyslog rsyslog-gnutls audispd-plugins tmux dnf-automatic sssd-ipa sudo policycoreutils python3-subscription-manager-rhsm fapolicyd aide scap-security-guide sssd realmd oddjob oddjob-mkhomedir adcli samba-common samba-common-tools krb5-workstation openldap-clients python3-policycoreutils</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="ex">dnf</span> remove --assumeyes abrt-addon-ccpp abrt-plugin-sosreport iprutils nfs-utils abrt-addon-python tuned abrt-addon-kerneloops gssproxy abrt-plugin-logger abrt-cli abrt-plugin-rhtsupport sendmail abrt setroubleshoot setroubleshoot-server mcstrans xinetd xorg-x11*.* ypbind telnet</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co"># Fin: HARDE-RHEL-1</span></a>
<a class="sourceLine" id="cb2-8" title="8"></a></code></pre></div>
<h3 id="méthode-daudit">Méthode d'audit</h3>
<pre><code>ps aux
netstat -tulpen
ss -xp
```## HARDE-RHEL-002 : 

### Description


### Références

#### CIS
Références:
Contrôles:

#### ANSSI
Référence ANSSI:

#### Niveau de Durcissement:

#### Méthode à suivre

Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-002:
```bash
echo &quot;HARDE-RHEL-2 : Minimisation de la configuration&quot;

# Fin: HARDE-RHEL-2

</code></pre>
<h3 id="méthode-daudit-1">Méthode d'audit</h3>
<h2 id="harde-rhel-003-">HARDE-RHEL-003 :</h2>
<h3 id="description-1">Description</h3>
<h3 id="références-1">Références</h3>
<h4 id="cis-1">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-1">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-1">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-003:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-3 : Principe de moindre privilège&quot;</span></a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co"># Fin: HARDE-RHEL-3</span></a>
<a class="sourceLine" id="cb4-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-2">Méthode d'audit</h3>
<h2 id="harde-rhel-004-">HARDE-RHEL-004 :</h2>
<h3 id="description-2">Description</h3>
<h3 id="références-2">Références</h3>
<h4 id="cis-2">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-2">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-1">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-2">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-004:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-4 : Utilisation des fonctions de contrôles d&#39;accès&quot;</span></a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co"># Fin: HARDE-RHEL-4</span></a>
<a class="sourceLine" id="cb5-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-3">Méthode d'audit</h3>
<h2 id="harde-rhel-005-">HARDE-RHEL-005 :</h2>
<h3 id="description-3">Description</h3>
<h3 id="références-3">Références</h3>
<h4 id="cis-3">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-3">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-2">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-3">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-005:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-5 : Principe de défense en profondeur&quot;</span></a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co"># Fin: HARDE-RHEL-5</span></a>
<a class="sourceLine" id="cb6-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-4">Méthode d'audit</h3>
<h2 id="harde-rhel-006-">HARDE-RHEL-006 :</h2>
<h3 id="description-4">Description</h3>
<h3 id="références-4">Références</h3>
<h4 id="cis-4">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-4">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-3">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-4">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-006:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-6 : Cloisonnement des services réseaux&quot;</span></a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co"># Fin: HARDE-RHEL-6</span></a>
<a class="sourceLine" id="cb7-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-5">Méthode d'audit</h3>
<h2 id="harde-rhel-007-">HARDE-RHEL-007 :</h2>
<h3 id="description-5">Description</h3>
<h3 id="références-5">Références</h3>
<h4 id="cis-5">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-5">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-4">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-5">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-007:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-7 : Journalisation de l&#39;activité des services&quot;</span></a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co"># Fin: HARDE-RHEL-7</span></a>
<a class="sourceLine" id="cb8-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-6">Méthode d'audit</h3>
<h2 id="harde-rhel-008-">HARDE-RHEL-008 :</h2>
<h3 id="description-6">Description</h3>
<h3 id="références-6">Références</h3>
<h4 id="cis-6">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-6">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-5">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-6">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-008:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-8 : Mises à jour régulières&quot;</span></a>
<a class="sourceLine" id="cb9-2" title="2"></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co"># Fin: HARDE-RHEL-8</span></a>
<a class="sourceLine" id="cb9-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-7">Méthode d'audit</h3>
<h2 id="harde-rhel-009-">HARDE-RHEL-009 :</h2>
<h3 id="description-7">Description</h3>
<h3 id="références-7">Références</h3>
<h4 id="cis-7">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-7">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-6">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-7">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-009:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb10-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-9 : Configuration matérielle&quot;</span></a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co"># Fin: HARDE-RHEL-9</span></a>
<a class="sourceLine" id="cb10-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-8">Méthode d'audit</h3>
<h2 id="harde-rhel-010-">HARDE-RHEL-010 :</h2>
<h3 id="description-8">Description</h3>
<h3 id="références-8">Références</h3>
<h4 id="cis-8">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-8">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-7">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-8">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-010:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-10 : Architecture 32 et 64 bits&quot;</span></a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co"># Fin: HARDE-RHEL-10</span></a>
<a class="sourceLine" id="cb11-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-9">Méthode d'audit</h3>
<h2 id="harde-rhel-011-">HARDE-RHEL-011 :</h2>
<h3 id="description-9">Description</h3>
<h3 id="références-9">Références</h3>
<h4 id="cis-9">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-9">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-8">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-9">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-011:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb12-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-11 : Désactiver les sytèmes de fichiers inutilisés&quot;</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">for</span> <span class="ex">i</span> in cramfs freevxfs jffs2 hfs hfsplus squashfs crc-itu-t udf fat vfat<span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="fu">cat</span> <span class="op">&gt;</span><span class="st">&quot;/etc/modprobe.d/</span><span class="va">$i</span><span class="st">&quot;</span>.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb12-4" title="4">install <span class="va">$i</span> /bin/true</a>
<a class="sourceLine" id="cb12-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="ex">rmmod</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span> <span class="kw">||</span> <span class="fu">true</span> <span class="kw">;</span> <span class="kw">done</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co"># Fin: HARDE-RHEL-11</span></a>
<a class="sourceLine" id="cb12-8" title="8"></a></code></pre></div>
<h3 id="méthode-daudit-10">Méthode d'audit</h3>
<h2 id="harde-rhel-012-">HARDE-RHEL-012 :</h2>
<h3 id="description-10">Description</h3>
<h3 id="références-10">Références</h3>
<h4 id="cis-10">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-10">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-9">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-10">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-012:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" title="1"><span class="co">#! /bin/bash</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-12 : Partition séparée pour /home&quot;</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="fu">mount</span> <span class="kw">|</span><span class="fu">grep</span> -q -E <span class="st">&#39;/home\s&#39;</span> <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;/home n&#39;est pas une partition séparée !&quot;</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co"># Fin: HARDE-RHEL-12</span></a>
<a class="sourceLine" id="cb13-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-11">Méthode d'audit</h3>
<h2 id="harde-rhel-013-">HARDE-RHEL-013 :</h2>
<h3 id="description-11">Description</h3>
<h3 id="références-11">Références</h3>
<h4 id="cis-11">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-11">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-10">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-11">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-013:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb14-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-13 : Options de montage nodev,nosuid,noexec pour /dev/shm&quot;</span></a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co"># Fin: HARDE-RHEL-13</span></a>
<a class="sourceLine" id="cb14-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-12">Méthode d'audit</h3>
<h2 id="harde-rhel-014-">HARDE-RHEL-014 :</h2>
<h3 id="description-12">Description</h3>
<h3 id="références-12">Références</h3>
<h4 id="cis-12">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-12">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-11">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-12">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-014:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb15-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-14 : Options de montage nodev,nosuid,noexec pour les points de montage temporaire&quot;</span></a>
<a class="sourceLine" id="cb15-2" title="2"></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co"># Fin: HARDE-RHEL-14</span></a>
<a class="sourceLine" id="cb15-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-13">Méthode d'audit</h3>
<h2 id="harde-rhel-015-">HARDE-RHEL-015 :</h2>
<h3 id="description-13">Description</h3>
<h3 id="références-13">Références</h3>
<h4 id="cis-13">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-13">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-12">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-13">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-015:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb16-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-15 : S&#39;assurer de la configuration de /tmp&quot;</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="fu">mount</span> <span class="kw">|</span><span class="fu">grep</span> -q -E <span class="st">&#39;/tmp\s&#39;</span> <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;/tmp n&#39;est pas une partition séparée !&quot;</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co"># Fin: HARDE-RHEL-15</span></a>
<a class="sourceLine" id="cb16-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-14">Méthode d'audit</h3>
<h2 id="harde-rhel-016--désactiver-le-stockage-usb">HARDE-RHEL-016 : Désactiver le stockage USB</h2>
<h3 id="description-14">Description</h3>
<p>Pour désactiver le stockage USB, lancer les commandes du chapitre suivant. Une alternative est d'autoriser le module usb-storage mais de contôler et limiter les périphériques USB pouvant être connectés en configurant usb-guard. La configuration d'USB n'est pas décrite dans ce guide.</p>
<h3 id="références-14">Références</h3>
<h4 id="cis-14">CIS</h4>
<p>Références: RHEL 8 1.1.23</p>
<p>Contrôles: 08.4 Configure Anti-Malware Scanning of Removable Devices 08.5 Configure Devices Not To Auto-run Content</p>
<h4 id="anssi-14">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-1-1">Niveau de Durcissement: 1</h4>
<h4 id="méthode-à-suivre-14">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-016:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb17-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-16 : Désactiver le stockage USB&quot;</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="bu">declare</span> -a <span class="va">modules</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="va">modules=(</span></a>
<a class="sourceLine" id="cb17-4" title="4">    [<span class="ex">0</span>]=<span class="st">&quot;usb-storage&quot;</span></a>
<a class="sourceLine" id="cb17-5" title="5">)</a>
<a class="sourceLine" id="cb17-6" title="6"><span class="kw">for</span> <span class="ex">i</span> in <span class="st">&quot;</span><span class="va">${modules[@]}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb17-7" title="7">    <span class="fu">cat</span> <span class="op">&gt;</span><span class="st">&quot;/etc/modprobe.d/</span><span class="va">$i</span><span class="st">.conf&quot;</span> <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb17-8" title="8">install <span class="va">$i</span> /bin/true</a>
<a class="sourceLine" id="cb17-9" title="9"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb17-10" title="10">    <span class="ex">rmmod</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span> <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="kw">done</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="ex">usbguard</span> generate-policy <span class="op">&gt;</span> /etc/usbguard/rules.conf</a>
<a class="sourceLine" id="cb17-13" title="13"><span class="co"># Fin: HARDE-RHEL-16</span></a>
<a class="sourceLine" id="cb17-14" title="14"></a></code></pre></div>
<h3 id="méthode-daudit-15">Méthode d'audit</h3>
<h2 id="harde-rhel-017--sassurer-de-la-configuration-de-var">HARDE-RHEL-017 : S'assurer de la configuration de /var</h2>
<h3 id="description-15">Description</h3>
<p><code>/var</code> doit être installé dans une partition séparée d'au moins 4GB avec les options nodev,noexec et nosuid.</p>
<p>Beaucoup de logiciels nécessitent néanmoins des droits d'exécution dans des sous-répertoires (par exemple /var/lib/raas/unpack pour VMWare SaltStack Config). Dans ces cas-là, il est recommandé de créer une partition dédiée à cette application (ici avec lvm):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb18-1" title="1"><span class="ex">lvcreate</span> -L 4G rhel_redhat -n raas_unpack</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="fu">mkdir</span> /var/lib/raas</a>
<a class="sourceLine" id="cb18-3" title="3"><span class="fu">mkdir</span> /var/lib/raas/unpack</a>
<a class="sourceLine" id="cb18-4" title="4"><span class="fu">chown</span> -R raas:raas /var/lib/raas</a>
<a class="sourceLine" id="cb18-5" title="5"><span class="fu">cat</span> <span class="op">&gt;&gt;</span>/etc/fstab <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb18-6" title="6">/dev/mapper/rhel_redhat-raas_unpack /var/lib/raas/unpack          xfs     nosuid,nodev,defaults        0 0</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="fu">mount</span> /var/lib/raas/unpack</a></code></pre></div>
<h3 id="références-15">Références</h3>
<h4 id="cis-15">CIS</h4>
<p>Références: RHEL 8 1.1.6</p>
<p>Contrôles: 05.1 Establish Secure Configurations</p>
<h4 id="anssi-15">ANSSI</h4>
<p>Référence ANSSI: R12</p>
<h4 id="niveau-de-durcissement-4">Niveau de Durcissement: 4</h4>
<h4 id="méthode-à-suivre-15">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-017:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb19-1" title="1"><span class="co">#! /usr/bin/env bash</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-17 : S&#39;assurer de la configuration de /var&quot;</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> -E <span class="st">&#39;\s/var\s&#39;</span> <span class="kw">|</span> <span class="fu">grep</span> -q nodev <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;Options de montage non valide pour /var&quot;</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co"># Fin: HARDE-RHEL-17</span></a>
<a class="sourceLine" id="cb19-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-16">Méthode d'audit</h3>
<h2 id="harde-rhel-018--sassurer-de-la-configuration-de-vartmp">HARDE-RHEL-018 : S'assurer de la configuration de /var/tmp</h2>
<h3 id="description-16">Description</h3>
<p><code>/var/tmp</code> doit être installé dans une partition séparée d'au moins 1GB avec les options nodev,nosuid,noexec</p>
<h3 id="références-16">Références</h3>
<h4 id="cis-16">CIS</h4>
<p>Références: RHEL 8 1.1.7 RHEL 8 1.1.8 RHEL 8 1.1.9 RHEL 8 1.1.10</p>
<p>Contrôles: 05.1 Establish Secure Configurations 05.1 Establish Secure Configurations 05.1 Establish Secure Configurations 02.6 Address unapproved software</p>
<h4 id="anssi-16">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-4-1">Niveau de Durcissement: 4</h4>
<h4 id="méthode-à-suivre-16">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-018:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb20-1" title="1"><span class="co">#! /usr/bin/env bash</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-18 : S&#39;assurer de la configuration de /var/tmp&quot;</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> -E <span class="st">&#39;/var/tmp\s&#39;</span> <span class="kw">|</span> <span class="fu">grep</span> nodev <span class="kw">|</span> <span class="fu">grep</span> noexec <span class="kw">|</span> <span class="fu">grep</span> nosuid <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;Options de montage non valide pour /var/tmp&quot;</span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="co"># Fin: HARDE-RHEL-18</span></a>
<a class="sourceLine" id="cb20-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-17">Méthode d'audit</h3>
<h2 id="harde-rhel-019--partitionnement-type">HARDE-RHEL-019 : Partitionnement type</h2>
<h3 id="description-17">Description</h3>
<p>Les partitions permettent de segmenter l'espace de stockage et d'appliquer des directives de haut-niveau comme <code>noexec</code> pour empêcher l'exécution de logiciels.</p>
<p>Les partitions /tmp et /var/tmp sont traitées de manière légérement différente car elles sont gérées via pam_namespace.</p>
<p>Certains logiciels peuvent demander des permissions spéciales : par exemple docker-compose demande l'option <code>exec</code> sur la partition <code>/tmp</code>. Différents moyens pour permettre ce comportement sans compromettre la sécurité sont possibles:</p>
<ul>
<li>monter la partition temporairement</li>
</ul>
<h3 id="références-17">Références</h3>
<h4 id="cis-17">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-17">ANSSI</h4>
<p>Référence ANSSI: R12</p>
<h4 id="niveau-de-durcissement-2">Niveau de Durcissement: 2</h4>
<h4 id="méthode-à-suivre-17">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-019:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb21-1" title="1"><span class="co">#! /usr/bin/env bash</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-19 : Partitionnement type&quot;</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="bu">echo</span> <span class="st">&quot;Les options sur les partitions doivent être positionnées manuellement en suivant le guide&quot;</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="fu">mkdir</span> -p /etc/systemd/system/systemd-logind.service.d </a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co"># makes systemd-logind work with hidepid</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/system/systemd-logind.service.d/hidepid.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb21-7" title="7">[Service]</a>
<a class="sourceLine" id="cb21-8" title="8">SupplementaryGroups=sudogrp</a>
<a class="sourceLine" id="cb21-9" title="9"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="co"># Fin: HARDE-RHEL-19</span></a>
<a class="sourceLine" id="cb21-11" title="11"></a></code></pre></div>
<h3 id="méthode-daudit-18">Méthode d'audit</h3>
<h2 id="harde-rhel-020-">HARDE-RHEL-020 :</h2>
<h3 id="description-18">Description</h3>
<h3 id="références-18">Références</h3>
<h4 id="cis-18">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-18">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-13">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-18">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-020:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb22-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-20 : Restrictions d&#39;accès sur le dossier /boot&quot;</span></a>
<a class="sourceLine" id="cb22-2" title="2"></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co"># Fin: HARDE-RHEL-20</span></a>
<a class="sourceLine" id="cb22-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-19">Méthode d'audit</h3>
<h2 id="harde-rhel-021-">HARDE-RHEL-021 :</h2>
<h3 id="description-19">Description</h3>
<h3 id="références-19">Références</h3>
<h4 id="cis-19">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-19">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-14">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-19">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-021:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb23-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-21 : Installation de paquets réduite au strict nécessaire&quot;</span></a>
<a class="sourceLine" id="cb23-2" title="2"></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="co"># Fin: HARDE-RHEL-21</span></a>
<a class="sourceLine" id="cb23-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-20">Méthode d'audit</h3>
<h2 id="harde-rhel-022-">HARDE-RHEL-022 :</h2>
<h3 id="description-20">Description</h3>
<h3 id="références-20">Références</h3>
<h4 id="cis-20">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-20">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-15">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-20">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-022:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb24-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-22 : Choix des dépôts de paquets&quot;</span></a>
<a class="sourceLine" id="cb24-2" title="2"></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="co"># Fin: HARDE-RHEL-22</span></a>
<a class="sourceLine" id="cb24-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-21">Méthode d'audit</h3>
<h2 id="harde-rhel-023-">HARDE-RHEL-023 :</h2>
<h3 id="description-21">Description</h3>
<h3 id="références-21">Références</h3>
<h4 id="cis-21">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-21">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-16">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-21">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-023:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb25-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-23 : Dépôts de paquets durcis&quot;</span></a>
<a class="sourceLine" id="cb25-2" title="2"></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co"># Fin: HARDE-RHEL-23</span></a>
<a class="sourceLine" id="cb25-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-22">Méthode d'audit</h3>
<h2 id="harde-rhel-024-">HARDE-RHEL-024 :</h2>
<h3 id="description-22">Description</h3>
<h3 id="références-22">Références</h3>
<h4 id="cis-22">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-22">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-17">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-22">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-024:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb26-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-24 : Robustesse du mot de passe administrateur&quot;</span></a>
<a class="sourceLine" id="cb26-2" title="2"></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co"># Fin: HARDE-RHEL-24</span></a>
<a class="sourceLine" id="cb26-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-23">Méthode d'audit</h3>
<h2 id="harde-rhel-025-">HARDE-RHEL-025 :</h2>
<h3 id="description-23">Description</h3>
<h3 id="références-23">Références</h3>
<h4 id="cis-23">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-23">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-18">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-23">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-025:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb27-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-25 : Installation d&#39;éléments secrets ou de confiance&quot;</span></a>
<a class="sourceLine" id="cb27-2" title="2"></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="co"># Fin: HARDE-RHEL-25</span></a>
<a class="sourceLine" id="cb27-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-24">Méthode d'audit</h3>
<h2 id="harde-rhel-026-">HARDE-RHEL-026 :</h2>
<h3 id="description-24">Description</h3>
<h3 id="références-24">Références</h3>
<h4 id="cis-24">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-24">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-19">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-24">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-026:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb28-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-26 : S&#39;assurer que les politiques de chiffrement historiques soit désactivées&quot;</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="ex">update-crypto-policies</span> --set DEFAULT <span class="kw">;</span> <span class="ex">update-crypto-policies</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="co"># Fin: HARDE-RHEL-26</span></a>
<a class="sourceLine" id="cb28-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-25">Méthode d'audit</h3>
<h2 id="harde-rhel-027-">HARDE-RHEL-027 :</h2>
<h3 id="description-25">Description</h3>
<h3 id="références-25">Références</h3>
<h4 id="cis-25">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-25">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-20">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-25">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-027:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb29-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-27 : S&#39;assurer que le mode FIPS ou FUTURE est activé pour le chiffrement&quot;</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="ex">update-crypto-policies</span> --set FIPS<span class="kw">;</span> <span class="ex">update-crypto-policies</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="co"># Fin: HARDE-RHEL-27</span></a>
<a class="sourceLine" id="cb29-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-26">Méthode d'audit</h3>
<h2 id="harde-rhel-028-">HARDE-RHEL-028 :</h2>
<h3 id="description-26">Description</h3>
<h3 id="références-26">Références</h3>
<h4 id="cis-26">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-26">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-21">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-26">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-028:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb30-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-28 : S&#39;assurer que l&#39;IP Forwarding est désactivé&quot;</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/30forwarding.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb30-3" title="3"># Pas de routage entre les interfaces</a>
<a class="sourceLine" id="cb30-4" title="4">net.ipv4.ip_forward = 0</a>
<a class="sourceLine" id="cb30-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="co"># Fin: HARDE-RHEL-28</span></a>
<a class="sourceLine" id="cb30-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-27">Méthode d'audit</h3>
<h2 id="harde-rhel-029-">HARDE-RHEL-029 :</h2>
<h3 id="description-27">Description</h3>
<h3 id="références-27">Références</h3>
<h4 id="cis-27">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-27">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-22">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-27">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-029:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb31-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-29 : Désactiver les ICMP Redirects&quot;</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/35icmpredirects.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb31-3" title="3"># Ne pas envoyer de redirections ICMP</a>
<a class="sourceLine" id="cb31-4" title="4">net.ipv4.conf.all.send_redirects = 0</a>
<a class="sourceLine" id="cb31-5" title="5">net.ipv4.conf.default.send_redirects = 0</a>
<a class="sourceLine" id="cb31-6" title="6"># Ne pas accepter les ICMP de type redirect</a>
<a class="sourceLine" id="cb31-7" title="7">net.ipv4.conf.all.accept_redirects = 0</a>
<a class="sourceLine" id="cb31-8" title="8">net.ipv4.conf.all.secure_redirects = 0</a>
<a class="sourceLine" id="cb31-9" title="9">net.ipv4.conf.default.accept_redirects = 0</a>
<a class="sourceLine" id="cb31-10" title="10">net.ipv4.conf.default.secure_redirects = 0</a>
<a class="sourceLine" id="cb31-11" title="11"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb31-12" title="12"><span class="co"># Fin: HARDE-RHEL-29</span></a>
<a class="sourceLine" id="cb31-13" title="13"></a></code></pre></div>
<h3 id="méthode-daudit-28">Méthode d'audit</h3>
<h2 id="harde-rhel-030-">HARDE-RHEL-030 :</h2>
<h3 id="description-28">Description</h3>
<h3 id="références-28">Références</h3>
<h4 id="cis-28">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-28">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-23">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-28">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-030:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb32-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-30 : Refuser les paquets routés par la source&quot;</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/40sourceroute.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb32-3" title="3"># Refuser les paquets de source routing</a>
<a class="sourceLine" id="cb32-4" title="4">net.ipv4.conf.all.accept_source_route = 0</a>
<a class="sourceLine" id="cb32-5" title="5">net.ipv4.conf.default.accept_source_route = 0</a>
<a class="sourceLine" id="cb32-6" title="6"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb32-7" title="7"><span class="co"># Fin: HARDE-RHEL-30</span></a>
<a class="sourceLine" id="cb32-8" title="8"></a></code></pre></div>
<h3 id="méthode-daudit-29">Méthode d'audit</h3>
<h2 id="harde-rhel-031-">HARDE-RHEL-031 :</h2>
<h3 id="description-29">Description</h3>
<h3 id="références-29">Références</h3>
<h4 id="cis-29">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-29">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-24">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-29">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-031:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb33-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-31 : S&#39;assurer que les paquets suspects soient loggués&quot;</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/45logmartians.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb33-3" title="3"># Loguer les paquets ayant des IPs anormales</a>
<a class="sourceLine" id="cb33-4" title="4">net.ipv4.conf.all.log_martians = 1</a>
<a class="sourceLine" id="cb33-5" title="5">net.ipv4.conf.default.log_martians = 1</a>
<a class="sourceLine" id="cb33-6" title="6"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="co"># Fin: HARDE-RHEL-31</span></a>
<a class="sourceLine" id="cb33-8" title="8"></a></code></pre></div>
<h3 id="méthode-daudit-30">Méthode d'audit</h3>
<h2 id="harde-rhel-032-">HARDE-RHEL-032 :</h2>
<h3 id="description-30">Description</h3>
<h3 id="références-30">Références</h3>
<h4 id="cis-30">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-30">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-25">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-30">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-032:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb34-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-32 : Refuser les ICMP broadcast&quot;</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/50icmpbroadcast.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb34-3" title="3"># Refuser les requêtes ICMP vers une adresse de broadcast/multicast</a>
<a class="sourceLine" id="cb34-4" title="4">net.ipv4.icmp_echo_ignore_broadcasts = 1</a>
<a class="sourceLine" id="cb34-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="co"># Fin: HARDE-RHEL-32</span></a>
<a class="sourceLine" id="cb34-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-31">Méthode d'audit</h3>
<h2 id="harde-rhel-033-">HARDE-RHEL-033 :</h2>
<h3 id="description-31">Description</h3>
<h3 id="références-31">Références</h3>
<h4 id="cis-31">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-31">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-26">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-31">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-033:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb35-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-33 : Ignorer les réponses ICMP douteuses&quot;</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/55icmpbogus.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb35-3" title="3"># Refuser les réponses ICMP bogus</a>
<a class="sourceLine" id="cb35-4" title="4">net.ipv4.icmp_ignore_bogus_error_responses = 1</a>
<a class="sourceLine" id="cb35-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="co"># Fin: HARDE-RHEL-33</span></a>
<a class="sourceLine" id="cb35-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-32">Méthode d'audit</h3>
<h2 id="harde-rhel-034-">HARDE-RHEL-034 :</h2>
<h3 id="description-32">Description</h3>
<h3 id="références-32">Références</h3>
<h4 id="cis-32">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-32">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-27">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-32">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-034:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb36-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-34 : Activer le filtrage par routage inversé&quot;</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/60rp_filter.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb36-3" title="3"># Filtrage par chemin inverse</a>
<a class="sourceLine" id="cb36-4" title="4">net.ipv4.conf.all.rp_filter = 1</a>
<a class="sourceLine" id="cb36-5" title="5">net.ipv4.conf.default.rp_filter = 1</a>
<a class="sourceLine" id="cb36-6" title="6"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="co"># Fin: HARDE-RHEL-34</span></a>
<a class="sourceLine" id="cb36-8" title="8"></a></code></pre></div>
<h3 id="méthode-daudit-33">Méthode d'audit</h3>
<h2 id="harde-rhel-035-">HARDE-RHEL-035 :</h2>
<h3 id="description-33">Description</h3>
<h3 id="références-33">Références</h3>
<h4 id="cis-33">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-33">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-28">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-33">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-035:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb37-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-35 : Activer les TCP Syn Cookies&quot;</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/65syncookies.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb37-3" title="3"># Utiliser les SYN cookies</a>
<a class="sourceLine" id="cb37-4" title="4">net.ipv4.tcp_syncookies = 1</a>
<a class="sourceLine" id="cb37-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb37-6" title="6"><span class="co"># Fin: HARDE-RHEL-35</span></a>
<a class="sourceLine" id="cb37-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-34">Méthode d'audit</h3>
<h2 id="harde-rhel-036-">HARDE-RHEL-036 :</h2>
<h3 id="description-34">Description</h3>
<h3 id="références-34">Références</h3>
<h4 id="cis-34">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-34">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-29">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-34">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-036:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb38-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-36 : Refuser les paquets IPv6 Router Advertisements&quot;</span></a>
<a class="sourceLine" id="cb38-2" title="2"></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="co"># Fin: HARDE-RHEL-36</span></a>
<a class="sourceLine" id="cb38-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-35">Méthode d'audit</h3>
<h2 id="harde-rhel-037-">HARDE-RHEL-037 :</h2>
<h3 id="description-35">Description</h3>
<h3 id="références-35">Références</h3>
<h4 id="cis-35">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-35">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-30">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-35">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-037:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb39-1" title="1"><span class="co">#! /bin/bash</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-37 : Désactiver IPV6&quot;</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/70disable_ipv6.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb39-4" title="4">net.ipv6.conf.all.disable_ipv6 = 1</a>
<a class="sourceLine" id="cb39-5" title="5">net.ipv6.conf.default.disable_ipv6 = 1</a>
<a class="sourceLine" id="cb39-6" title="6"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="co"># Samba and others may require the stack to be available, even with no interfaces </span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="co"># so the follwoing will have to be disabled</span></a>
<a class="sourceLine" id="cb39-9" title="9"><span class="kw">if</span> ! <span class="fu">grep</span> -q -E <span class="st">&#39;ipv6.disable=&#39;</span> /etc/default/grub <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(GRUB_CMDLINE_LINUX=&quot;[^&quot;]*\)&quot;/\1 ipv6.disable=1&quot;/&#39;</span> -i /etc/default/grub <span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;Parameter ipv6.disable added.&quot;</span><span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb39-10" title="10"><span class="ex">grub2-mkconfig</span> –o /boot/grub2/grub.cfg  <span class="op">&gt;</span>/dev/null</a>
<a class="sourceLine" id="cb39-11" title="11"><span class="ex">grub2-mkconfig</span> –o /boot/efi/EFI/grub.cfg  <span class="op">&gt;</span>/dev/null</a>
<a class="sourceLine" id="cb39-12" title="12"><span class="co"># Fin: HARDE-RHEL-37</span></a>
<a class="sourceLine" id="cb39-13" title="13"></a></code></pre></div>
<h3 id="méthode-daudit-36">Méthode d'audit</h3>
<h2 id="harde-rhel-038-">HARDE-RHEL-038 :</h2>
<h3 id="description-36">Description</h3>
<h3 id="références-36">Références</h3>
<h4 id="cis-36">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-36">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-31">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-36">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-038:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb40-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-38 : S&#39;assurer que la politique de chiffrement système n&#39;est pas outrepassée &quot;</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="fu">sed</span> -E -i <span class="st">&quot;s/^\s*(CRYPTO_POLICY\s*=.*)$/# \1/&quot;</span> /etc/sysconfig/sshd</a>
<a class="sourceLine" id="cb40-3" title="3"><span class="ex">systemctl</span> reload sshd</a>
<a class="sourceLine" id="cb40-4" title="4"><span class="co"># Fin: HARDE-RHEL-38</span></a>
<a class="sourceLine" id="cb40-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-37">Méthode d'audit</h3>
<h2 id="harde-rhel-039-">HARDE-RHEL-039 :</h2>
<h3 id="description-37">Description</h3>
<h3 id="références-37">Références</h3>
<h4 id="cis-37">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-37">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-32">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-37">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-039:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb41-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-39 : Paramétrage des sysctl réseau&quot;</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/05anssi.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb41-3" title="3"># RFC 1337</a>
<a class="sourceLine" id="cb41-4" title="4">net.ipv4.tcp_rfc1337 = 1</a>
<a class="sourceLine" id="cb41-5" title="5"># Ignorer les réponses non conformes à la RFC 1122</a>
<a class="sourceLine" id="cb41-6" title="6">net.ipv4.icmp_ignore_bogus_error_responses = 1</a>
<a class="sourceLine" id="cb41-7" title="7"># Augmenter la plage pour les ports éphémères</a>
<a class="sourceLine" id="cb41-8" title="8">net.ipv4.ip_local_port_range = 32768 65535</a>
<a class="sourceLine" id="cb41-9" title="9"># Désactiver IPv6</a>
<a class="sourceLine" id="cb41-10" title="10">net.ipv6.conf.all.disable_ipv6 = 1</a>
<a class="sourceLine" id="cb41-11" title="11"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb41-12" title="12"><span class="co"># Fin: HARDE-RHEL-39</span></a>
<a class="sourceLine" id="cb41-13" title="13"></a></code></pre></div>
<h3 id="méthode-daudit-38">Méthode d'audit</h3>
<h2 id="harde-rhel-040-">HARDE-RHEL-040 :</h2>
<h3 id="description-38">Description</h3>
<h3 id="références-38">Références</h3>
<h4 id="cis-38">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-38">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-33">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-38">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-040:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb42-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-40 : Permissions des fichiers de configuration du démarrage&quot;</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="fu">chown</span> root:root /boot/grub2/grub*</a>
<a class="sourceLine" id="cb42-3" title="3"><span class="fu">chmod</span> go-rwx /boot/grub2/grub*</a>
<a class="sourceLine" id="cb42-4" title="4"><span class="co"># Fin: HARDE-RHEL-40</span></a>
<a class="sourceLine" id="cb42-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-39">Méthode d'audit</h3>
<h2 id="harde-rhel-041-">HARDE-RHEL-041 :</h2>
<h3 id="description-39">Description</h3>
<h3 id="références-39">Références</h3>
<h4 id="cis-39">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-39">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-34">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-39">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-041:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb43-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-41 : Verrouiller par mot de passe la configuration de demarrage&quot;</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">while</span> ! <span class="ex">grub2-setpassword</span> -o /boot/grub2<span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb43-3" title="3">    <span class="bu">echo</span> <span class="st">&quot;Mot de passe non enregistré. Veuillez réessayer ...&quot;</span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="kw">done</span></a>
<a class="sourceLine" id="cb43-5" title="5"><span class="fu">cp</span> /boot/grub2/user.cfg /boot/efi/EFI/redhat/</a>
<a class="sourceLine" id="cb43-6" title="6"><span class="co"># Fin: HARDE-RHEL-41</span></a>
<a class="sourceLine" id="cb43-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-40">Méthode d'audit</h3>
<h2 id="harde-rhel-042-">HARDE-RHEL-042 :</h2>
<h3 id="description-40">Description</h3>
<h3 id="références-40">Références</h3>
<h4 id="cis-40">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-40">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-35">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-40">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-042:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb44-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-42 : Demander un mot de passe pour les modes de secours&quot;</span></a>
<a class="sourceLine" id="cb44-2" title="2"></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co"># Fin: HARDE-RHEL-42</span></a>
<a class="sourceLine" id="cb44-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-41">Méthode d'audit</h3>
<h2 id="harde-rhel-043-">HARDE-RHEL-043 :</h2>
<h3 id="description-41">Description</h3>
<h3 id="références-41">Références</h3>
<h4 id="cis-41">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-41">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-36">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-41">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-043:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb45-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-43 : Directive de configuration de l&#39;IOMMU&quot;</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="kw">if</span> ! <span class="fu">grep</span> -q -E <span class="st">&#39;iommu=&#39;</span> /etc/default/grub <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(GRUB_CMDLINE_LINUX=&quot;[^&quot;]*\)&quot;/\1 iommu=force&quot;/&#39;</span> -i /etc/default/grub <span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;Parameter iommu added.&quot;</span><span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="ex">grub2-mkconfig</span> -o /boot/grub2/grub.cfg  <span class="op">&gt;</span>/dev/null</a>
<a class="sourceLine" id="cb45-4" title="4"><span class="ex">grub2-mkconfig</span> –o /boot/efi/EFI/grub.cfg  <span class="op">&gt;</span>/dev/null</a>
<a class="sourceLine" id="cb45-5" title="5"><span class="co"># Fin: HARDE-RHEL-43</span></a>
<a class="sourceLine" id="cb45-6" title="6"></a></code></pre></div>
<h3 id="méthode-daudit-42">Méthode d'audit</h3>
<h2 id="harde-rhel-044-">HARDE-RHEL-044 :</h2>
<h3 id="description-42">Description</h3>
<h3 id="références-42">Références</h3>
<h4 id="cis-42">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-42">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-37">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-42">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-044:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb46-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-44 : Configurer la connexion Red Hat Subscription Manager&quot;</span></a>
<a class="sourceLine" id="cb46-2" title="2"><span class="fu">sed</span> -e s/enabled=1/enabled=0/ -i /etc/yum/pluginconf.d/subscription-manager.conf</a>
<a class="sourceLine" id="cb46-3" title="3"><span class="co"># Fin: HARDE-RHEL-44</span></a>
<a class="sourceLine" id="cb46-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-43">Méthode d'audit</h3>
<h2 id="harde-rhel-045-">HARDE-RHEL-045 :</h2>
<h3 id="description-43">Description</h3>
<h3 id="références-43">Références</h3>
<h4 id="cis-43">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-43">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-38">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-43">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-045:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb47-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-45 : Désactiver le démon rhnsd&quot;</span></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="ex">systemctl</span> --now disable rhnsd <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="co"># Fin: HARDE-RHEL-45</span></a>
<a class="sourceLine" id="cb47-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-44">Méthode d'audit</h3>
<h2 id="harde-rhel-046-">HARDE-RHEL-046 :</h2>
<h3 id="description-44">Description</h3>
<h3 id="références-44">Références</h3>
<h4 id="cis-44">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-44">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-39">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-44">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-046:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb48-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-46 : S&#39;assurer que les clés PGP soient configurées&quot;</span></a>
<a class="sourceLine" id="cb48-2" title="2"></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co"># Fin: HARDE-RHEL-46</span></a>
<a class="sourceLine" id="cb48-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-45">Méthode d'audit</h3>
<h2 id="harde-rhel-047-">HARDE-RHEL-047 :</h2>
<h3 id="description-45">Description</h3>
<h3 id="références-45">Références</h3>
<h4 id="cis-45">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-45">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-40">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-45">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-047:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb49-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-47 : Activer l&#39;option gpgcheck&quot;</span></a>
<a class="sourceLine" id="cb49-2" title="2"></a>
<a class="sourceLine" id="cb49-3" title="3"><span class="co"># Fin: HARDE-RHEL-47</span></a>
<a class="sourceLine" id="cb49-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-46">Méthode d'audit</h3>
<h2 id="harde-rhel-048-">HARDE-RHEL-048 :</h2>
<h3 id="description-46">Description</h3>
<h3 id="références-46">Références</h3>
<h4 id="cis-46">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-46">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-41">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-46">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-048:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb50-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-48 : S&#39;assurer que les dépôts soient configurés&quot;</span></a>
<a class="sourceLine" id="cb50-2" title="2"></a>
<a class="sourceLine" id="cb50-3" title="3"><span class="co"># Fin: HARDE-RHEL-48</span></a>
<a class="sourceLine" id="cb50-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-47">Méthode d'audit</h3>
<h2 id="harde-rhel-049-">HARDE-RHEL-049 :</h2>
<h3 id="description-47">Description</h3>
<h3 id="références-47">Références</h3>
<h4 id="cis-47">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-47">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-42">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-47">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-049:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb51-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-49 : S&#39;assurer que les mises à jour de sécurité sont installées&quot;</span></a>
<a class="sourceLine" id="cb51-2" title="2"></a>
<a class="sourceLine" id="cb51-3" title="3"><span class="co"># Fin: HARDE-RHEL-49</span></a>
<a class="sourceLine" id="cb51-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-48">Méthode d'audit</h3>
<h2 id="harde-rhel-050-">HARDE-RHEL-050 :</h2>
<h3 id="description-48">Description</h3>
<h3 id="références-48">Références</h3>
<h4 id="cis-48">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-48">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-43">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-48">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-050:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb52-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-50 : Activer le démon cron&quot;</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="ex">systemctl</span> --now enable crond</a>
<a class="sourceLine" id="cb52-3" title="3"><span class="co"># Fin: HARDE-RHEL-50</span></a>
<a class="sourceLine" id="cb52-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-49">Méthode d'audit</h3>
<h2 id="harde-rhel-051-">HARDE-RHEL-051 :</h2>
<h3 id="description-49">Description</h3>
<h3 id="références-49">Références</h3>
<h4 id="cis-49">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-49">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-44">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-49">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-051:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb53-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-51 : Services et démons résidents en mémoire&quot;</span></a>
<a class="sourceLine" id="cb53-2" title="2"></a>
<a class="sourceLine" id="cb53-3" title="3"><span class="co"># Fin: HARDE-RHEL-51</span></a>
<a class="sourceLine" id="cb53-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-50">Méthode d'audit</h3>
<h2 id="harde-rhel-052-">HARDE-RHEL-052 :</h2>
<h3 id="description-50">Description</h3>
<h3 id="références-50">Références</h3>
<h4 id="cis-50">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-50">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-45">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-50">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-052:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb54-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-52 : Restriction des accès des services déployés&quot;</span></a>
<a class="sourceLine" id="cb54-2" title="2"></a>
<a class="sourceLine" id="cb54-3" title="3"><span class="co"># Fin: HARDE-RHEL-52</span></a>
<a class="sourceLine" id="cb54-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-51">Méthode d'audit</h3>
<h2 id="harde-rhel-053-">HARDE-RHEL-053 :</h2>
<h3 id="description-51">Description</h3>
<h3 id="références-51">Références</h3>
<h4 id="cis-51">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-51">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-46">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-51">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-053:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb55-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-53 : Durcissement des composants de virtualisation&quot;</span></a>
<a class="sourceLine" id="cb55-2" title="2"></a>
<a class="sourceLine" id="cb55-3" title="3"><span class="co"># Fin: HARDE-RHEL-53</span></a>
<a class="sourceLine" id="cb55-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-52">Méthode d'audit</h3>
<h2 id="harde-rhel-054-">HARDE-RHEL-054 :</h2>
<h3 id="description-52">Description</h3>
<h3 id="références-52">Références</h3>
<h4 id="cis-52">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-52">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-47">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-52">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-054:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb56-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-54 : Cage chroot et privilèges d&#39;accès du service cloisonné&quot;</span></a>
<a class="sourceLine" id="cb56-2" title="2"></a>
<a class="sourceLine" id="cb56-3" title="3"><span class="co"># Fin: HARDE-RHEL-54</span></a>
<a class="sourceLine" id="cb56-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-53">Méthode d'audit</h3>
<h2 id="harde-rhel-055-">HARDE-RHEL-055 :</h2>
<h3 id="description-53">Description</h3>
<h3 id="références-53">Références</h3>
<h4 id="cis-53">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-53">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-48">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-53">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-055:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb57-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-55 : Activation et utilisation de chroot par un service&quot;</span></a>
<a class="sourceLine" id="cb57-2" title="2"></a>
<a class="sourceLine" id="cb57-3" title="3"><span class="co"># Fin: HARDE-RHEL-55</span></a>
<a class="sourceLine" id="cb57-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-54">Méthode d'audit</h3>
<h2 id="harde-rhel-056-">HARDE-RHEL-056 :</h2>
<h3 id="description-54">Description</h3>
<h3 id="références-54">Références</h3>
<h4 id="cis-54">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-54">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-49">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-54">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-056:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb58-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-56 : Ne pas installer xinetd&quot;</span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="ex">dnf</span> remove xinetd <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb58-3" title="3"><span class="co"># Fin: HARDE-RHEL-56</span></a>
<a class="sourceLine" id="cb58-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-55">Méthode d'audit</h3>
<h2 id="harde-rhel-057-">HARDE-RHEL-057 :</h2>
<h3 id="description-55">Description</h3>
<h3 id="références-55">Références</h3>
<h4 id="cis-55">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-55">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-50">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-55">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-057:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb59-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-57 : S&#39;assurer que le serveur FTP est désactivé&quot;</span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="ex">systemctl</span> --now disable vsftpd <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="co"># Fin: HARDE-RHEL-57</span></a>
<a class="sourceLine" id="cb59-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-56">Méthode d'audit</h3>
<h2 id="harde-rhel-058-">HARDE-RHEL-058 :</h2>
<h3 id="description-56">Description</h3>
<h3 id="références-56">Références</h3>
<h4 id="cis-56">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-56">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-51">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-56">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-058:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb60-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-58 : S&#39;assurer que le serveur DNS est désactivé&quot;</span></a>
<a class="sourceLine" id="cb60-2" title="2"><span class="ex">systemctl</span> --now disable named <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb60-3" title="3"><span class="co"># Fin: HARDE-RHEL-58</span></a>
<a class="sourceLine" id="cb60-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-57">Méthode d'audit</h3>
<h2 id="harde-rhel-059-">HARDE-RHEL-059 :</h2>
<h3 id="description-57">Description</h3>
<h3 id="références-57">Références</h3>
<h4 id="cis-57">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-57">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-52">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-57">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-059:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb61-1" title="1"><span class="co">#! /bin/bash</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-59 : S&#39;assurer que NFS est désactivé&quot;</span></a>
<a class="sourceLine" id="cb61-3" title="3"><span class="ex">systemctl</span> --now disable nfs-server <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb61-4" title="4"><span class="co"># Fin: HARDE-RHEL-59</span></a>
<a class="sourceLine" id="cb61-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-58">Méthode d'audit</h3>
<h2 id="harde-rhel-060-">HARDE-RHEL-060 :</h2>
<h3 id="description-58">Description</h3>
<h3 id="références-58">Références</h3>
<h4 id="cis-58">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-58">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-53">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-58">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-060:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb62-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-60 : S&#39;assurer que RPC est désactivé&quot;</span></a>
<a class="sourceLine" id="cb62-2" title="2"><span class="ex">systemctl</span> --now disable rpcbind <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb62-3" title="3"><span class="co"># Fin: HARDE-RHEL-60</span></a>
<a class="sourceLine" id="cb62-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-59">Méthode d'audit</h3>
<h2 id="harde-rhel-061-">HARDE-RHEL-061 :</h2>
<h3 id="description-59">Description</h3>
<h3 id="références-59">Références</h3>
<h4 id="cis-59">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-59">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-54">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-59">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-061:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb63-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-61 : S&#39;assurer que le serveur LDAP est désactivé&quot;</span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="ex">systemctl</span> --now disable slapd <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb63-3" title="3"><span class="co"># Fin: HARDE-RHEL-61</span></a>
<a class="sourceLine" id="cb63-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-60">Méthode d'audit</h3>
<h2 id="harde-rhel-062-">HARDE-RHEL-062 :</h2>
<h3 id="description-60">Description</h3>
<h3 id="références-60">Références</h3>
<h4 id="cis-60">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-60">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-55">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-60">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-062:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb64-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-62 : S&#39;assurer que le serveur DHCP est désactivé&quot;</span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="ex">systemctl</span> --now disable dhcpd <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb64-3" title="3"><span class="co"># Fin: HARDE-RHEL-62</span></a>
<a class="sourceLine" id="cb64-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-61">Méthode d'audit</h3>
<h2 id="harde-rhel-063-">HARDE-RHEL-063 :</h2>
<h3 id="description-61">Description</h3>
<h3 id="références-61">Références</h3>
<h4 id="cis-61">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-61">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-56">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-61">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-063:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb65-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-63 : S&#39;assurer que le serveur CUPS est désactivé&quot;</span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="ex">systemctl</span> --now disable cups <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb65-3" title="3"><span class="co"># Fin: HARDE-RHEL-63</span></a>
<a class="sourceLine" id="cb65-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-62">Méthode d'audit</h3>
<h2 id="harde-rhel-064-">HARDE-RHEL-064 :</h2>
<h3 id="description-62">Description</h3>
<h3 id="références-62">Références</h3>
<h4 id="cis-62">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-62">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-57">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-62">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-064:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb66-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-64 : S&#39;assurer que le serveur NIS est désactivé&quot;</span></a>
<a class="sourceLine" id="cb66-2" title="2"><span class="ex">systemctl</span> --now disable ypserv <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb66-3" title="3"><span class="co"># Fin: HARDE-RHEL-64</span></a>
<a class="sourceLine" id="cb66-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-63">Méthode d'audit</h3>
<h2 id="harde-rhel-065-">HARDE-RHEL-065 :</h2>
<h3 id="description-63">Description</h3>
<h3 id="références-63">Références</h3>
<h4 id="cis-63">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-63">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-58">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-63">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-065:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb67-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-65 : S&#39;assurer que l&#39;agent de transfert de mail soit en mode local seulement&quot;</span></a>
<a class="sourceLine" id="cb67-2" title="2"></a>
<a class="sourceLine" id="cb67-3" title="3"><span class="co"># Fin: HARDE-RHEL-65</span></a>
<a class="sourceLine" id="cb67-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-64">Méthode d'audit</h3>
<h2 id="harde-rhel-066-">HARDE-RHEL-066 :</h2>
<h3 id="description-64">Description</h3>
<h3 id="références-64">Références</h3>
<h4 id="cis-64">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-64">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-59">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-64">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-066:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb68-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-66 : Désactiver le service rsyncd&quot;</span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="ex">systemctl</span> --now disable rsyncd <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="co"># Fin: HARDE-RHEL-66</span></a>
<a class="sourceLine" id="cb68-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-65">Méthode d'audit</h3>
<h2 id="harde-rhel-067-">HARDE-RHEL-067 :</h2>
<h3 id="description-65">Description</h3>
<h3 id="références-65">Références</h3>
<h4 id="cis-65">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-65">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-60">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-65">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-067:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb69-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-67 : S&#39;assurer que le serveur Avahi est désactivé&quot;</span></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="ex">systemctl</span> --now disable avahi-daemon <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb69-3" title="3"><span class="co"># Fin: HARDE-RHEL-67</span></a>
<a class="sourceLine" id="cb69-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-66">Méthode d'audit</h3>
<h2 id="harde-rhel-068-">HARDE-RHEL-068 :</h2>
<h3 id="description-66">Description</h3>
<h3 id="références-66">Références</h3>
<h4 id="cis-66">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-66">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-61">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-66">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-068:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb70-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-68 : S&#39;assurer que le serveur SNMP est désactivé&quot;</span></a>
<a class="sourceLine" id="cb70-2" title="2"><span class="ex">systemctl</span> --now disable snmpd <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb70-3" title="3"><span class="co"># Fin: HARDE-RHEL-68</span></a>
<a class="sourceLine" id="cb70-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-67">Méthode d'audit</h3>
<h2 id="harde-rhel-069-">HARDE-RHEL-069 :</h2>
<h3 id="description-67">Description</h3>
<h3 id="références-67">Références</h3>
<h4 id="cis-67">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-67">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-62">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-67">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-069:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb71-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-69 : S&#39;assurer que le service Proxy HTTP est désactivé&quot;</span></a>
<a class="sourceLine" id="cb71-2" title="2"><span class="ex">systemctl</span> --now disable squid <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="co"># Fin: HARDE-RHEL-69</span></a>
<a class="sourceLine" id="cb71-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-68">Méthode d'audit</h3>
<h2 id="harde-rhel-070-">HARDE-RHEL-070 :</h2>
<h3 id="description-68">Description</h3>
<h3 id="références-68">Références</h3>
<h4 id="cis-68">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-68">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-63">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-68">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-070:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb72-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-70 : S&#39;assurer que le service Samba  est désactivé&quot;</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="ex">systemctl</span> --now disable smb <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb72-3" title="3"><span class="co"># Fin: HARDE-RHEL-70</span></a>
<a class="sourceLine" id="cb72-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-69">Méthode d'audit</h3>
<h2 id="harde-rhel-071-">HARDE-RHEL-071 :</h2>
<h3 id="description-69">Description</h3>
<h3 id="références-69">Références</h3>
<h4 id="cis-69">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-69">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-64">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-69">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-071:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb73-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-71 : S&#39;assurer que le service IMAP/POP3 est désactivé&quot;</span></a>
<a class="sourceLine" id="cb73-2" title="2"><span class="ex">systemctl</span> --now disable dovecot <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb73-3" title="3"><span class="co"># Fin: HARDE-RHEL-71</span></a>
<a class="sourceLine" id="cb73-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-70">Méthode d'audit</h3>
<h2 id="harde-rhel-072-">HARDE-RHEL-072 :</h2>
<h3 id="description-70">Description</h3>
<h3 id="références-70">Références</h3>
<h4 id="cis-70">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-70">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-65">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-70">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-072:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb74-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-72 : S&#39;assurer que le serveur HTTP est désactivé&quot;</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="ex">systemctl</span> --now disable httpd <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb74-3" title="3"><span class="co"># Fin: HARDE-RHEL-72</span></a>
<a class="sourceLine" id="cb74-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-71">Méthode d'audit</h3>
<h2 id="harde-rhel-073-">HARDE-RHEL-073 :</h2>
<h3 id="description-71">Description</h3>
<h3 id="références-71">Références</h3>
<h4 id="cis-71">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-71">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-66">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-71">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-073:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb75-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-73 : Désactiver les protocoles DDCP, SCTP, RDS et TIPC&quot;</span></a>
<a class="sourceLine" id="cb75-2" title="2"><span class="kw">for</span> <span class="ex">i</span> in dccp sctp rds tipc<span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb75-3" title="3"><span class="fu">cat</span> <span class="op">&gt;</span><span class="st">&quot;/etc/modprobe.d/</span><span class="va">$i</span><span class="st">.conf&quot;</span> <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb75-4" title="4">install <span class="va">$i</span> /bin/true</a>
<a class="sourceLine" id="cb75-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb75-6" title="6"><span class="ex">rmmod</span> <span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span> <span class="kw">||</span> <span class="fu">true</span> <span class="kw">;</span> <span class="kw">done</span></a>
<a class="sourceLine" id="cb75-7" title="7"><span class="co"># Fin: HARDE-RHEL-73</span></a>
<a class="sourceLine" id="cb75-8" title="8"></a></code></pre></div>
<h3 id="méthode-daudit-72">Méthode d'audit</h3>
<h2 id="harde-rhel-074-">HARDE-RHEL-074 :</h2>
<h3 id="description-72">Description</h3>
<h3 id="références-72">Références</h3>
<h4 id="cis-72">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-72">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-67">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-72">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-074:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb76-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-74 : Durcissement et surveillance des services soumis à des flux arbitraires&quot;</span></a>
<a class="sourceLine" id="cb76-2" title="2"></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="co"># Fin: HARDE-RHEL-74</span></a>
<a class="sourceLine" id="cb76-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-73">Méthode d'audit</h3>
<h2 id="harde-rhel-075-">HARDE-RHEL-075 :</h2>
<h3 id="description-73">Description</h3>
<h3 id="références-73">Références</h3>
<h4 id="cis-73">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-73">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-68">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-73">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-075:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb77-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-75 : Configuration du service local de messagerie&quot;</span></a>
<a class="sourceLine" id="cb77-2" title="2"></a>
<a class="sourceLine" id="cb77-3" title="3"><span class="co"># Fin: HARDE-RHEL-75</span></a>
<a class="sourceLine" id="cb77-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-74">Méthode d'audit</h3>
<h2 id="harde-rhel-076-">HARDE-RHEL-076 :</h2>
<h3 id="description-74">Description</h3>
<h3 id="références-74">Références</h3>
<h4 id="cis-74">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-74">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-69">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-74">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-076:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb78-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-76 : Alias de messagerie des comptes de service&quot;</span></a>
<a class="sourceLine" id="cb78-2" title="2"></a>
<a class="sourceLine" id="cb78-3" title="3"><span class="co"># Fin: HARDE-RHEL-76</span></a>
<a class="sourceLine" id="cb78-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-75">Méthode d'audit</h3>
<h2 id="harde-rhel-077-">HARDE-RHEL-077 :</h2>
<h3 id="description-75">Description</h3>
<h3 id="références-75">Références</h3>
<h4 id="cis-75">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-75">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-70">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-75">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-077:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb79-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-77 : S&#39;assurer que firewalld est installé&quot;</span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="ex">dnf</span> install firewalld</a>
<a class="sourceLine" id="cb79-3" title="3"><span class="co"># Fin: HARDE-RHEL-77</span></a>
<a class="sourceLine" id="cb79-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-76">Méthode d'audit</h3>
<h2 id="harde-rhel-078-">HARDE-RHEL-078 :</h2>
<h3 id="description-76">Description</h3>
<h3 id="références-76">Références</h3>
<h4 id="cis-76">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-76">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-71">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-76">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-078:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb80-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-78 : Activer le service firewalld&quot;</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="ex">systemctl</span> --now enable firewalld</a>
<a class="sourceLine" id="cb80-3" title="3"><span class="co"># Fin: HARDE-RHEL-78</span></a>
<a class="sourceLine" id="cb80-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-77">Méthode d'audit</h3>
<h2 id="harde-rhel-079-">HARDE-RHEL-079 :</h2>
<h3 id="description-77">Description</h3>
<h3 id="références-77">Références</h3>
<h4 id="cis-77">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-77">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-72">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-77">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-079:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb81-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-79 : Désactiver iptables&quot;</span></a>
<a class="sourceLine" id="cb81-2" title="2"><span class="ex">systemctl</span> --now mask iptables</a>
<a class="sourceLine" id="cb81-3" title="3"><span class="co"># Fin: HARDE-RHEL-79</span></a>
<a class="sourceLine" id="cb81-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-78">Méthode d'audit</h3>
<h2 id="harde-rhel-080-">HARDE-RHEL-080 :</h2>
<h3 id="description-78">Description</h3>
<h3 id="références-78">Références</h3>
<h4 id="cis-78">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-78">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-73">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-78">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-080:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb82-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-80 : Désactiver nftables&quot;</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="ex">systemctl</span> --now mask nftables</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="co"># Fin: HARDE-RHEL-80</span></a>
<a class="sourceLine" id="cb82-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-79">Méthode d'audit</h3>
<h2 id="harde-rhel-081-">HARDE-RHEL-081 :</h2>
<h3 id="description-79">Description</h3>
<h3 id="références-79">Références</h3>
<h4 id="cis-79">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-79">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-74">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-79">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-081:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb83-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-81 : S&#39;assurer qu&#39;une zone par défaut est définie&quot;</span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="ex">firewall-cmd</span> --set-default-zone=public</a>
<a class="sourceLine" id="cb83-3" title="3"><span class="co"># Fin: HARDE-RHEL-81</span></a>
<a class="sourceLine" id="cb83-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-80">Méthode d'audit</h3>
<h2 id="harde-rhel-082-">HARDE-RHEL-082 :</h2>
<h3 id="description-80">Description</h3>
<h3 id="références-80">Références</h3>
<h4 id="cis-80">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-80">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-75">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-80">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-082:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb84-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-82 : S&#39;assurer que les interfaces soient assignées à une zone&quot;</span></a>
<a class="sourceLine" id="cb84-2" title="2"><span class="va">ITF=</span><span class="st">&quot;</span><span class="va">$(</span><span class="ex">nmcli</span> --terse connection show <span class="kw">|</span><span class="fu">awk</span> -F: <span class="st">&#39;{print $1}&#39;</span><span class="va">)</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb84-3" title="3"><span class="ex">firewall-cmd</span> --zone=public --change-interface=<span class="st">&quot;</span><span class="va">${ITF}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb84-4" title="4"><span class="co"># Fin: HARDE-RHEL-82</span></a>
<a class="sourceLine" id="cb84-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-81">Méthode d'audit</h3>
<h2 id="harde-rhel-083-">HARDE-RHEL-083 :</h2>
<h3 id="description-81">Description</h3>
<h3 id="références-81">Références</h3>
<h4 id="cis-81">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-81">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-76">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-81">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-083:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb85-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-83 : Bloquer les services et ports inutiles&quot;</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="ex">firewall-cmd</span> --remove-service=cockpit</a>
<a class="sourceLine" id="cb85-3" title="3"><span class="ex">firewall-cmd</span> --runtime-to-permanent</a>
<a class="sourceLine" id="cb85-4" title="4"><span class="co"># Fin: HARDE-RHEL-83</span></a>
<a class="sourceLine" id="cb85-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-82">Méthode d'audit</h3>
<h2 id="harde-rhel-084-">HARDE-RHEL-084 :</h2>
<h3 id="description-82">Description</h3>
<h3 id="références-82">Références</h3>
<h4 id="cis-82">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-82">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-77">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-82">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-084:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb86-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-84 : Configurer nftables&quot;</span></a>
<a class="sourceLine" id="cb86-2" title="2"></a>
<a class="sourceLine" id="cb86-3" title="3"><span class="co"># Fin: HARDE-RHEL-84</span></a>
<a class="sourceLine" id="cb86-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-83">Méthode d'audit</h3>
<h2 id="harde-rhel-085-">HARDE-RHEL-085 :</h2>
<h3 id="description-83">Description</h3>
<h3 id="références-83">Références</h3>
<h4 id="cis-83">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-83">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-78">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-83">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-085:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb87-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-85 : Configurer iptables&quot;</span></a>
<a class="sourceLine" id="cb87-2" title="2"></a>
<a class="sourceLine" id="cb87-3" title="3"><span class="co"># Fin: HARDE-RHEL-85</span></a>
<a class="sourceLine" id="cb87-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-84">Méthode d'audit</h3>
<h2 id="harde-rhel-086-">HARDE-RHEL-086 :</h2>
<h3 id="description-84">Description</h3>
<h3 id="références-84">Références</h3>
<h4 id="cis-84">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-84">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-79">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-84">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-086:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb88-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-86 : Désactiver les interfaces sans fil&quot;</span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="ex">nmcli</span> radio all off</a>
<a class="sourceLine" id="cb88-3" title="3"><span class="co"># Fin: HARDE-RHEL-86</span></a>
<a class="sourceLine" id="cb88-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-85">Méthode d'audit</h3>
<h2 id="harde-rhel-087-">HARDE-RHEL-087 :</h2>
<h3 id="description-85">Description</h3>
<h3 id="références-85">Références</h3>
<h4 id="cis-85">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-85">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-80">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-85">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-087:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb89-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-87 : Activation de SELinux avec la politique targeted&quot;</span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="ex">selinuxenabled</span> <span class="kw">||</span> <span class="ex">setenforce</span> 1 </a>
<a class="sourceLine" id="cb89-3" title="3"><span class="ex">fixfiles</span> onboot</a>
<a class="sourceLine" id="cb89-4" title="4"><span class="co"># Fin: HARDE-RHEL-87</span></a>
<a class="sourceLine" id="cb89-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-86">Méthode d'audit</h3>
<h2 id="harde-rhel-088-">HARDE-RHEL-088 :</h2>
<h3 id="description-86">Description</h3>
<h3 id="références-86">Références</h3>
<h4 id="cis-86">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-86">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-81">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-86">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-088:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb90-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-88 : Désinstallation des outils de débogage de politique SELinux&quot;</span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="ex">dnf</span> remove settroubleshoot mcstrans</a>
<a class="sourceLine" id="cb90-3" title="3"><span class="co"># Fin: HARDE-RHEL-88</span></a>
<a class="sourceLine" id="cb90-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-87">Méthode d'audit</h3>
<h2 id="harde-rhel-089-">HARDE-RHEL-089 :</h2>
<h3 id="description-87">Description</h3>
<h3 id="références-87">Références</h3>
<h4 id="cis-87">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-87">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-82">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-87">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-089:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb91-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-89 : S&#39;assurer que at/cron est restreint aux utilisateurs autorisés&quot;</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="fu">rm</span> -f /etc/cron.deny</a>
<a class="sourceLine" id="cb91-3" title="3"><span class="fu">rm</span> -f /etc/at.deny</a>
<a class="sourceLine" id="cb91-4" title="4"><span class="fu">true</span> <span class="op">&gt;</span> /etc/cron.allow</a>
<a class="sourceLine" id="cb91-5" title="5"><span class="fu">true</span> <span class="op">&gt;</span> /etc/at.allow</a>
<a class="sourceLine" id="cb91-6" title="6"><span class="fu">chmod</span> og-rwx /etc/cron.allow</a>
<a class="sourceLine" id="cb91-7" title="7"><span class="fu">chmod</span> og-rwx /etc/at.allow</a>
<a class="sourceLine" id="cb91-8" title="8"><span class="fu">chown</span> root:root /etc/cron.allow</a>
<a class="sourceLine" id="cb91-9" title="9"><span class="fu">chown</span> root:root /etc/at.allow</a>
<a class="sourceLine" id="cb91-10" title="10"><span class="co"># Fin: HARDE-RHEL-89</span></a>
<a class="sourceLine" id="cb91-11" title="11"></a></code></pre></div>
<h3 id="méthode-daudit-88">Méthode d'audit</h3>
<h2 id="harde-rhel-090-">HARDE-RHEL-090 :</h2>
<h3 id="description-88">Description</h3>
<h3 id="références-88">Références</h3>
<h4 id="cis-88">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-88">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-83">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-88">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-090:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb92-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-90 : S&#39;assurer que l&#39;accès SSH soit limité&quot;</span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^AllowGroups sudogrp&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;AllowGroups sudogrp&quot;</span> <span class="op">&gt;&gt;</span> /etc/ssh/ssd_config <span class="kw">;fi</span> </a>
<a class="sourceLine" id="cb92-3" title="3"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^DenyUsers root&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;DenyUsers root&quot;</span> <span class="op">&gt;&gt;</span> /etc/ssh/ssd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb92-4" title="4"><span class="co"># Fin: HARDE-RHEL-90</span></a>
<a class="sourceLine" id="cb92-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-89">Méthode d'audit</h3>
<h2 id="harde-rhel-091-">HARDE-RHEL-091 :</h2>
<h3 id="description-89">Description</h3>
<h3 id="références-89">Références</h3>
<h4 id="cis-89">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-89">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-84">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-89">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-091:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb93-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-91 : S&#39;assurer que l&#39;accès à la commande su est limité&quot;</span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="ex">usermod</span> -a -G wheel root</a>
<a class="sourceLine" id="cb93-3" title="3"><span class="co"># Fin: HARDE-RHEL-91</span></a>
<a class="sourceLine" id="cb93-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-90">Méthode d'audit</h3>
<h2 id="harde-rhel-092-">HARDE-RHEL-092 :</h2>
<h3 id="description-90">Description</h3>
<h3 id="références-90">Références</h3>
<h4 id="cis-90">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-90">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-85">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-90">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-092:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb94-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-92 : S&#39;assurer de l&#39;intégrité de la variable PATH pour root&quot;</span></a>
<a class="sourceLine" id="cb94-2" title="2"></a>
<a class="sourceLine" id="cb94-3" title="3"><span class="co"># Fin: HARDE-RHEL-92</span></a>
<a class="sourceLine" id="cb94-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-91">Méthode d'audit</h3>
<h2 id="harde-rhel-093-">HARDE-RHEL-093 :</h2>
<h3 id="description-91">Description</h3>
<h3 id="références-91">Références</h3>
<h4 id="cis-91">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-91">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-86">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-91">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-093:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb95-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-93 : Imputabilité des opérations d&#39;administration&quot;</span></a>
<a class="sourceLine" id="cb95-2" title="2"></a>
<a class="sourceLine" id="cb95-3" title="3"><span class="co"># Fin: HARDE-RHEL-93</span></a>
<a class="sourceLine" id="cb95-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-92">Méthode d'audit</h3>
<h2 id="harde-rhel-094-">HARDE-RHEL-094 :</h2>
<h3 id="description-92">Description</h3>
<h3 id="références-92">Références</h3>
<h4 id="cis-92">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-92">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-87">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-92">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-094:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb96-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-94 : Répertoires temporaires dédiés aux comptes&quot;</span></a>
<a class="sourceLine" id="cb96-2" title="2"><span class="ex">setsebool</span> -P polyinstantiation_enabled=on</a>
<a class="sourceLine" id="cb96-3" title="3"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/secure_namespace.sh <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb96-4" title="4">#! /bin/bash</a>
<a class="sourceLine" id="cb96-5" title="5"></a>
<a class="sourceLine" id="cb96-6" title="6">function copy_se_labels() {</a>
<a class="sourceLine" id="cb96-7" title="7">    # copy SElinux labels from <span class="va">$1</span> to <span class="va">$2</span></a>
<a class="sourceLine" id="cb96-8" title="8">    # use copy_se_labels /var/www /srv/www(/.*)?</a>
<a class="sourceLine" id="cb96-9" title="9">    semanage fcontext --modify --equal &quot;<span class="va">$1</span>&quot; &quot;<span class="va">$2</span>&quot; || true</a>
<a class="sourceLine" id="cb96-10" title="10">    restorecon -R &quot;<span class="va">$2</span>&quot;</a>
<a class="sourceLine" id="cb96-11" title="11">}</a>
<a class="sourceLine" id="cb96-12" title="12"># As /tmp is cleaned at each reboot, recreate them as needed</a>
<a class="sourceLine" id="cb96-13" title="13">if ! [ -d /tmp/namespace ] ; then</a>
<a class="sourceLine" id="cb96-14" title="14">    mkdir /tmp/namespace </a>
<a class="sourceLine" id="cb96-15" title="15">fi </a>
<a class="sourceLine" id="cb96-16" title="16">if ! [ -d /var/tmp/namespace ] ; then</a>
<a class="sourceLine" id="cb96-17" title="17">    mkdir /var/tmp/namespace</a>
<a class="sourceLine" id="cb96-18" title="18">fi</a>
<a class="sourceLine" id="cb96-19" title="19">chmod 000 /tmp/namespace</a>
<a class="sourceLine" id="cb96-20" title="20">#chcon --reference=/tmp /tmp/namespace</a>
<a class="sourceLine" id="cb96-21" title="21">copy_se_labels /tmp /tmp/namespace</a>
<a class="sourceLine" id="cb96-22" title="22">chmod 000 /var/tmp/namespace </a>
<a class="sourceLine" id="cb96-23" title="23">#chcon --reference=/var/tmp /var/tmp/namespace</a>
<a class="sourceLine" id="cb96-24" title="24">copy_se_labels /var/tmp /var/tmp/namespace</a>
<a class="sourceLine" id="cb96-25" title="25"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb96-26" title="26"><span class="fu">chmod</span> 0700 /etc/secure_namespace.sh</a>
<a class="sourceLine" id="cb96-27" title="27"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/system/secure_namespace.service<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb96-28" title="28">[Unit]</a>
<a class="sourceLine" id="cb96-29" title="29">Description=Script to create the required directories for pam_namespace</a>
<a class="sourceLine" id="cb96-30" title="30"></a>
<a class="sourceLine" id="cb96-31" title="31">[Service]</a>
<a class="sourceLine" id="cb96-32" title="32">Type=oneshot</a>
<a class="sourceLine" id="cb96-33" title="33">ExecStart=/etc/secure_namespace.sh</a>
<a class="sourceLine" id="cb96-34" title="34">TimeoutStartSec=0</a>
<a class="sourceLine" id="cb96-35" title="35"></a>
<a class="sourceLine" id="cb96-36" title="36">[Install]</a>
<a class="sourceLine" id="cb96-37" title="37">WantedBy=multi-user.target</a>
<a class="sourceLine" id="cb96-38" title="38"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb96-39" title="39"><span class="ex">systemctl</span> enable secure_namespace</a>
<a class="sourceLine" id="cb96-40" title="40"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/security/namespace.d/10tmp.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb96-41" title="41">/tmp     /tmp/namespace/        level      root</a>
<a class="sourceLine" id="cb96-42" title="42">/var/tmp /var/tmp/namespace/    level      root</a>
<a class="sourceLine" id="cb96-43" title="43"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb96-44" title="44"><span class="co"># Fin: HARDE-RHEL-94</span></a>
<a class="sourceLine" id="cb96-45" title="45"></a></code></pre></div>
<h3 id="méthode-daudit-93">Méthode d'audit</h3>
<h2 id="harde-rhel-095-">HARDE-RHEL-095 :</h2>
<h3 id="description-93">Description</h3>
<h3 id="références-93">Références</h3>
<h4 id="cis-93">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-93">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-88">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-93">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-095:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb97-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-95 : Activation des profils de sécurité AppArmor&quot;</span></a>
<a class="sourceLine" id="cb97-2" title="2"></a>
<a class="sourceLine" id="cb97-3" title="3"><span class="co"># Fin: HARDE-RHEL-95</span></a>
<a class="sourceLine" id="cb97-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-94">Méthode d'audit</h3>
<h2 id="harde-rhel-096-">HARDE-RHEL-096 :</h2>
<h3 id="description-94">Description</h3>
<h3 id="références-94">Références</h3>
<h4 id="cis-94">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-94">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-89">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-94">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-096:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb98-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-96 : Paramétrage des booléens SELinux&quot;</span></a>
<a class="sourceLine" id="cb98-2" title="2"><span class="ex">setsebool</span> -P allow_execheap=off</a>
<a class="sourceLine" id="cb98-3" title="3"><span class="ex">setsebool</span> -P allow_execstack=off</a>
<a class="sourceLine" id="cb98-4" title="4"><span class="co"># paramètrage appliqué dynamiquement à la fin du processus de boot : setsebool -P secure_mode_insmod=on</span></a>
<a class="sourceLine" id="cb98-5" title="5"><span class="co"># A passer à on si des administrateurs doivent se connecter à distance</span></a>
<a class="sourceLine" id="cb98-6" title="6"><span class="bu">echo</span> -n <span class="st">&quot;Autoriser les administrateurs à se connecter par SSH ? &quot;</span><span class="kw">;</span> <span class="bu">read</span> -e -i <span class="st">&quot;O&quot;</span> -r <span class="va">ADMINSSH</span></a>
<a class="sourceLine" id="cb98-7" title="7"><span class="kw">if</span><span class="bu"> [</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">${ADMINSSH}</span><span class="st">&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb98-8" title="8">    <span class="ex">setsebool</span> -P ssh_sysadm_login=off</a>
<a class="sourceLine" id="cb98-9" title="9"><span class="kw">else</span></a>
<a class="sourceLine" id="cb98-10" title="10">    <span class="ex">setsebool</span> -P ssh_sysadm_login=on</a>
<a class="sourceLine" id="cb98-11" title="11"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb98-12" title="12"><span class="bu">echo</span></a>
<a class="sourceLine" id="cb98-13" title="13"><span class="co"># Fin: HARDE-RHEL-96</span></a>
<a class="sourceLine" id="cb98-14" title="14"></a></code></pre></div>
<h3 id="méthode-daudit-95">Méthode d'audit</h3>
<h2 id="harde-rhel-097-">HARDE-RHEL-097 :</h2>
<h3 id="description-95">Description</h3>
<h3 id="références-95">Références</h3>
<h4 id="cis-95">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-95">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-90">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-95">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-097:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb99-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-97 : Confinement des utilisateurs interactifs non privilégiés&quot;</span></a>
<a class="sourceLine" id="cb99-2" title="2"><span class="co"># Find at least one user to add to sudogrp</span></a>
<a class="sourceLine" id="cb99-3" title="3"><span class="va">USER1000=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">grep</span> 1000 /etc/passwd <span class="kw">|</span> <span class="fu">awk</span> -F: <span class="st">&#39;{print $1}&#39;</span><span class="va">)</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb99-4" title="4"><span class="bu">echo</span> -n <span class="st">&quot;Merci de préciser le nom d&#39;un utilisateur à qui donner des droits administrateur [</span><span class="va">$USER1000</span><span class="st">] ? &quot;</span> <span class="kw">;</span> <span class="bu">read</span> -e -i <span class="st">&quot;</span><span class="va">$USER1000</span><span class="st">&quot;</span> -r <span class="va">ADMINUSER</span></a>
<a class="sourceLine" id="cb99-5" title="5"><span class="kw">if</span><span class="bu"> [</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb99-6" title="6">    <span class="va">ADMINUSER=</span><span class="st">&quot;</span><span class="va">${USER1000}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb99-7" title="7"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb99-8" title="8"><span class="ex">groupadd</span> -r -f sudogrp</a>
<a class="sourceLine" id="cb99-9" title="9"><span class="bu">echo</span> <span class="st">&quot;%sudogrp    ALL=(ALL)  TYPE=unconfined_t ROLE=unconfined_r    ALL&quot;</span> <span class="op">&gt;</span>/etc/sudoers.d/15group</a>
<a class="sourceLine" id="cb99-10" title="10"><span class="co">#usermod -Z sysadm_u &quot;${ADMINUSER}&quot;</span></a>
<a class="sourceLine" id="cb99-11" title="11"><span class="ex">semanage</span> login -a -s staff_u -rs0:c0.c1023 <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span> <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb99-12" title="12"><span class="ex">usermod</span> -G sudogrp <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb99-13" title="13"><span class="co"># For unprivileged user, use usermod -Z user_u &lt;unprivileged&gt;</span></a>
<a class="sourceLine" id="cb99-14" title="14"><span class="ex">semanage</span> login -m -r s0 -s user_u __default__</a>
<a class="sourceLine" id="cb99-15" title="15"><span class="co"># restorecon is required at this point and will be performed on reboot</span></a>
<a class="sourceLine" id="cb99-16" title="16"><span class="co"># Fin: HARDE-RHEL-97</span></a>
<a class="sourceLine" id="cb99-17" title="17"></a></code></pre></div>
<h3 id="méthode-daudit-96">Méthode d'audit</h3>
<h2 id="harde-rhel-098-">HARDE-RHEL-098 :</h2>
<h3 id="description-96">Description</h3>
<h3 id="références-96">Références</h3>
<h4 id="cis-96">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-96">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-91">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-96">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-098:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb100-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-98 : Utiliser une source de temps&quot;</span></a>
<a class="sourceLine" id="cb100-2" title="2"><span class="ex">dnf</span> install chrony</a>
<a class="sourceLine" id="cb100-3" title="3"><span class="co"># Fin: HARDE-RHEL-98</span></a>
<a class="sourceLine" id="cb100-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-97">Méthode d'audit</h3>
<h2 id="harde-rhel-099-">HARDE-RHEL-099 :</h2>
<h3 id="description-97">Description</h3>
<h3 id="références-97">Références</h3>
<h4 id="cis-97">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-97">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-92">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-97">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-099:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb101-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-99 : S&#39;assurer que chrony est configuré&quot;</span></a>
<a class="sourceLine" id="cb101-2" title="2"></a>
<a class="sourceLine" id="cb101-3" title="3"><span class="co"># Fin: HARDE-RHEL-99</span></a>
<a class="sourceLine" id="cb101-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-98">Méthode d'audit</h3>
<h2 id="harde-rhel-100-">HARDE-RHEL-100 :</h2>
<h3 id="description-98">Description</h3>
<h3 id="références-98">Références</h3>
<h4 id="cis-98">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-98">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-93">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-98">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-100:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb102-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-100 : Service autofs désactivé&quot;</span></a>
<a class="sourceLine" id="cb102-2" title="2"></a>
<a class="sourceLine" id="cb102-3" title="3"><span class="co"># Fin: HARDE-RHEL-100</span></a>
<a class="sourceLine" id="cb102-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-99">Méthode d'audit</h3>
<h2 id="harde-rhel-101-">HARDE-RHEL-101 :</h2>
<h3 id="description-99">Description</h3>
<h3 id="références-99">Références</h3>
<h4 id="cis-99">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-99">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-94">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-99">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-101:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb103-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-101 : Supprimer le serveur X&quot;</span></a>
<a class="sourceLine" id="cb103-2" title="2"><span class="ex">dnf</span> remove xorg-x11*.*</a>
<a class="sourceLine" id="cb103-3" title="3"><span class="co"># Fin: HARDE-RHEL-101</span></a>
<a class="sourceLine" id="cb103-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-100">Méthode d'audit</h3>
<h2 id="harde-rhel-102-">HARDE-RHEL-102 :</h2>
<h3 id="description-100">Description</h3>
<h3 id="références-100">Références</h3>
<h4 id="cis-100">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-100">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-95">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-100">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-102:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb104-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-102 : S&#39;assurer que le client NIS n&#39;est pas installé&quot;</span></a>
<a class="sourceLine" id="cb104-2" title="2"><span class="ex">dnf</span> remove ypbind</a>
<a class="sourceLine" id="cb104-3" title="3"><span class="co"># Fin: HARDE-RHEL-102</span></a>
<a class="sourceLine" id="cb104-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-101">Méthode d'audit</h3>
<h2 id="harde-rhel-103-">HARDE-RHEL-103 :</h2>
<h3 id="description-101">Description</h3>
<h3 id="références-101">Références</h3>
<h4 id="cis-101">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-101">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-96">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-101">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-103:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb105-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-103 : S&#39;assurer que le client telnet n&#39;est pas installé&quot;</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="ex">dnf</span> remove telnet</a>
<a class="sourceLine" id="cb105-3" title="3"><span class="co"># Fin: HARDE-RHEL-103</span></a>
<a class="sourceLine" id="cb105-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-102">Méthode d'audit</h3>
<h2 id="harde-rhel-104-">HARDE-RHEL-104 :</h2>
<h3 id="description-102">Description</h3>
<h3 id="références-102">Références</h3>
<h4 id="cis-102">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-102">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-97">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-102">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-104:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb106-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-104 : S&#39;assurer que le client ldap n&#39;est pas installé&quot;</span></a>
<a class="sourceLine" id="cb106-2" title="2"></a>
<a class="sourceLine" id="cb106-3" title="3"><span class="co"># Fin: HARDE-RHEL-104</span></a>
<a class="sourceLine" id="cb106-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-103">Méthode d'audit</h3>
<h2 id="harde-rhel-105-">HARDE-RHEL-105 :</h2>
<h3 id="description-103">Description</h3>
<h3 id="références-103">Références</h3>
<h4 id="cis-103">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-103">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-98">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-103">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-105:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb107-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-105 : S&#39;assurer que le paramètre SSH AllowTcpForwarding est désactivé&quot;</span></a>
<a class="sourceLine" id="cb107-2" title="2"><span class="fu">sed</span> -i -e <span class="st">&#39;s/\(^AllowTcpForwarding yes\)/\#HARDE-RHEL-105: \1/&#39;</span> /etc/ssh/sshd_config</a>
<a class="sourceLine" id="cb107-3" title="3"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^AllowTcpForwarding&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;AllowTcpForwarding no&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb107-4" title="4"><span class="co"># Fin: HARDE-RHEL-105</span></a>
<a class="sourceLine" id="cb107-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-104">Méthode d'audit</h3>
<h2 id="harde-rhel-106-">HARDE-RHEL-106 :</h2>
<h3 id="description-104">Description</h3>
<h3 id="références-104">Références</h3>
<h4 id="cis-104">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-104">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-99">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-104">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-106:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb108-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-106 : S&#39;assurer que le transfert X11 SSH est désactivé&quot;</span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="fu">sed</span> -i -e <span class="st">&#39;s/\(^X11Forwarding yes\)/\#HARDE-RHEL-106: \1/&#39;</span> /etc/ssh/sshd_config</a>
<a class="sourceLine" id="cb108-3" title="3"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^X11Forwarding\s+no&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;X11Forwarding no&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb108-4" title="4"><span class="co"># Fin: HARDE-RHEL-106</span></a>
<a class="sourceLine" id="cb108-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-105">Méthode d'audit</h3>
<h2 id="harde-rhel-107-">HARDE-RHEL-107 :</h2>
<h3 id="description-105">Description</h3>
<h3 id="références-105">Références</h3>
<h4 id="cis-105">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-105">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-100">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-105">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-107:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb109-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-107 : Installer sudo&quot;</span></a>
<a class="sourceLine" id="cb109-2" title="2"><span class="ex">dnf</span> install sudo</a>
<a class="sourceLine" id="cb109-3" title="3"><span class="co"># Fin: HARDE-RHEL-107</span></a>
<a class="sourceLine" id="cb109-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-106">Méthode d'audit</h3>
<h2 id="harde-rhel-108-">HARDE-RHEL-108 :</h2>
<h3 id="description-106">Description</h3>
<h3 id="références-106">Références</h3>
<h4 id="cis-106">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-106">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-101">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-106">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-108:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb110-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-108 : S&#39;assurer que les commandes sudo utilisent un pseudo-TTY et autres directives&quot;</span></a>
<a class="sourceLine" id="cb110-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sudoers.d/10secure <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb110-3" title="3">#Defaults noexec</a>
<a class="sourceLine" id="cb110-4" title="4">#Defaults use_pty</a>
<a class="sourceLine" id="cb110-5" title="5">Defaults requiretty,umask=0027</a>
<a class="sourceLine" id="cb110-6" title="6">Defaults ignore_dot,env_reset,passwd_timeout=1</a>
<a class="sourceLine" id="cb110-7" title="7">Defaults timestamp_timeout=5</a>
<a class="sourceLine" id="cb110-8" title="8"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb110-9" title="9"><span class="co"># Fin: HARDE-RHEL-108</span></a>
<a class="sourceLine" id="cb110-10" title="10"></a></code></pre></div>
<h3 id="méthode-daudit-107">Méthode d'audit</h3>
<h2 id="harde-rhel-109-">HARDE-RHEL-109 :</h2>
<h3 id="description-107">Description</h3>
<h3 id="références-107">Références</h3>
<h4 id="cis-107">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-107">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-102">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-107">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-109:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb111-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-109 : Afficher des bannières lors de la connexion&quot;</span></a>
<a class="sourceLine" id="cb111-2" title="2"><span class="kw">for</span> <span class="ex">i</span> in /etc/motd /etc/issue /etc/issue.net<span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb111-3" title="3"><span class="fu">cat</span> <span class="op">&gt;</span><span class="st">&quot;</span><span class="va">$i</span><span class="st">&quot;</span> <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb111-4" title="4">***************************************************************************</a>
<a class="sourceLine" id="cb111-5" title="5">*L’utilisation d’un poste classifié n’est autorisée qu’aux personnes ayant* </a>
<a class="sourceLine" id="cb111-6" title="6">*le niveau d’habilitation requis.                                         *</a>
<a class="sourceLine" id="cb111-7" title="7">*Tout manquement à cette règle est considéré comme une compromission du   *</a>
<a class="sourceLine" id="cb111-8" title="8">* secret de la défense nationale et entraine une poursuite judicaire.     *    </a>
<a class="sourceLine" id="cb111-9" title="9">*                                  (Art. 66. IGI 1300 du 30 novembre 2011)* </a>
<a class="sourceLine" id="cb111-10" title="10">***************************************************************************</a>
<a class="sourceLine" id="cb111-11" title="11"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb111-12" title="12"><span class="kw">done</span></a>
<a class="sourceLine" id="cb111-13" title="13"><span class="co"># Fin: HARDE-RHEL-109</span></a>
<a class="sourceLine" id="cb111-14" title="14"></a></code></pre></div>
<h3 id="méthode-daudit-108">Méthode d'audit</h3>
<h2 id="harde-rhel-110-">HARDE-RHEL-110 :</h2>
<h3 id="description-108">Description</h3>
<h3 id="références-108">Références</h3>
<h4 id="cis-108">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-108">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-103">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-108">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-110:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb112-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-110 : S&#39;assurer que le paramètre SSH root login est désactivé&quot;</span></a>
<a class="sourceLine" id="cb112-2" title="2"><span class="fu">sed</span> -i -e <span class="st">&#39;s/\(^PermitRootLogin yes\)/\#HARDE-RHEL-110: \1/&#39;</span> /etc/ssh/sshd_config</a>
<a class="sourceLine" id="cb112-3" title="3"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^PermitRootLogin\s+no&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;PermitRootLogin no&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb112-4" title="4"><span class="co"># Fin: HARDE-RHEL-110</span></a>
<a class="sourceLine" id="cb112-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-109">Méthode d'audit</h3>
<h2 id="harde-rhel-111-">HARDE-RHEL-111 :</h2>
<h3 id="description-109">Description</h3>
<h3 id="références-109">Références</h3>
<h4 id="cis-109">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-109">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-104">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-109">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-111:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb113-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-111 : S&#39;assurer que le paramètre SSH PermitEmptyPasswords est désactivé&quot;</span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^PermitEmptyPasswords\s+no&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;PermitEmptyPasswords no&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb113-3" title="3"><span class="co"># Fin: HARDE-RHEL-111</span></a>
<a class="sourceLine" id="cb113-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-110">Méthode d'audit</h3>
<h2 id="harde-rhel-112-">HARDE-RHEL-112 :</h2>
<h3 id="description-110">Description</h3>
<h3 id="références-110">Références</h3>
<h4 id="cis-110">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-110">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-105">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-110">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-112:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb114-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-112 : S&#39;assurer que le paramètre SSH PermitUserEnvironment est désactivé&quot;</span></a>
<a class="sourceLine" id="cb114-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^PermitUserEnvironment\s+no&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;PermitUserEnvironment no&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb114-3" title="3"><span class="co"># Fin: HARDE-RHEL-112</span></a>
<a class="sourceLine" id="cb114-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-111">Méthode d'audit</h3>
<h2 id="harde-rhel-113-">HARDE-RHEL-113 :</h2>
<h3 id="description-111">Description</h3>
<h3 id="références-111">Références</h3>
<h4 id="cis-111">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-111">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-106">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-111">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-113:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb115-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-113 : S&#39;assurer que le paramètre SSH Idle Timeout Interval est configuré&quot;</span></a>
<a class="sourceLine" id="cb115-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^Client&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> -e <span class="st">&quot;ClientAliveInterval 300\nClientAliveCountMax 0&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb115-3" title="3"><span class="co"># Fin: HARDE-RHEL-113</span></a>
<a class="sourceLine" id="cb115-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-112">Méthode d'audit</h3>
<h2 id="harde-rhel-114-">HARDE-RHEL-114 :</h2>
<h3 id="description-112">Description</h3>
<h3 id="références-112">Références</h3>
<h4 id="cis-112">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-112">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-107">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-112">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-114:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb116-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-114 : S&#39;assurer que le paramètre SSH LoginGraceTime est positionné à une minute ou moins&quot;</span></a>
<a class="sourceLine" id="cb116-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^LoginGraceTime&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;LoginGraceTime 60&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb116-3" title="3"><span class="co"># Fin: HARDE-RHEL-114</span></a>
<a class="sourceLine" id="cb116-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-113">Méthode d'audit</h3>
<h2 id="harde-rhel-115-">HARDE-RHEL-115 :</h2>
<h3 id="description-113">Description</h3>
<h3 id="références-113">Références</h3>
<h4 id="cis-113">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-113">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-108">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-113">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-115:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb117-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-115 : S&#39;assurer que la bannière SSH est configurée&quot;</span></a>
<a class="sourceLine" id="cb117-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^Banner&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;Banner /etc/issue.net&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb117-3" title="3"><span class="co"># Fin: HARDE-RHEL-115</span></a>
<a class="sourceLine" id="cb117-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-114">Méthode d'audit</h3>
<h2 id="harde-rhel-116-">HARDE-RHEL-116 :</h2>
<h3 id="description-114">Description</h3>
<h3 id="références-114">Références</h3>
<h4 id="cis-114">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-114">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-109">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-114">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-116:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb118-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-116 : S&#39;assurer que le paramètrage SSH PAM est activé&quot;</span></a>
<a class="sourceLine" id="cb118-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^UsePAM&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;UsePAM yes&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb118-3" title="3"><span class="co"># Fin: HARDE-RHEL-116</span></a>
<a class="sourceLine" id="cb118-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-115">Méthode d'audit</h3>
<h2 id="harde-rhel-117-">HARDE-RHEL-117 :</h2>
<h3 id="description-115">Description</h3>
<h3 id="références-115">Références</h3>
<h4 id="cis-115">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-115">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-110">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-115">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-117:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb119-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-117 : S&#39;assurer que le paramètre SSH MaxStartups est configuré&quot;</span></a>
<a class="sourceLine" id="cb119-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^MaxStartups&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;MaxStartups 10:30:60&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb119-3" title="3"><span class="co"># Fin: HARDE-RHEL-117</span></a>
<a class="sourceLine" id="cb119-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-116">Méthode d'audit</h3>
<h2 id="harde-rhel-118-">HARDE-RHEL-118 :</h2>
<h3 id="description-116">Description</h3>
<h3 id="références-116">Références</h3>
<h4 id="cis-116">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-116">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-111">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-116">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-118:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb120-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-118 : S&#39;assurer que le paramètre SSH MaxSessions est positionné à 4 ou moins&quot;</span></a>
<a class="sourceLine" id="cb120-2" title="2"> <span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^MaxSessions&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;MaxSessions 4&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb120-3" title="3"><span class="co"># Fin: HARDE-RHEL-118</span></a>
<a class="sourceLine" id="cb120-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-117">Méthode d'audit</h3>
<h2 id="harde-rhel-119-">HARDE-RHEL-119 :</h2>
<h3 id="description-117">Description</h3>
<h3 id="références-117">Références</h3>
<h4 id="cis-117">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-117">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-112">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-117">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-119:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb121-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-119 : S&#39;assurer que le paramètre SSH MaxAuthTries est positionné à 4 ou moins&quot;</span></a>
<a class="sourceLine" id="cb121-2" title="2"><span class="bu">echo</span> <span class="st">&quot;MaxAuthTries 4&quot;</span><span class="op">&gt;&gt;</span>/etc/ssh/sshd_config</a>
<a class="sourceLine" id="cb121-3" title="3"><span class="co"># Fin: HARDE-RHEL-119</span></a>
<a class="sourceLine" id="cb121-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-118">Méthode d'audit</h3>
<h2 id="harde-rhel-120-">HARDE-RHEL-120 :</h2>
<h3 id="description-118">Description</h3>
<h3 id="références-118">Références</h3>
<h4 id="cis-118">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-118">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-113">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-118">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-120:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb122-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-120 : S&#39;assurer que le paramètre SSH IgnoreRhosts est activé&quot;</span></a>
<a class="sourceLine" id="cb122-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^IgnoreRhosts\s+yes&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;IgnoreRhosts yes&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb122-3" title="3"><span class="co"># Fin: HARDE-RHEL-120</span></a>
<a class="sourceLine" id="cb122-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-119">Méthode d'audit</h3>
<h2 id="harde-rhel-121-">HARDE-RHEL-121 :</h2>
<h3 id="description-119">Description</h3>
<h3 id="références-119">Références</h3>
<h4 id="cis-119">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-119">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-114">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-119">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-121:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb123-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-121 : S&#39;assurer que le paramètre SSH HostbasedAuthentication est désactivé&quot;</span></a>
<a class="sourceLine" id="cb123-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^HostbasedAuthentication\s+no&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;HostbasedAuthentication no&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb123-3" title="3"><span class="co"># Fin: HARDE-RHEL-121</span></a>
<a class="sourceLine" id="cb123-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-120">Méthode d'audit</h3>
<h2 id="harde-rhel-122-">HARDE-RHEL-122 :</h2>
<h3 id="description-120">Description</h3>
<h3 id="références-120">Références</h3>
<h4 id="cis-120">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-120">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-115">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-120">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-122:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb124-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-122 : Créer un profil authselect personnalisé&quot;</span></a>
<a class="sourceLine" id="cb124-2" title="2"></a>
<a class="sourceLine" id="cb124-3" title="3"><span class="co"># Fin: HARDE-RHEL-122</span></a>
<a class="sourceLine" id="cb124-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-121">Méthode d'audit</h3>
<h2 id="harde-rhel-123-">HARDE-RHEL-123 :</h2>
<h3 id="description-121">Description</h3>
<h3 id="références-121">Références</h3>
<h4 id="cis-121">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-121">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-116">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-121">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-123:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb125-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-123 : Selectionner le profil authselect&quot;</span></a>
<a class="sourceLine" id="cb125-2" title="2"></a>
<a class="sourceLine" id="cb125-3" title="3"><span class="co"># Fin: HARDE-RHEL-123</span></a>
<a class="sourceLine" id="cb125-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-122">Méthode d'audit</h3>
<h2 id="harde-rhel-124-">HARDE-RHEL-124 :</h2>
<h3 id="description-122">Description</h3>
<h3 id="références-122">Références</h3>
<h4 id="cis-122">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-122">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-117">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-122">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-124:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb126-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-124 : S&#39;assurer que le paramètrage authselect inclus with-faillock&quot;</span></a>
<a class="sourceLine" id="cb126-2" title="2"></a>
<a class="sourceLine" id="cb126-3" title="3"><span class="co"># Fin: HARDE-RHEL-124</span></a>
<a class="sourceLine" id="cb126-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-123">Méthode d'audit</h3>
<h2 id="harde-rhel-125-">HARDE-RHEL-125 :</h2>
<h3 id="description-123">Description</h3>
<h3 id="références-123">Références</h3>
<h4 id="cis-123">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-123">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-118">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-123">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-125:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb127-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-125 : S&#39;assurer que les exigences de création de mot de passe soient correctes&quot;</span></a>
<a class="sourceLine" id="cb127-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^minlen&#39;</span> /etc/security/pwquality.conf <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;minlen = 9&quot;</span><span class="op">&gt;&gt;</span> /etc/security/pwquality.conf<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb127-3" title="3"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^minclass&#39;</span> /etc/security/pwquality.conf <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;minclass = 4&quot;</span><span class="op">&gt;&gt;</span> /etc/security/pwquality.conf<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb127-4" title="4"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^gecoscheck&#39;</span> /etc/security/pwquality.conf <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;gecoscheck = 1&quot;</span><span class="op">&gt;&gt;</span> /etc/security/pwquality.conf<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb127-5" title="5"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^usercheck&#39;</span> /etc/security/pwquality.conf <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;usercheck = 1&quot;</span><span class="op">&gt;&gt;</span> /etc/security/pwquality.conf<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb127-6" title="6"><span class="co"># Fin: HARDE-RHEL-125</span></a>
<a class="sourceLine" id="cb127-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-124">Méthode d'audit</h3>
<h2 id="harde-rhel-126-">HARDE-RHEL-126 :</h2>
<h3 id="description-124">Description</h3>
<h3 id="références-124">Références</h3>
<h4 id="cis-124">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-124">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-119">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-124">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-126:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb128-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-126 : S&#39;assurer que le verrouillage après des tentatives de connexion soit configuré&quot;</span></a>
<a class="sourceLine" id="cb128-2" title="2">    <span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-137&quot;</span></a>
<a class="sourceLine" id="cb128-3" title="3"><span class="co"># Fin: HARDE-RHEL-126</span></a>
<a class="sourceLine" id="cb128-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-125">Méthode d'audit</h3>
<h2 id="harde-rhel-127--sassurer-que-la-réutilisation-danciens-mots-de-passe-soit-limitée">HARDE-RHEL-127 : S'assurer que la réutilisation d'anciens mots de passe soit limitée</h2>
<h3 id="description-125">Description</h3>
<p>Cette règle vise à limiter la réutilisation des anciens mots de passe. Elle s'appuie sur le module PAM pam_pwhistory et est implémenté sur le système par la règle HARDE-RHEL-137.</p>
<p>UTiliser pam_unix pour cette option n'est pas recommandé car il stocke des agrégats MD5 (alors que pam_pwhistory stocke en sha512)</p>
<h3 id="références-125">Références</h3>
<h4 id="cis-125">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-125">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-120">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-125">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-127:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb129-1" title="1"><span class="co">#! /bin/bash</span></a>
<a class="sourceLine" id="cb129-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-127 : S&#39;assurer que la réutilisation d&#39;anciens mots de passe soit limitée&quot;</span></a>
<a class="sourceLine" id="cb129-3" title="3"><span class="co">#</span></a>
<a class="sourceLine" id="cb129-4" title="4"><span class="fu">touch</span> /etc/security/opasswd</a>
<a class="sourceLine" id="cb129-5" title="5"><span class="fu">chmod</span> 0600 /etc/security/opasswd</a>
<a class="sourceLine" id="cb129-6" title="6"><span class="co"># ls -ldZ /etc/security/opasswd</span></a>
<a class="sourceLine" id="cb129-7" title="7"><span class="co"># -rw-------. root root system_u:object_r:shadow_t:s0 /etc/security/opasswd</span></a>
<a class="sourceLine" id="cb129-8" title="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb129-9" title="9"><span class="co"># La sécurisation est réalisée par HARDE-RHEL-137</span></a>
<a class="sourceLine" id="cb129-10" title="10"><span class="co"># Fin: HARDE-RHEL-127</span></a>
<a class="sourceLine" id="cb129-11" title="11"></a></code></pre></div>
<h3 id="méthode-daudit-126">Méthode d'audit</h3>
<h2 id="harde-rhel-128-">HARDE-RHEL-128 :</h2>
<h3 id="description-126">Description</h3>
<h3 id="références-126">Références</h3>
<h4 id="cis-126">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-126">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-121">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-126">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-128:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb130-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-128 : Protection des mots de passe stockés&quot;</span></a>
<a class="sourceLine" id="cb130-2" title="2"><span class="kw">if</span> ! <span class="fu">grep</span> -q -E <span class="st">&#39;^ENCRYPT_METHOD\s+SHA512&#39;</span> /etc/login.defs <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(ENCRYPT_METHOD.*\)/# \1/&#39;</span> -i /etc/login.defs<span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;ENCRYPT_METHOD SHA512&quot;</span> <span class="op">&gt;&gt;</span> /etc/login.defs<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb130-3" title="3"><span class="kw">if</span> ! <span class="fu">grep</span> -q -E <span class="st">&#39;^SHA_CRYPT_MIN_ROUNDS\s+65536&#39;</span> /etc/login.defs <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(SHA_CRYPT_MIN_ROUNDS.*\)/# \1/&#39;</span> -i /etc/login.defs<span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;SHA_CRYPT_MIN_ROUNDS 65536&quot;</span> <span class="op">&gt;&gt;</span> /etc/login.defs<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb130-4" title="4"><span class="va">AUTH_FILES=(</span></a>
<a class="sourceLine" id="cb130-5" title="5">    [<span class="ex">0</span>]=<span class="st">&quot;/etc/pam.d/system-auth&quot;</span></a>
<a class="sourceLine" id="cb130-6" title="6">    [<span class="ex">1</span>]=<span class="st">&quot;/etc/pam.d/password-auth&quot;</span></a>
<a class="sourceLine" id="cb130-7" title="7">)</a>
<a class="sourceLine" id="cb130-8" title="8"><span class="kw">for</span> <span class="ex">pamFile</span> in <span class="st">&quot;</span><span class="va">${AUTH_FILES[@]}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb130-9" title="9"><span class="kw">do</span></a>
<a class="sourceLine" id="cb130-10" title="10">    <span class="co"># suppress partial config and nullok</span></a>
<a class="sourceLine" id="cb130-11" title="11">    <span class="fu">sed</span> -i --follow-symlinks <span class="st">&quot;/^password.*sufficient.*pam_unix.so/ s/ nullok//&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb130-12" title="12">    <span class="fu">sed</span> -i --follow-symlinks <span class="st">&quot;/^password.*sufficient.*pam_unix.so/ s/ sha512//&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb130-13" title="13">    <span class="fu">sed</span> -i --follow-symlinks <span class="st">&quot;/^password.*sufficient.*pam_unix.so/ s/ obscure//&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb130-14" title="14">    <span class="fu">sed</span> -i --follow-symlinks <span class="st">&quot;/^password.*sufficient.*pam_unix.so/ s/ rounds=65536//&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb130-15" title="15">    <span class="kw">if</span> ! <span class="fu">grep</span> -q <span class="st">&quot;^password.*sufficient.*pam_unix.so.*obscure sha512 rounds=65536&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">then</span></a>
<a class="sourceLine" id="cb130-16" title="16">    <span class="fu">sed</span> -i --follow-symlinks <span class="st">&quot;/^password.*sufficient.*pam_unix.so/ s/$/ obscure sha512 rounds=65536/&quot;</span> <span class="st">&quot;</span><span class="va">$pamFile</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb130-17" title="17">    <span class="kw">fi</span></a>
<a class="sourceLine" id="cb130-18" title="18"><span class="kw">done</span></a>
<a class="sourceLine" id="cb130-19" title="19"><span class="co"># Fin: HARDE-RHEL-128</span></a>
<a class="sourceLine" id="cb130-20" title="20"></a></code></pre></div>
<h3 id="méthode-daudit-127">Méthode d'audit</h3>
<h2 id="harde-rhel-129-">HARDE-RHEL-129 :</h2>
<h3 id="description-127">Description</h3>
<h3 id="références-127">Références</h3>
<h4 id="cis-127">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-127">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-122">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-127">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-129:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb131-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-129 : S&#39;assurer que l&#39;expiration des mots de passe soit de 365 jours ou moins&quot;</span></a>
<a class="sourceLine" id="cb131-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^PASS_MAX_DAYS\s+365&#39;</span> /etc/login.defs <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(PASS_MAX_DAYS.*\)/# \1/&#39;</span> -i /etc/login.defs<span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;PASS_MAX_DAYS 365&quot;</span> <span class="op">&gt;&gt;</span> /etc/login.defs<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb131-3" title="3"><span class="co"># Fin: HARDE-RHEL-129</span></a>
<a class="sourceLine" id="cb131-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-128">Méthode d'audit</h3>
<h2 id="harde-rhel-130-">HARDE-RHEL-130 :</h2>
<h3 id="description-128">Description</h3>
<h3 id="références-128">Références</h3>
<h4 id="cis-128">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-128">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-123">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-128">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-130:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb132-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-130 : S&#39;assurer que le nombre minimum de jours entre 2 changements de mot de passe soit 7 ou plus&quot;</span></a>
<a class="sourceLine" id="cb132-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^PASS_MIN_DAYS\s+365&#39;</span> /etc/login.defs <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(PASS_MIN_DAYS.*\)/# \1/&#39;</span> -i /etc/login.defs<span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;PASS_MIN_DAYS 7&quot;</span> <span class="op">&gt;&gt;</span> /etc/login.defs<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb132-3" title="3"><span class="co"># Fin: HARDE-RHEL-130</span></a>
<a class="sourceLine" id="cb132-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-129">Méthode d'audit</h3>
<h2 id="harde-rhel-131-">HARDE-RHEL-131 :</h2>
<h3 id="description-129">Description</h3>
<h3 id="références-129">Références</h3>
<h4 id="cis-129">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-129">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-124">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-129">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-131:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb133-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-131 : S&#39;assurer que l&#39;alerte pour expiration de mot de passe soit émise 7 jours ou plus avant expiration du mot de passe&quot;</span></a>
<a class="sourceLine" id="cb133-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^PASS_WARN_AGE\s+14&#39;</span> /etc/login.defs <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(PASS_WARN_AGE.*\)/# \1/&#39;</span> -i /etc/login.defs<span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;PASS_WARN_AGE 14&quot;</span> <span class="op">&gt;&gt;</span> /etc/login.defs<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb133-3" title="3"><span class="co"># Fin: HARDE-RHEL-131</span></a>
<a class="sourceLine" id="cb133-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-130">Méthode d'audit</h3>
<h2 id="harde-rhel-132-">HARDE-RHEL-132 :</h2>
<h3 id="description-130">Description</h3>
<h3 id="références-130">Références</h3>
<h4 id="cis-130">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-130">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-125">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-130">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-132:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb134-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-132 : S&#39;assurer que le verrouillage des comptes inutilisés soit de 30 jours ou moins&quot;</span></a>
<a class="sourceLine" id="cb134-2" title="2"> <span class="ex">useradd</span> -D -f 30</a>
<a class="sourceLine" id="cb134-3" title="3"><span class="co"># Fin: HARDE-RHEL-132</span></a>
<a class="sourceLine" id="cb134-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-131">Méthode d'audit</h3>
<h2 id="harde-rhel-133-">HARDE-RHEL-133 :</h2>
<h3 id="description-131">Description</h3>
<h3 id="références-131">Références</h3>
<h4 id="cis-131">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-131">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-126">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-131">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-133:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb135-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-133 : S&#39;assurer que toutes les dates de changement de mot de passe soient dans le passé&quot;</span></a>
<a class="sourceLine" id="cb135-2" title="2"><span class="va">PATH=</span>/sbin:<span class="va">$PATH</span> <span class="fu">awk</span> -F: <span class="st">&#39;($1!=&quot;root&quot; &amp;&amp; $1!=&quot;sync&quot; &amp;&amp; $1!=&quot;shutdown&quot; &amp;&amp; $1!=&quot;halt&quot; &amp;&amp; $1!~/^\+/ &amp;&amp; $3&lt;&#39;&quot;</span><span class="va">$(</span><span class="fu">awk</span> <span class="st">&#39;/^\s*UID_MIN/{print $2}&#39;</span> /etc/login.defs<span class="va">)</span><span class="st">&quot;&#39; &amp;&amp; $7!=&quot;&#39;&quot;</span><span class="va">$(</span><span class="fu">which</span> nologin<span class="va">)</span><span class="st">&quot;&#39;&quot; &amp;&amp; $7!=&quot;/bin/false&quot;) {print $1}&#39;</span> /etc/passwd <span class="kw">|</span> <span class="kw">while</span> <span class="bu">read</span> -r <span class="va">user</span> ; <span class="kw">do</span> <span class="ex">usermod</span> -s <span class="st">&quot;</span><span class="va">$(</span><span class="fu">which</span> nologin<span class="va">)</span><span class="st">&quot;</span> <span class="st">&quot;</span><span class="va">${user}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">done</span></a>
<a class="sourceLine" id="cb135-3" title="3"><span class="fu">awk</span> -F: <span class="st">&#39;($1!=&quot;root&quot; &amp;&amp; $1!~/^\+/ &amp;&amp; $3&lt;&#39;&quot;</span><span class="va">$(</span><span class="fu">awk</span> <span class="st">&#39;/^\s*UID_MIN/{print $2}&#39;</span> /etc/login.defs<span class="va">)</span><span class="st">&quot;&#39;) {print $1}&#39;</span> /etc/passwd <span class="kw">|</span> <span class="fu">xargs</span> -I <span class="st">&#39;{}&#39;</span> passwd -S <span class="st">&#39;{}&#39;</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;($2!=&quot;L&quot; &amp;&amp; $2!=&quot;LK&quot;) {print $1}&#39;</span> <span class="kw">|</span> <span class="kw">while</span> <span class="bu">read</span> -r <span class="va">user</span>; <span class="kw">do</span> <span class="ex">usermod</span> -L <span class="st">&quot;</span><span class="va">${user}</span><span class="st">&quot;</span> <span class="kw">;</span> <span class="kw">done</span></a>
<a class="sourceLine" id="cb135-4" title="4"><span class="co"># Fin: HARDE-RHEL-133</span></a>
<a class="sourceLine" id="cb135-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-132">Méthode d'audit</h3>
<h2 id="harde-rhel-134-">HARDE-RHEL-134 :</h2>
<h3 id="description-132">Description</h3>
<h3 id="références-132">Références</h3>
<h4 id="cis-132">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-132">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-127">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-132">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-134:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb136-1" title="1"><span class="co">#! /usr/bin/env bash</span></a>
<a class="sourceLine" id="cb136-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-134 : S&#39;assurer que les comptes système soient sécurisés&quot;</span></a>
<a class="sourceLine" id="cb136-3" title="3"><span class="co"># Expire passwords now to enforce the new password policy</span></a>
<a class="sourceLine" id="cb136-4" title="4"><span class="ex">chage</span> -d 0 root</a>
<a class="sourceLine" id="cb136-5" title="5"><span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span><span class="bu"> ]</span> <span class="kw">||</span> <span class="fu">getent</span> passwd <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span> <span class="op">&gt;</span>/dev/null <span class="kw">&amp;&amp;</span> <span class="ex">chage</span> -d 0 <span class="st">&quot;</span><span class="va">${ADMINUSER}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb136-6" title="6"><span class="co"># Fin: HARDE-RHEL-134</span></a>
<a class="sourceLine" id="cb136-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-133">Méthode d'audit</h3>
<h2 id="harde-rhel-135-">HARDE-RHEL-135 :</h2>
<h3 id="description-133">Description</h3>
<h3 id="références-133">Références</h3>
<h4 id="cis-133">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-133">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-128">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-133">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-135:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb137-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-135 : S&#39;assurer que la temporisation par défaut des shell utilisateurs soit de 900 secondes ou moins&quot;</span></a>
<a class="sourceLine" id="cb137-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/profile.d/tmout.sh <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb137-3" title="3">readonly TMOUT=900 ; export TMOUT</a>
<a class="sourceLine" id="cb137-4" title="4"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb137-5" title="5"><span class="co"># Fin: HARDE-RHEL-135</span></a>
<a class="sourceLine" id="cb137-6" title="6"></a></code></pre></div>
<h3 id="méthode-daudit-134">Méthode d'audit</h3>
<h2 id="harde-rhel-136-">HARDE-RHEL-136 :</h2>
<h3 id="description-134">Description</h3>
<h3 id="références-134">Références</h3>
<h4 id="cis-134">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-134">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-129">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-134">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-136:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb138-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-136 : S&#39;assurer que le groupe par défaut du compte root est 0&quot;</span></a>
<a class="sourceLine" id="cb138-2" title="2"><span class="ex">usermod</span> -g 0 root</a>
<a class="sourceLine" id="cb138-3" title="3"><span class="co"># Fin: HARDE-RHEL-136</span></a>
<a class="sourceLine" id="cb138-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-135">Méthode d'audit</h3>
<h2 id="harde-rhel-137-">HARDE-RHEL-137 :</h2>
<h3 id="description-135">Description</h3>
<h3 id="références-135">Références</h3>
<h4 id="cis-135">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-135">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-130">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-135">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-137:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb139-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-137 : S&#39;assurer que la connexion est root est seulement possible sur la console system&quot;</span></a>
<a class="sourceLine" id="cb139-2" title="2"><span class="kw">for</span> <span class="ex">i</span> in 1 2 3 4 5 6<span class="kw">;</span> <span class="kw">do</span> <span class="bu">echo</span> <span class="st">&quot;tty</span><span class="va">$i</span><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> /etc/securetty<span class="kw">;</span> <span class="kw">done</span></a>
<a class="sourceLine" id="cb139-3" title="3"><span class="co"># enable pam_securetty.so as well</span></a>
<a class="sourceLine" id="cb139-4" title="4"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/pam.d/system-auth <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb139-5" title="5">#%PAM-1.0</a>
<a class="sourceLine" id="cb139-6" title="6"># This file is auto-generated.</a>
<a class="sourceLine" id="cb139-7" title="7"># User changes will be destroyed the next time authselect is run.</a>
<a class="sourceLine" id="cb139-8" title="8">auth        required      pam_env.so</a>
<a class="sourceLine" id="cb139-9" title="9">auth        required      pam_securetty.so noconsole</a>
<a class="sourceLine" id="cb139-10" title="10">auth        sufficient    pam_unix.so try_first_pass</a>
<a class="sourceLine" id="cb139-11" title="11">auth        required      pam_faillock.so preauth silent deny=5 unlock_time=900</a>
<a class="sourceLine" id="cb139-12" title="12">auth        required      pam_faillock.so authfail deny=5 unlock_time=900</a>
<a class="sourceLine" id="cb139-13" title="13">auth        required      pam_deny.so</a>
<a class="sourceLine" id="cb139-14" title="14"></a>
<a class="sourceLine" id="cb139-15" title="15">account     required      pam_unix.so</a>
<a class="sourceLine" id="cb139-16" title="16"></a>
<a class="sourceLine" id="cb139-17" title="17">password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=</a>
<a class="sourceLine" id="cb139-18" title="18">password    requisite     pam_pwhistory.so use_authtok remember=99</a>
<a class="sourceLine" id="cb139-19" title="19">password    sufficient    pam_unix.so try_first_pass use_authtok shadow obscure sha512 rounds=65536</a>
<a class="sourceLine" id="cb139-20" title="20">password    required      pam_deny.so</a>
<a class="sourceLine" id="cb139-21" title="21"></a>
<a class="sourceLine" id="cb139-22" title="22">session     optional      pam_keyinit.so revoke</a>
<a class="sourceLine" id="cb139-23" title="23">session     required      pam_limits.so</a>
<a class="sourceLine" id="cb139-24" title="24">-session     optional      pam_systemd.so</a>
<a class="sourceLine" id="cb139-25" title="25">session     [success=1 default=ignore] pam_succeed_if.so service in crond quiet use_uid</a>
<a class="sourceLine" id="cb139-26" title="26">session     required      pam_unix.so</a>
<a class="sourceLine" id="cb139-27" title="27"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb139-28" title="28"><span class="fu">cp</span> /etc/pam.d/system-auth /etc/pam.d/password-auth</a>
<a class="sourceLine" id="cb139-29" title="29"><span class="co"># Fin: HARDE-RHEL-137</span></a>
<a class="sourceLine" id="cb139-30" title="30"></a></code></pre></div>
<h3 id="méthode-daudit-136">Méthode d'audit</h3>
<h2 id="harde-rhel-138-">HARDE-RHEL-138 :</h2>
<h3 id="description-136">Description</h3>
<h3 id="références-136">Références</h3>
<h4 id="cis-136">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-136">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-131">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-136">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-138:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb140-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-138 : S&#39;assurer qu&#39;aucun mot de passe n&#39;est vide&quot;</span></a>
<a class="sourceLine" id="cb140-2" title="2"></a>
<a class="sourceLine" id="cb140-3" title="3"><span class="co"># Fin: HARDE-RHEL-138</span></a>
<a class="sourceLine" id="cb140-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-137">Méthode d'audit</h3>
<h2 id="harde-rhel-139-">HARDE-RHEL-139 :</h2>
<h3 id="description-137">Description</h3>
<h3 id="références-137">Références</h3>
<h4 id="cis-137">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-137">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-132">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-137">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-139:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb141-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-139 : S&#39;assurer que qu&#39;aucune entrée dans /etc/passwd n&#39;utilise le code historique </span><span class="dt">\&quot;</span><span class="st">+</span><span class="dt">\&quot;</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb141-2" title="2"></a>
<a class="sourceLine" id="cb141-3" title="3"><span class="co"># Fin: HARDE-RHEL-139</span></a>
<a class="sourceLine" id="cb141-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-138">Méthode d'audit</h3>
<h2 id="harde-rhel-140-">HARDE-RHEL-140 :</h2>
<h3 id="description-138">Description</h3>
<h3 id="références-138">Références</h3>
<h4 id="cis-138">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-138">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-133">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-138">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-140:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb142-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-140 : S&#39;assurer que qu&#39;aucune entrée dans /etc/shadow n&#39;utilise le code historique </span><span class="dt">\&quot;</span><span class="st">+</span><span class="dt">\&quot;</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb142-2" title="2"></a>
<a class="sourceLine" id="cb142-3" title="3"><span class="co"># Fin: HARDE-RHEL-140</span></a>
<a class="sourceLine" id="cb142-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-139">Méthode d'audit</h3>
<h2 id="harde-rhel-141-">HARDE-RHEL-141 :</h2>
<h3 id="description-139">Description</h3>
<h3 id="références-139">Références</h3>
<h4 id="cis-139">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-139">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-134">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-139">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-141:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb143-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-141 : S&#39;assurer que qu&#39;aucune entrée dans /etc/group n&#39;utilise le code historique </span><span class="dt">\&quot;</span><span class="st">+</span><span class="dt">\&quot;</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb143-2" title="2"></a>
<a class="sourceLine" id="cb143-3" title="3"><span class="co"># Fin: HARDE-RHEL-141</span></a>
<a class="sourceLine" id="cb143-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-140">Méthode d'audit</h3>
<h2 id="harde-rhel-142-">HARDE-RHEL-142 :</h2>
<h3 id="description-140">Description</h3>
<h3 id="références-140">Références</h3>
<h4 id="cis-140">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-140">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-135">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-140">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-142:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb144-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-142 : S&#39;assurer que root est le seul compte avec UID 0&quot;</span></a>
<a class="sourceLine" id="cb144-2" title="2"></a>
<a class="sourceLine" id="cb144-3" title="3"><span class="co"># Fin: HARDE-RHEL-142</span></a>
<a class="sourceLine" id="cb144-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-141">Méthode d'audit</h3>
<h2 id="harde-rhel-143-">HARDE-RHEL-143 :</h2>
<h3 id="description-141">Description</h3>
<h3 id="références-141">Références</h3>
<h4 id="cis-141">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-141">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-136">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-141">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-143:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb145-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-143 : Désactivation des comptes utilisateurs inutilisés&quot;</span></a>
<a class="sourceLine" id="cb145-2" title="2"></a>
<a class="sourceLine" id="cb145-3" title="3"><span class="co"># Fin: HARDE-RHEL-143</span></a>
<a class="sourceLine" id="cb145-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-142">Méthode d'audit</h3>
<h2 id="harde-rhel-144-">HARDE-RHEL-144 :</h2>
<h3 id="description-142">Description</h3>
<h3 id="références-142">Références</h3>
<h4 id="cis-142">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-142">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-137">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-142">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-144:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb146-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-144 : Désactivation des comptes de services&quot;</span></a>
<a class="sourceLine" id="cb146-2" title="2"></a>
<a class="sourceLine" id="cb146-3" title="3"><span class="co"># Fin: HARDE-RHEL-144</span></a>
<a class="sourceLine" id="cb146-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-143">Méthode d'audit</h3>
<h2 id="harde-rhel-145-">HARDE-RHEL-145 :</h2>
<h3 id="description-143">Description</h3>
<h3 id="références-143">Références</h3>
<h4 id="cis-143">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-143">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-138">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-143">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-145:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb147-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-145 : Unicité et exclusivité des comptes de services&quot;</span></a>
<a class="sourceLine" id="cb147-2" title="2"></a>
<a class="sourceLine" id="cb147-3" title="3"><span class="co"># Fin: HARDE-RHEL-145</span></a>
<a class="sourceLine" id="cb147-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-144">Méthode d'audit</h3>
<h2 id="harde-rhel-146-">HARDE-RHEL-146 :</h2>
<h3 id="description-144">Description</h3>
<h3 id="références-144">Références</h3>
<h4 id="cis-144">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-144">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-139">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-144">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-146:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb148-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-146 : Délai d&#39;expiration de sessions utilisateurs&quot;</span></a>
<a class="sourceLine" id="cb148-2" title="2"></a>
<a class="sourceLine" id="cb148-3" title="3"><span class="co"># Fin: HARDE-RHEL-146</span></a>
<a class="sourceLine" id="cb148-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-145">Méthode d'audit</h3>
<h2 id="harde-rhel-147-">HARDE-RHEL-147 :</h2>
<h3 id="description-145">Description</h3>
<h3 id="références-145">Références</h3>
<h4 id="cis-145">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-145">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-140">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-145">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-147:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb149-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-147 : Applications utilisant PAM&quot;</span></a>
<a class="sourceLine" id="cb149-2" title="2"></a>
<a class="sourceLine" id="cb149-3" title="3"><span class="co"># Fin: HARDE-RHEL-147</span></a>
<a class="sourceLine" id="cb149-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-146">Méthode d'audit</h3>
<h2 id="harde-rhel-148-">HARDE-RHEL-148 :</h2>
<h3 id="description-146">Description</h3>
<h3 id="références-146">Références</h3>
<h4 id="cis-146">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-146">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-141">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-146">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-148:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb150-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-148 : Sécurisation des services réseau d&#39;authentification PAM&quot;</span></a>
<a class="sourceLine" id="cb150-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/pam.d/su <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb150-3" title="3">#%PAM-1.0</a>
<a class="sourceLine" id="cb150-4" title="4">auth            required        pam_env.so</a>
<a class="sourceLine" id="cb150-5" title="5">auth            sufficient      pam_rootok.so</a>
<a class="sourceLine" id="cb150-6" title="6"># Uncomment the following line to implicitly trust users in the &quot;&quot;wheel&quot;&quot; group.</a>
<a class="sourceLine" id="cb150-7" title="7">#auth           sufficient      pam_wheel.so trust use_uid</a>
<a class="sourceLine" id="cb150-8" title="8"># Uncomment the following line to require a user to be in the &quot;&quot;wheel&quot;&quot; group.</a>
<a class="sourceLine" id="cb150-9" title="9">#auth           required        pam_wheel.so use_uid</a>
<a class="sourceLine" id="cb150-10" title="10"># The following line requires a user to be in the &quot;&quot;sudogrp&quot;&quot; group.</a>
<a class="sourceLine" id="cb150-11" title="11">auth            required        pam_wheel.so group=sudogrp</a>
<a class="sourceLine" id="cb150-12" title="12">auth            substack        system-auth</a>
<a class="sourceLine" id="cb150-13" title="13">auth            include         postlogin</a>
<a class="sourceLine" id="cb150-14" title="14">account         sufficient      pam_succeed_if.so uid = 0 use_uid quiet</a>
<a class="sourceLine" id="cb150-15" title="15">account         include         system-auth</a>
<a class="sourceLine" id="cb150-16" title="16">password        include         system-auth</a>
<a class="sourceLine" id="cb150-17" title="17">session         include         system-auth</a>
<a class="sourceLine" id="cb150-18" title="18">session         include         postlogin</a>
<a class="sourceLine" id="cb150-19" title="19">session         optional        pam_xauth.so</a>
<a class="sourceLine" id="cb150-20" title="20"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb150-21" title="21"><span class="co"># Fin: HARDE-RHEL-148</span></a>
<a class="sourceLine" id="cb150-22" title="22"></a></code></pre></div>
<h3 id="méthode-daudit-147">Méthode d'audit</h3>
<h2 id="harde-rhel-149-">HARDE-RHEL-149 :</h2>
<h3 id="description-147">Description</h3>
<h3 id="références-147">Références</h3>
<h4 id="cis-147">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-147">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-142">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-147">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-149:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb151-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-149 : Sécurisation des accès aux bases utilisateurs distantes&quot;</span></a>
<a class="sourceLine" id="cb151-2" title="2"></a>
<a class="sourceLine" id="cb151-3" title="3"><span class="co"># Fin: HARDE-RHEL-149</span></a>
<a class="sourceLine" id="cb151-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-148">Méthode d'audit</h3>
<h2 id="harde-rhel-150-">HARDE-RHEL-150 :</h2>
<h3 id="description-148">Description</h3>
<h3 id="références-148">Références</h3>
<h4 id="cis-148">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-148">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-143">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-148">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-150:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb152-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-150 : Séparation des comptes système et d&#39;administrateur de l&#39;annuaire&quot;</span></a>
<a class="sourceLine" id="cb152-2" title="2"></a>
<a class="sourceLine" id="cb152-3" title="3"><span class="co"># Fin: HARDE-RHEL-150</span></a>
<a class="sourceLine" id="cb152-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-149">Méthode d'audit</h3>
<h2 id="harde-rhel-151-">HARDE-RHEL-151 :</h2>
<h3 id="description-149">Description</h3>
<h3 id="références-149">Références</h3>
<h4 id="cis-149">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-149">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-144">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-149">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-151:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb153-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-151 : Groupe dédié à l&#39;usage de sudo&quot;</span></a>
<a class="sourceLine" id="cb153-2" title="2"><span class="co">#cat &gt;/etc/sudoers.d/15group &lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb153-3" title="3"><span class="co">#%sudogrp ALL=(ALL) ALL</span></a>
<a class="sourceLine" id="cb153-4" title="4"><span class="co">#EOF</span></a>
<a class="sourceLine" id="cb153-5" title="5"><span class="ex">groupadd</span> -r -f sudogrp</a>
<a class="sourceLine" id="cb153-6" title="6"><span class="fu">chgrp</span> sudogrp /usr/bin/sudo</a>
<a class="sourceLine" id="cb153-7" title="7"><span class="fu">chmod</span> u+s /usr/bin/sudo</a>
<a class="sourceLine" id="cb153-8" title="8"><span class="fu">chmod</span> o-rwx /usr/bin/sudo</a>
<a class="sourceLine" id="cb153-9" title="9"><span class="co"># Fin: HARDE-RHEL-151</span></a>
<a class="sourceLine" id="cb153-10" title="10"></a></code></pre></div>
<h3 id="méthode-daudit-150">Méthode d'audit</h3>
<h2 id="harde-rhel-152-">HARDE-RHEL-152 :</h2>
<h3 id="description-150">Description</h3>
<h3 id="références-150">Références</h3>
<h4 id="cis-150">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-150">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-145">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-150">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-152:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb154-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-152 : Authentification des utilisateurs exécutant sudo&quot;</span></a>
<a class="sourceLine" id="cb154-2" title="2"><span class="kw">if</span> <span class="fu">grep</span> -q -E <span class="st">&quot;^[^#].*NOPASSWD&quot;</span> /etc/sudoers<span class="kw">;</span> <span class="kw">then</span> </a>
<a class="sourceLine" id="cb154-3" title="3">    <span class="bu">echo</span> <span class="st">&quot;Directive NOPASSWD à supprimer du fichier /etc/sudoers&quot;</span></a>
<a class="sourceLine" id="cb154-4" title="4"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb154-5" title="5"><span class="co"># Fin: HARDE-RHEL-152</span></a>
<a class="sourceLine" id="cb154-6" title="6"></a></code></pre></div>
<h3 id="méthode-daudit-151">Méthode d'audit</h3>
<h2 id="harde-rhel-153-">HARDE-RHEL-153 :</h2>
<h3 id="description-151">Description</h3>
<h3 id="références-151">Références</h3>
<h4 id="cis-151">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-151">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-146">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-151">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-153:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb155-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-153 : Privilèges des utilisateurs cibles pour une commande sudo&quot;</span></a>
<a class="sourceLine" id="cb155-2" title="2"></a>
<a class="sourceLine" id="cb155-3" title="3"><span class="co"># Fin: HARDE-RHEL-153</span></a>
<a class="sourceLine" id="cb155-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-152">Méthode d'audit</h3>
<h2 id="harde-rhel-154-">HARDE-RHEL-154 :</h2>
<h3 id="description-152">Description</h3>
<h3 id="références-152">Références</h3>
<h4 id="cis-152">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-152">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-147">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-152">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-154:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb156-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-154 : Limitation du nombre de commandes nécessitant l&#39;option EXEC&quot;</span></a>
<a class="sourceLine" id="cb156-2" title="2"></a>
<a class="sourceLine" id="cb156-3" title="3"><span class="co"># Fin: HARDE-RHEL-154</span></a>
<a class="sourceLine" id="cb156-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-153">Méthode d'audit</h3>
<h2 id="harde-rhel-155-">HARDE-RHEL-155 :</h2>
<h3 id="description-153">Description</h3>
<h3 id="références-153">Références</h3>
<h4 id="cis-153">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-153">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-148">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-153">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-155:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb157-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-155 : Du bon usage de la négation dans une spécification sudo&quot;</span></a>
<a class="sourceLine" id="cb157-2" title="2"></a>
<a class="sourceLine" id="cb157-3" title="3"><span class="co"># Fin: HARDE-RHEL-155</span></a>
<a class="sourceLine" id="cb157-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-154">Méthode d'audit</h3>
<h2 id="harde-rhel-156-">HARDE-RHEL-156 :</h2>
<h3 id="description-154">Description</h3>
<h3 id="références-154">Références</h3>
<h4 id="cis-154">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-154">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-149">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-154">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-156:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb158-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-156 : Arguments explicites dans les spécifications sudo&quot;</span></a>
<a class="sourceLine" id="cb158-2" title="2"></a>
<a class="sourceLine" id="cb158-3" title="3"><span class="co"># Fin: HARDE-RHEL-156</span></a>
<a class="sourceLine" id="cb158-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-155">Méthode d'audit</h3>
<h2 id="harde-rhel-157-">HARDE-RHEL-157 :</h2>
<h3 id="description-155">Description</h3>
<h3 id="références-155">Références</h3>
<h4 id="cis-155">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-155">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-150">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-155">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-157:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb159-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-157 : Du bon usage de sudoedit&quot;</span></a>
<a class="sourceLine" id="cb159-2" title="2"></a>
<a class="sourceLine" id="cb159-3" title="3"><span class="co"># Fin: HARDE-RHEL-157</span></a>
<a class="sourceLine" id="cb159-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-156">Méthode d'audit</h3>
<h2 id="harde-rhel-158-">HARDE-RHEL-158 :</h2>
<h3 id="description-156">Description</h3>
<h3 id="références-156">Références</h3>
<h4 id="cis-156">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-156">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-151">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-156">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-158:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb160-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-158 : Sticky bit et droits d&#39;accès en écriture&quot;</span></a>
<a class="sourceLine" id="cb160-2" title="2"></a>
<a class="sourceLine" id="cb160-3" title="3"><span class="co"># Fin: HARDE-RHEL-158</span></a>
<a class="sourceLine" id="cb160-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-157">Méthode d'audit</h3>
<h2 id="harde-rhel-159-">HARDE-RHEL-159 :</h2>
<h3 id="description-157">Description</h3>
<h3 id="références-157">Références</h3>
<h4 id="cis-157">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-157">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-152">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-157">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-159:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb161-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-159 : Installer AIDE&quot;</span></a>
<a class="sourceLine" id="cb161-2" title="2"><span class="ex">dnf</span> install aide</a>
<a class="sourceLine" id="cb161-3" title="3"><span class="co"># Fin: HARDE-RHEL-159</span></a>
<a class="sourceLine" id="cb161-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-158">Méthode d'audit</h3>
<h2 id="harde-rhel-160-">HARDE-RHEL-160 :</h2>
<h3 id="description-158">Description</h3>
<h3 id="références-158">Références</h3>
<h4 id="cis-158">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-158">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-153">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-158">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-160:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb162-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-160 : Vérification régulière de l&#39;intégrité de système de fichiers&quot;</span></a>
<a class="sourceLine" id="cb162-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/system/aidecheck.timer <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb162-3" title="3">[Unit]</a>
<a class="sourceLine" id="cb162-4" title="4">Description=Aide check every day at midnight</a>
<a class="sourceLine" id="cb162-5" title="5"></a>
<a class="sourceLine" id="cb162-6" title="6">[Timer]</a>
<a class="sourceLine" id="cb162-7" title="7">OnCalendar=*-*-* 00:00:00</a>
<a class="sourceLine" id="cb162-8" title="8">Unit=aidecheck.service</a>
<a class="sourceLine" id="cb162-9" title="9"></a>
<a class="sourceLine" id="cb162-10" title="10">[Install]</a>
<a class="sourceLine" id="cb162-11" title="11">WantedBy=multi-user.target</a>
<a class="sourceLine" id="cb162-12" title="12"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb162-13" title="13"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/systemd/system/aidecheck.service <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb162-14" title="14">[Unit]</a>
<a class="sourceLine" id="cb162-15" title="15">Description=Aide Check</a>
<a class="sourceLine" id="cb162-16" title="16"></a>
<a class="sourceLine" id="cb162-17" title="17">[Service]</a>
<a class="sourceLine" id="cb162-18" title="18">Type=simple</a>
<a class="sourceLine" id="cb162-19" title="19">ExecStart=/sbin/aide --check</a>
<a class="sourceLine" id="cb162-20" title="20"></a>
<a class="sourceLine" id="cb162-21" title="21">[Install]</a>
<a class="sourceLine" id="cb162-22" title="22">WantedBy=multi-user.target</a>
<a class="sourceLine" id="cb162-23" title="23"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb162-24" title="24"><span class="fu">chmod</span> 0644 /etc/systemd/system/aidecheck.*</a>
<a class="sourceLine" id="cb162-25" title="25"><span class="ex">systemctl</span> reenable aidecheck.timer</a>
<a class="sourceLine" id="cb162-26" title="26"><span class="ex">systemctl</span> restart aidecheck.timer</a>
<a class="sourceLine" id="cb162-27" title="27"><span class="ex">systemctl</span> daemon-reload</a>
<a class="sourceLine" id="cb162-28" title="28"><span class="co"># do this at the end, to minimize the number of changes</span></a>
<a class="sourceLine" id="cb162-29" title="29"><span class="co"># aide --init</span></a>
<a class="sourceLine" id="cb162-30" title="30"><span class="co"># mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz</span></a>
<a class="sourceLine" id="cb162-31" title="31"><span class="co"># Fin: HARDE-RHEL-160</span></a>
<a class="sourceLine" id="cb162-32" title="32"></a></code></pre></div>
<h3 id="méthode-daudit-159">Méthode d'audit</h3>
<h2 id="harde-rhel-161-">HARDE-RHEL-161 :</h2>
<h3 id="description-159">Description</h3>
<h3 id="références-159">Références</h3>
<h4 id="cis-159">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-159">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-154">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-159">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-161:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb163-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-161 : S&#39;assurer que les permissions sur /etc/crontab soient correctes&quot;</span></a>
<a class="sourceLine" id="cb163-2" title="2"><span class="fu">chown</span> root:root /etc/crontab</a>
<a class="sourceLine" id="cb163-3" title="3"><span class="fu">chmod</span> og-rwx /etc/crontab</a>
<a class="sourceLine" id="cb163-4" title="4"><span class="co"># Fin: HARDE-RHEL-161</span></a>
<a class="sourceLine" id="cb163-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-160">Méthode d'audit</h3>
<h2 id="harde-rhel-162-">HARDE-RHEL-162 :</h2>
<h3 id="description-160">Description</h3>
<h3 id="références-160">Références</h3>
<h4 id="cis-160">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-160">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-155">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-160">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-162:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb164-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-162 : S&#39;assurer que les permissions sur /etc/cron.hourly soient correctes&quot;</span></a>
<a class="sourceLine" id="cb164-2" title="2"><span class="fu">chown</span> root:root /etc/cron.hourly</a>
<a class="sourceLine" id="cb164-3" title="3"><span class="fu">chmod</span> og-rwx /etc/cron.hourly</a>
<a class="sourceLine" id="cb164-4" title="4"><span class="co"># Fin: HARDE-RHEL-162</span></a>
<a class="sourceLine" id="cb164-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-161">Méthode d'audit</h3>
<h2 id="harde-rhel-163-">HARDE-RHEL-163 :</h2>
<h3 id="description-161">Description</h3>
<h3 id="références-161">Références</h3>
<h4 id="cis-161">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-161">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-156">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-161">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-163:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb165-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-163 : S&#39;assurer que les permissions sur /etc/cron.daily soient correctes&quot;</span></a>
<a class="sourceLine" id="cb165-2" title="2"><span class="fu">chown</span> root:root /etc/cron.daily</a>
<a class="sourceLine" id="cb165-3" title="3"><span class="fu">chmod</span> og-rwx /etc/cron.daily</a>
<a class="sourceLine" id="cb165-4" title="4"><span class="co"># Fin: HARDE-RHEL-163</span></a>
<a class="sourceLine" id="cb165-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-162">Méthode d'audit</h3>
<h2 id="harde-rhel-164-">HARDE-RHEL-164 :</h2>
<h3 id="description-162">Description</h3>
<h3 id="références-162">Références</h3>
<h4 id="cis-162">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-162">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-157">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-162">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-164:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb166-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-164 : S&#39;assurer que les permissions sur /etc/cron.weekly soient correctes&quot;</span></a>
<a class="sourceLine" id="cb166-2" title="2"><span class="fu">chown</span> root:root /etc/cron.weekly</a>
<a class="sourceLine" id="cb166-3" title="3"><span class="fu">chmod</span> og-rwx /etc/cron.weekly</a>
<a class="sourceLine" id="cb166-4" title="4"><span class="co"># Fin: HARDE-RHEL-164</span></a>
<a class="sourceLine" id="cb166-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-163">Méthode d'audit</h3>
<h2 id="harde-rhel-165-">HARDE-RHEL-165 :</h2>
<h3 id="description-163">Description</h3>
<h3 id="références-163">Références</h3>
<h4 id="cis-163">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-163">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-158">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-163">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-165:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb167-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-165 : S&#39;assurer que les permissions sur /etc/cron.monthly soient correctes&quot;</span></a>
<a class="sourceLine" id="cb167-2" title="2"><span class="fu">chown</span> root:root /etc/cron.monthly</a>
<a class="sourceLine" id="cb167-3" title="3"><span class="fu">chmod</span> og-rwx /etc/cron.monthly</a>
<a class="sourceLine" id="cb167-4" title="4"><span class="co"># Fin: HARDE-RHEL-165</span></a>
<a class="sourceLine" id="cb167-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-164">Méthode d'audit</h3>
<h2 id="harde-rhel-166-">HARDE-RHEL-166 :</h2>
<h3 id="description-164">Description</h3>
<h3 id="références-164">Références</h3>
<h4 id="cis-164">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-164">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-159">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-164">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-166:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb168-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-166 : S&#39;assurer que les permissions sur /etc/cron.d soient correctes&quot;</span></a>
<a class="sourceLine" id="cb168-2" title="2"><span class="fu">chown</span> root:root /etc/cron.d</a>
<a class="sourceLine" id="cb168-3" title="3"><span class="fu">chmod</span> og-rwx /etc/cron.d</a>
<a class="sourceLine" id="cb168-4" title="4"><span class="co"># Fin: HARDE-RHEL-166</span></a>
<a class="sourceLine" id="cb168-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-165">Méthode d'audit</h3>
<h2 id="harde-rhel-167-">HARDE-RHEL-167 :</h2>
<h3 id="description-165">Description</h3>
<h3 id="références-165">Références</h3>
<h4 id="cis-165">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-165">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-160">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-165">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-167:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb169-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-167 : S&#39;assurer que les permissions sur /etc/ssh/sshd_config soient correctes&quot;</span></a>
<a class="sourceLine" id="cb169-2" title="2"><span class="fu">chown</span> root:root /etc/ssh/sshd_config</a>
<a class="sourceLine" id="cb169-3" title="3"><span class="fu">chmod</span> og-rwx /etc/ssh/sshd_config</a>
<a class="sourceLine" id="cb169-4" title="4"><span class="co"># Fin: HARDE-RHEL-167</span></a>
<a class="sourceLine" id="cb169-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-166">Méthode d'audit</h3>
<h2 id="harde-rhel-168-">HARDE-RHEL-168 :</h2>
<h3 id="description-166">Description</h3>
<h3 id="références-166">Références</h3>
<h4 id="cis-166">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-166">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-161">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-166">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-168:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb170-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-168 : S&#39;assurer que les permissions sur les clés privées d&#39;hôte SSH soient correctes&quot;</span></a>
<a class="sourceLine" id="cb170-2" title="2"><span class="fu">find</span> /etc/ssh -xdev -type f -name <span class="st">&#39;ssh_host_*_key&#39;</span> -exec chown root:root <span class="st">&quot;{}&quot;</span> <span class="st">&quot;;&quot;</span></a>
<a class="sourceLine" id="cb170-3" title="3"><span class="fu">find</span> /etc/ssh -xdev -type f -name <span class="st">&#39;ssh_host_*_key&#39;</span> -exec chmod 0600 <span class="st">&quot;{}&quot;</span> <span class="st">&quot;;&quot;</span></a>
<a class="sourceLine" id="cb170-4" title="4"><span class="co"># Fin: HARDE-RHEL-168</span></a>
<a class="sourceLine" id="cb170-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-167">Méthode d'audit</h3>
<h2 id="harde-rhel-169-">HARDE-RHEL-169 :</h2>
<h3 id="description-167">Description</h3>
<h3 id="références-167">Références</h3>
<h4 id="cis-167">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-167">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-162">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-167">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-169:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb171-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-169 : S&#39;assurer que les permissions sur les clés publiques d&#39;hôte soient correctes&quot;</span></a>
<a class="sourceLine" id="cb171-2" title="2"><span class="fu">find</span> /etc/ssh -xdev -type f -name <span class="st">&#39;ssh_host_*_key.pub&#39;</span> -exec chmod 0644 <span class="st">&quot;{}&quot;</span> <span class="st">&quot;;&quot;</span></a>
<a class="sourceLine" id="cb171-3" title="3"><span class="fu">find</span> /etc/ssh -xdev -type f -name <span class="st">&#39;ssh_host_*_key.pub&#39;</span> -exec chown root:root <span class="st">&quot;{}&quot;</span> <span class="st">&quot;;&quot;</span></a>
<a class="sourceLine" id="cb171-4" title="4"><span class="co"># Fin: HARDE-RHEL-169</span></a>
<a class="sourceLine" id="cb171-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-168">Méthode d'audit</h3>
<h2 id="harde-rhel-170-">HARDE-RHEL-170 :</h2>
<h3 id="description-168">Description</h3>
<h3 id="références-168">Références</h3>
<h4 id="cis-168">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-168">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-163">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-168">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-170:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb172-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-170 : S&#39;assurer que l&#39;umask utilisateur est ou plus restrictif&quot;</span></a>
<a class="sourceLine" id="cb172-2" title="2"><span class="co"># Shells non-interactifs</span></a>
<a class="sourceLine" id="cb172-3" title="3"><span class="fu">sed</span> -i -e <span class="st">&#39;s/umask 0../umask 027/&#39;</span> /etc/bashrc</a>
<a class="sourceLine" id="cb172-4" title="4"><span class="co"># Shells interactifs</span></a>
<a class="sourceLine" id="cb172-5" title="5"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/profile.d/umask.sh <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb172-6" title="6">umask 027</a>
<a class="sourceLine" id="cb172-7" title="7"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb172-8" title="8"><span class="co"># Fin: HARDE-RHEL-170</span></a>
<a class="sourceLine" id="cb172-9" title="9"></a></code></pre></div>
<h3 id="méthode-daudit-169">Méthode d'audit</h3>
<h2 id="harde-rhel-171-">HARDE-RHEL-171 :</h2>
<h3 id="description-169">Description</h3>
<h3 id="références-169">Références</h3>
<h4 id="cis-169">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-169">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-164">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-169">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-171:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb173-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-171 : Auditer les permissions du système de fichiers&quot;</span></a>
<a class="sourceLine" id="cb173-2" title="2"></a>
<a class="sourceLine" id="cb173-3" title="3"><span class="co"># Fin: HARDE-RHEL-171</span></a>
<a class="sourceLine" id="cb173-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-170">Méthode d'audit</h3>
<h2 id="harde-rhel-172-">HARDE-RHEL-172 :</h2>
<h3 id="description-170">Description</h3>
<h3 id="références-170">Références</h3>
<h4 id="cis-170">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-170">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-165">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-170">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-172:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb174-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-172 : S&#39;assurer qu&#39;aucun fichier en écriture pour tout le monde n&#39;existe&quot;</span></a>
<a class="sourceLine" id="cb174-2" title="2"></a>
<a class="sourceLine" id="cb174-3" title="3"><span class="co"># Fin: HARDE-RHEL-172</span></a>
<a class="sourceLine" id="cb174-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-171">Méthode d'audit</h3>
<h2 id="harde-rhel-173-">HARDE-RHEL-173 :</h2>
<h3 id="description-171">Description</h3>
<h3 id="références-171">Références</h3>
<h4 id="cis-171">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-171">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-166">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-171">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-173:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb175-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-173 : S&#39;assurer que tous les fichiers ont un propriétaire&quot;</span></a>
<a class="sourceLine" id="cb175-2" title="2"></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="co"># Fin: HARDE-RHEL-173</span></a>
<a class="sourceLine" id="cb175-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-172">Méthode d'audit</h3>
<h2 id="harde-rhel-174-">HARDE-RHEL-174 :</h2>
<h3 id="description-172">Description</h3>
<h3 id="références-172">Références</h3>
<h4 id="cis-172">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-172">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-167">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-172">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-174:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb176-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-174 : S&#39;assurer que tous les fichiers ont un groupe&quot;</span></a>
<a class="sourceLine" id="cb176-2" title="2"></a>
<a class="sourceLine" id="cb176-3" title="3"><span class="co"># Fin: HARDE-RHEL-174</span></a>
<a class="sourceLine" id="cb176-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-173">Méthode d'audit</h3>
<h2 id="harde-rhel-175-">HARDE-RHEL-175 :</h2>
<h3 id="description-173">Description</h3>
<h3 id="références-173">Références</h3>
<h4 id="cis-173">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-173">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-168">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-173">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-175:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb177-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-175 : Auditer les exécutables SUID&quot;</span></a>
<a class="sourceLine" id="cb177-2" title="2"><span class="fu">df</span> --local -P <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{if (NR!=1) print $6}&#39;</span> <span class="kw">|</span> <span class="fu">xargs</span> -I <span class="st">&#39;{}&#39;</span> find <span class="st">&#39;{}&#39;</span> -xdev -type f -perm -4000 -ls <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$HOME</span><span class="st">/</span><span class="va">$0</span><span class="st">-suid-</span><span class="va">$(</span><span class="fu">date</span> +<span class="st">&#39;%Y-%m-%d&#39;</span><span class="va">)</span><span class="st">.txt&quot;</span></a>
<a class="sourceLine" id="cb177-3" title="3"><span class="co"># Fin: HARDE-RHEL-175</span></a>
<a class="sourceLine" id="cb177-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-174">Méthode d'audit</h3>
<h2 id="harde-rhel-176-">HARDE-RHEL-176 :</h2>
<h3 id="description-174">Description</h3>
<h3 id="références-174">Références</h3>
<h4 id="cis-174">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-174">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-169">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-174">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-176:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb178-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-176 : Auditer les exécutables SGID&quot;</span></a>
<a class="sourceLine" id="cb178-2" title="2"><span class="fu">df</span> --local -P <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{if (NR!=1) print $6}&#39;</span> <span class="kw">|</span> <span class="fu">xargs</span> -I <span class="st">&#39;{}&#39;</span> find <span class="st">&#39;{}&#39;</span> -xdev -type f -perm -2000 -ls <span class="op">&gt;</span> <span class="st">&quot;</span><span class="va">$HOME</span><span class="st">/</span><span class="va">$0</span><span class="st">-sgid-</span><span class="va">$(</span><span class="fu">date</span> +<span class="st">&#39;%Y-%m-%d&#39;</span><span class="va">)</span><span class="st">.txt&quot;</span></a>
<a class="sourceLine" id="cb178-3" title="3"><span class="co"># Fin: HARDE-RHEL-176</span></a>
<a class="sourceLine" id="cb178-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-175">Méthode d'audit</h3>
<h2 id="harde-rhel-177-">HARDE-RHEL-177 :</h2>
<h3 id="description-175">Description</h3>
<h3 id="références-175">Références</h3>
<h4 id="cis-175">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-175">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-170">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-175">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-177:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb179-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-177 : S&#39;assurer que les permissions sur /etc/passwd soient correctes&quot;</span></a>
<a class="sourceLine" id="cb179-2" title="2"><span class="fu">chown</span> root:root /etc/passwd</a>
<a class="sourceLine" id="cb179-3" title="3"><span class="fu">chmod</span> 644 /etc/passwd</a>
<a class="sourceLine" id="cb179-4" title="4"><span class="co"># Fin: HARDE-RHEL-177</span></a>
<a class="sourceLine" id="cb179-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-176">Méthode d'audit</h3>
<h2 id="harde-rhel-178-">HARDE-RHEL-178 :</h2>
<h3 id="description-176">Description</h3>
<h3 id="références-176">Références</h3>
<h4 id="cis-176">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-176">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-171">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-176">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-178:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb180-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-178 : S&#39;assurer que les permissions sur /etc/shadow soient correctes&quot;</span></a>
<a class="sourceLine" id="cb180-2" title="2"><span class="fu">chown</span> root:root /etc/shadow</a>
<a class="sourceLine" id="cb180-3" title="3"><span class="fu">chmod</span> o-rwx,g-wx /etc/shadow</a>
<a class="sourceLine" id="cb180-4" title="4"><span class="co"># Fin: HARDE-RHEL-178</span></a>
<a class="sourceLine" id="cb180-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-177">Méthode d'audit</h3>
<h2 id="harde-rhel-179-">HARDE-RHEL-179 :</h2>
<h3 id="description-177">Description</h3>
<h3 id="références-177">Références</h3>
<h4 id="cis-177">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-177">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-172">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-177">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-179:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb181-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-179 : S&#39;assurer que les permissions sur /etc/group soient correctes&quot;</span></a>
<a class="sourceLine" id="cb181-2" title="2"><span class="fu">chown</span> root:root /etc/group</a>
<a class="sourceLine" id="cb181-3" title="3"><span class="fu">chmod</span> 644 /etc/group</a>
<a class="sourceLine" id="cb181-4" title="4"><span class="co"># Fin: HARDE-RHEL-179</span></a>
<a class="sourceLine" id="cb181-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-178">Méthode d'audit</h3>
<h2 id="harde-rhel-180-">HARDE-RHEL-180 :</h2>
<h3 id="description-178">Description</h3>
<h3 id="références-178">Références</h3>
<h4 id="cis-178">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-178">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-173">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-178">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-180:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb182-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-180 : S&#39;assurer que les permissions sur /etc/gshadow soient correctes&quot;</span></a>
<a class="sourceLine" id="cb182-2" title="2"><span class="fu">chown</span> root:root /etc/gshadow</a>
<a class="sourceLine" id="cb182-3" title="3"><span class="fu">chmod</span> o-rwx,g-rw /etc/gshadow</a>
<a class="sourceLine" id="cb182-4" title="4"><span class="co"># Fin: HARDE-RHEL-180</span></a>
<a class="sourceLine" id="cb182-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-179">Méthode d'audit</h3>
<h2 id="harde-rhel-181-">HARDE-RHEL-181 :</h2>
<h3 id="description-179">Description</h3>
<h3 id="références-179">Références</h3>
<h4 id="cis-179">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-179">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-174">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-179">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-181:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb183-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-181 : S&#39;assurer que les permissions sur /etc/passwd- soient correctes&quot;</span></a>
<a class="sourceLine" id="cb183-2" title="2"><span class="fu">chown</span> root:root /etc/passwd-</a>
<a class="sourceLine" id="cb183-3" title="3"><span class="fu">chmod</span> u-x,go-rwx /etc/passwd-</a>
<a class="sourceLine" id="cb183-4" title="4"><span class="co"># Fin: HARDE-RHEL-181</span></a>
<a class="sourceLine" id="cb183-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-180">Méthode d'audit</h3>
<h2 id="harde-rhel-182-">HARDE-RHEL-182 :</h2>
<h3 id="description-180">Description</h3>
<h3 id="références-180">Références</h3>
<h4 id="cis-180">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-180">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-175">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-180">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-182:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb184-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-182 : S&#39;assurer que les permissions sur /etc/shadow- soient correctes&quot;</span></a>
<a class="sourceLine" id="cb184-2" title="2"><span class="fu">chown</span> root:root /etc/shadow-</a>
<a class="sourceLine" id="cb184-3" title="3"><span class="fu">chmod</span> u-x,go-rwx /etc/shadow-</a>
<a class="sourceLine" id="cb184-4" title="4"><span class="co"># Fin: HARDE-RHEL-182</span></a>
<a class="sourceLine" id="cb184-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-181">Méthode d'audit</h3>
<h2 id="harde-rhel-183-">HARDE-RHEL-183 :</h2>
<h3 id="description-181">Description</h3>
<h3 id="références-181">Références</h3>
<h4 id="cis-181">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-181">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-176">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-181">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-183:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb185-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-183 : S&#39;assurer que les permissions sur /etc/group- soient correctes&quot;</span></a>
<a class="sourceLine" id="cb185-2" title="2"><span class="fu">chown</span> root:root /etc/group-</a>
<a class="sourceLine" id="cb185-3" title="3"><span class="fu">chmod</span> u-x,go-wx /etc/group-</a>
<a class="sourceLine" id="cb185-4" title="4"><span class="co"># Fin: HARDE-RHEL-183</span></a>
<a class="sourceLine" id="cb185-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-182">Méthode d'audit</h3>
<h2 id="harde-rhel-184-">HARDE-RHEL-184 :</h2>
<h3 id="description-182">Description</h3>
<h3 id="références-182">Références</h3>
<h4 id="cis-182">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-182">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-177">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-182">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-184:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb186-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-184 : S&#39;assurer que les permissions sur /etc/gshadow- soient correctes&quot;</span></a>
<a class="sourceLine" id="cb186-2" title="2"><span class="fu">chown</span> root:root /etc/gshadow-</a>
<a class="sourceLine" id="cb186-3" title="3"><span class="fu">chmod</span> o-rwx,g-rw /etc/gshadow-</a>
<a class="sourceLine" id="cb186-4" title="4"><span class="co"># Fin: HARDE-RHEL-184</span></a>
<a class="sourceLine" id="cb186-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-183">Méthode d'audit</h3>
<h2 id="harde-rhel-185-">HARDE-RHEL-185 :</h2>
<h3 id="description-183">Description</h3>
<h3 id="références-183">Références</h3>
<h4 id="cis-183">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-183">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-178">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-183">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-185:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb187-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-185 : S&#39;assurer que les utilisateurs n&#39;ont pas de fichier .forward&quot;</span></a>
<a class="sourceLine" id="cb187-2" title="2"></a>
<a class="sourceLine" id="cb187-3" title="3"><span class="co"># Fin: HARDE-RHEL-185</span></a>
<a class="sourceLine" id="cb187-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-184">Méthode d'audit</h3>
<h2 id="harde-rhel-186-">HARDE-RHEL-186 :</h2>
<h3 id="description-184">Description</h3>
<h3 id="références-184">Références</h3>
<h4 id="cis-184">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-184">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-179">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-184">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-186:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb188-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-186 : S&#39;assurer que les utilisateurs n&#39;ont pas de fichier .netrc&quot;</span></a>
<a class="sourceLine" id="cb188-2" title="2"></a>
<a class="sourceLine" id="cb188-3" title="3"><span class="co"># Fin: HARDE-RHEL-186</span></a>
<a class="sourceLine" id="cb188-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-185">Méthode d'audit</h3>
<h2 id="harde-rhel-187-">HARDE-RHEL-187 :</h2>
<h3 id="description-185">Description</h3>
<h3 id="références-185">Références</h3>
<h4 id="cis-185">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-185">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-180">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-185">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-187:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb189-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-187 : S&#39;assurer que les fichiers .netrc ne soint pas accessibles en écriture&quot;</span></a>
<a class="sourceLine" id="cb189-2" title="2"></a>
<a class="sourceLine" id="cb189-3" title="3"><span class="co"># Fin: HARDE-RHEL-187</span></a>
<a class="sourceLine" id="cb189-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-186">Méthode d'audit</h3>
<h2 id="harde-rhel-188-">HARDE-RHEL-188 :</h2>
<h3 id="description-186">Description</h3>
<h3 id="références-186">Références</h3>
<h4 id="cis-186">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-186">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-181">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-186">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-188:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb190-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-188 : S&#39;assurer qu&#39;il n&#39;existe pas de fichier .rhosts&quot;</span></a>
<a class="sourceLine" id="cb190-2" title="2"></a>
<a class="sourceLine" id="cb190-3" title="3"><span class="co"># Fin: HARDE-RHEL-188</span></a>
<a class="sourceLine" id="cb190-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-187">Méthode d'audit</h3>
<h2 id="harde-rhel-189-">HARDE-RHEL-189 :</h2>
<h3 id="description-187">Description</h3>
<h3 id="références-187">Références</h3>
<h4 id="cis-187">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-187">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-182">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-187">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-189:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb191-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-189 : S&#39;assurer que tous les groupes de /etc/passwd existent dans /etc/group&quot;</span></a>
<a class="sourceLine" id="cb191-2" title="2"></a>
<a class="sourceLine" id="cb191-3" title="3"><span class="co"># Fin: HARDE-RHEL-189</span></a>
<a class="sourceLine" id="cb191-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-188">Méthode d'audit</h3>
<h2 id="harde-rhel-190-">HARDE-RHEL-190 :</h2>
<h3 id="description-188">Description</h3>
<h3 id="références-188">Références</h3>
<h4 id="cis-188">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-188">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-183">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-188">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-190:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb192-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-190 : S&#39;assurer qu&#39;il n&#39;y a pas d&#39;UIDs dupliqués&quot;</span></a>
<a class="sourceLine" id="cb192-2" title="2"></a>
<a class="sourceLine" id="cb192-3" title="3"><span class="co"># Fin: HARDE-RHEL-190</span></a>
<a class="sourceLine" id="cb192-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-189">Méthode d'audit</h3>
<h2 id="harde-rhel-191-">HARDE-RHEL-191 :</h2>
<h3 id="description-189">Description</h3>
<h3 id="références-189">Références</h3>
<h4 id="cis-189">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-189">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-184">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-189">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-191:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb193-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-191 : S&#39;assurer qu&#39;il n&#39;y a pas de GIDs dupliqués&quot;</span></a>
<a class="sourceLine" id="cb193-2" title="2"></a>
<a class="sourceLine" id="cb193-3" title="3"><span class="co"># Fin: HARDE-RHEL-191</span></a>
<a class="sourceLine" id="cb193-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-190">Méthode d'audit</h3>
<h2 id="harde-rhel-192-">HARDE-RHEL-192 :</h2>
<h3 id="description-190">Description</h3>
<h3 id="références-190">Références</h3>
<h4 id="cis-190">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-190">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-185">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-190">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-192:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb194-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-192 : S&#39;assurer qu&#39;il n&#39;y a pas de de doublons dans les noms d&#39;utilisateur&quot;</span></a>
<a class="sourceLine" id="cb194-2" title="2"></a>
<a class="sourceLine" id="cb194-3" title="3"><span class="co"># Fin: HARDE-RHEL-192</span></a>
<a class="sourceLine" id="cb194-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-191">Méthode d'audit</h3>
<h2 id="harde-rhel-193-">HARDE-RHEL-193 :</h2>
<h3 id="description-191">Description</h3>
<h3 id="références-191">Références</h3>
<h4 id="cis-191">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-191">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-186">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-191">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-193:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb195-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-193 : S&#39;assurer que qu&#39;il n&#39;y a pas de de doublons dans les noms de groupe&quot;</span></a>
<a class="sourceLine" id="cb195-2" title="2"></a>
<a class="sourceLine" id="cb195-3" title="3"><span class="co"># Fin: HARDE-RHEL-193</span></a>
<a class="sourceLine" id="cb195-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-192">Méthode d'audit</h3>
<h2 id="harde-rhel-194-">HARDE-RHEL-194 :</h2>
<h3 id="description-192">Description</h3>
<h3 id="références-192">Références</h3>
<h4 id="cis-192">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-192">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-187">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-192">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-194:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb196-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-194 : S&#39;assurer qu&#39;il n&#39;y a pas de groupe shadow&quot;</span></a>
<a class="sourceLine" id="cb196-2" title="2"></a>
<a class="sourceLine" id="cb196-3" title="3"><span class="co"># Fin: HARDE-RHEL-194</span></a>
<a class="sourceLine" id="cb196-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-193">Méthode d'audit</h3>
<h2 id="harde-rhel-195-">HARDE-RHEL-195 :</h2>
<h3 id="description-193">Description</h3>
<h3 id="références-193">Références</h3>
<h4 id="cis-193">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-193">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-188">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-193">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-195:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb197-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-195 : Vérifier que tous les utilisateurs aient un répertoire d&#39;accueil&quot;</span></a>
<a class="sourceLine" id="cb197-2" title="2"></a>
<a class="sourceLine" id="cb197-3" title="3"><span class="co"># Fin: HARDE-RHEL-195</span></a>
<a class="sourceLine" id="cb197-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-194">Méthode d'audit</h3>
<h2 id="harde-rhel-196-">HARDE-RHEL-196 :</h2>
<h3 id="description-194">Description</h3>
<h3 id="références-194">Références</h3>
<h4 id="cis-194">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-194">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-189">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-194">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-196:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb198-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-196 : S&#39;assurer que les permissions sur les répertoire d&#39;accueil des utilisateurs soit 750 ou plus restrictif&quot;</span></a>
<a class="sourceLine" id="cb198-2" title="2"></a>
<a class="sourceLine" id="cb198-3" title="3"><span class="co"># Fin: HARDE-RHEL-196</span></a>
<a class="sourceLine" id="cb198-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-195">Méthode d'audit</h3>
<h2 id="harde-rhel-197-">HARDE-RHEL-197 :</h2>
<h3 id="description-195">Description</h3>
<h3 id="références-195">Références</h3>
<h4 id="cis-195">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-195">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-190">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-195">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-197:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb199-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-197 : S&#39;assurer que les utilisateurs possèdent leurs répertoires d&#39;accueil&quot;</span></a>
<a class="sourceLine" id="cb199-2" title="2"></a>
<a class="sourceLine" id="cb199-3" title="3"><span class="co"># Fin: HARDE-RHEL-197</span></a>
<a class="sourceLine" id="cb199-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-196">Méthode d'audit</h3>
<h2 id="harde-rhel-198-">HARDE-RHEL-198 :</h2>
<h3 id="description-196">Description</h3>
<h3 id="références-196">Références</h3>
<h4 id="cis-196">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-196">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-191">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-196">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-198:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb200-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-198 : S&#39;assurer que les fichiers de configuration des utilisateurs ne soient pas ouverts en écriture au groupe ou à tout le monde&quot;</span></a>
<a class="sourceLine" id="cb200-2" title="2"></a>
<a class="sourceLine" id="cb200-3" title="3"><span class="co"># Fin: HARDE-RHEL-198</span></a>
<a class="sourceLine" id="cb200-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-197">Méthode d'audit</h3>
<h2 id="harde-rhel-199-">HARDE-RHEL-199 :</h2>
<h3 id="description-197">Description</h3>
<h3 id="références-197">Références</h3>
<h4 id="cis-197">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-197">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-192">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-197">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-199:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb201-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-199 : Droits d&#39;accès aux fichiers de contenu sensible&quot;</span></a>
<a class="sourceLine" id="cb201-2" title="2"></a>
<a class="sourceLine" id="cb201-3" title="3"><span class="co"># Fin: HARDE-RHEL-199</span></a>
<a class="sourceLine" id="cb201-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-198">Méthode d'audit</h3>
<h2 id="harde-rhel-200-">HARDE-RHEL-200 :</h2>
<h3 id="description-198">Description</h3>
<h3 id="références-198">Références</h3>
<h4 id="cis-198">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-198">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-193">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-198">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-200:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb202-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-200 : Sécurisation des accès pour les sockets et pipes&quot;</span></a>
<a class="sourceLine" id="cb202-2" title="2"></a>
<a class="sourceLine" id="cb202-3" title="3"><span class="co"># Fin: HARDE-RHEL-200</span></a>
<a class="sourceLine" id="cb202-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-199">Méthode d'audit</h3>
<h2 id="harde-rhel-201-">HARDE-RHEL-201 :</h2>
<h3 id="description-199">Description</h3>
<h3 id="références-199">Références</h3>
<h4 id="cis-199">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-199">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-194">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-199">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-201:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb203-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-201 : Protection de la base de données des scellés&quot;</span></a>
<a class="sourceLine" id="cb203-2" title="2"></a>
<a class="sourceLine" id="cb203-3" title="3"><span class="co"># Fin: HARDE-RHEL-201</span></a>
<a class="sourceLine" id="cb203-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-200">Méthode d'audit</h3>
<h2 id="harde-rhel-202-">HARDE-RHEL-202 :</h2>
<h3 id="description-200">Description</h3>
<h3 id="références-200">Références</h3>
<h4 id="cis-200">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-200">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-195">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-200">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-202:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb204-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-202 : Désactiver la création de core dumps&quot;</span></a>
<a class="sourceLine" id="cb204-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/15suid_dumpable.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb204-3" title="3"># Pas de core dump des exécutables setuid</a>
<a class="sourceLine" id="cb204-4" title="4">fs.suid_dumpable = 0</a>
<a class="sourceLine" id="cb204-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb204-6" title="6"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/security/limits.d/10core.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb204-7" title="7">* hard core 0</a>
<a class="sourceLine" id="cb204-8" title="8"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb204-9" title="9"><span class="co"># Fin: HARDE-RHEL-202</span></a>
<a class="sourceLine" id="cb204-10" title="10"></a></code></pre></div>
<h3 id="méthode-daudit-201">Méthode d'audit</h3>
<h2 id="harde-rhel-203-">HARDE-RHEL-203 :</h2>
<h3 id="description-201">Description</h3>
<h3 id="références-201">Références</h3>
<h4 id="cis-201">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-201">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-196">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-201">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-203:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb205-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-203 : Activer l&#39;aléatoire dans l&#39;organisation de l&#39;espace d&#39;adressage&quot;</span></a>
<a class="sourceLine" id="cb205-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/20aslr.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb205-3" title="3"># Activation de l&#39;ASLR</a>
<a class="sourceLine" id="cb205-4" title="4">kernel.randomize_va_space = 2</a>
<a class="sourceLine" id="cb205-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb205-6" title="6"><span class="co"># Fin: HARDE-RHEL-203</span></a>
<a class="sourceLine" id="cb205-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-202">Méthode d'audit</h3>
<h2 id="harde-rhel-204-">HARDE-RHEL-204 :</h2>
<h3 id="description-202">Description</h3>
<h3 id="références-202">Références</h3>
<h4 id="cis-202">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-202">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-197">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-202">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-204:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb206-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-204 : Paramètrage des sysctl système&quot;</span></a>
<a class="sourceLine" id="cb206-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/10anssi.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb206-3" title="3"># Désactivation des SysReq</a>
<a class="sourceLine" id="cb206-4" title="4">kernel.sysrq = 0</a>
<a class="sourceLine" id="cb206-5" title="5"># Interdiction de déréférencer des liens vers des fichiers dont</a>
<a class="sourceLine" id="cb206-6" title="6"># l&#39;utilisateur courant n&#39;est pas le propriétaire</a>
<a class="sourceLine" id="cb206-7" title="7"># Peut empêcher certains programmes de fonctionner correctement</a>
<a class="sourceLine" id="cb206-8" title="8">fs.protected_symlinks = 1</a>
<a class="sourceLine" id="cb206-9" title="9">fs.protected_hardlinks = 1</a>
<a class="sourceLine" id="cb206-10" title="10"># Interdiction de mapper de la mémoire dans les adresses basses (0)</a>
<a class="sourceLine" id="cb206-11" title="11">vm.mmap_min_addr = 65536</a>
<a class="sourceLine" id="cb206-12" title="12"># Espace de choix plus grand pour les valeurs de PID</a>
<a class="sourceLine" id="cb206-13" title="13">kernel.pid_max = 65536</a>
<a class="sourceLine" id="cb206-14" title="14"># Obfuscation des adresses mémoire kernel</a>
<a class="sourceLine" id="cb206-15" title="15">kernel.kptr_restrict = 1</a>
<a class="sourceLine" id="cb206-16" title="16"># Restriction d&#39;accès au buffer dmesg</a>
<a class="sourceLine" id="cb206-17" title="17">kernel.dmesg_restrict = 1</a>
<a class="sourceLine" id="cb206-18" title="18"># Restreint l&#39;utilisation du sous système perf</a>
<a class="sourceLine" id="cb206-19" title="19">kernel.perf_event_paranoid = 2</a>
<a class="sourceLine" id="cb206-20" title="20">kernel.perf_event_max_sample_rate = 1</a>
<a class="sourceLine" id="cb206-21" title="21">kernel.perf_cpu_time_max_percent = 1</a>
<a class="sourceLine" id="cb206-22" title="22"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb206-23" title="23"><span class="co"># Fin: HARDE-RHEL-204</span></a>
<a class="sourceLine" id="cb206-24" title="24"></a></code></pre></div>
<h3 id="méthode-daudit-203">Méthode d'audit</h3>
<h2 id="harde-rhel-205--désactivation-du-chargement-des-modules-noyau">HARDE-RHEL-205 : Désactivation du chargement des modules noyau</h2>
<h3 id="description-203">Description</h3>
<p>Le chargement des modules est interdit par un service lancé à la fin du processus de démarrage (via un booléen SELinux et la désactivation de certains modules). En particulier, le stockage USB, les CD-ROM et les systèmes de fichiers sont inaccessibles en appliquant cette règle.</p>
<p>Un commande <code>/etc/maintenance_mode.sh</code> permet de basculer dans un mode où le chargement est autorisé par exemple, lors d'une mise à jour. Une fois lancée, le système doit être redémarré.</p>
<h3 id="références-203">Références</h3>
<h4 id="cis-203">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-203">ANSSI</h4>
<p>Référence ANSSI: R24</p>
<h4 id="niveau-de-durcissement-3">Niveau de Durcissement: 3</h4>
<h4 id="méthode-à-suivre-203">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-205:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb207-1" title="1"><span class="co">#! /usr/bin/env bash</span></a>
<a class="sourceLine" id="cb207-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-205 : Désactivation du chargement des modules noyau&quot;</span></a>
<a class="sourceLine" id="cb207-3" title="3"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/maintenance_mode.sh <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb207-4" title="4">#! /bin/bash</a>
<a class="sourceLine" id="cb207-5" title="5">[ <span class="va">$(</span><span class="ex">getsebool</span> secure_mode_insmod <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $3}&#39;</span><span class="va">)</span> = &quot;off&quot; ]  &amp;&amp; echo &quot;Currently in maintenance mode&quot;</a>
<a class="sourceLine" id="cb207-6" title="6">if [ ! -f /SECURE_INSMOD_DISABLED ] ; then</a>
<a class="sourceLine" id="cb207-7" title="7">    touch /SECURE_INSMOD_DISABLED</a>
<a class="sourceLine" id="cb207-8" title="8">    echo &quot;Maintenance mode will be enabled on next boot.&quot;</a>
<a class="sourceLine" id="cb207-9" title="9">    echo &quot;Run again to disable.&quot;</a>
<a class="sourceLine" id="cb207-10" title="10">else</a>
<a class="sourceLine" id="cb207-11" title="11">    rm /SECURE_INSMOD_DISABLED</a>
<a class="sourceLine" id="cb207-12" title="12">    echo &quot;Maintenance mode will *NOT* be enabled on next boot.&quot;</a>
<a class="sourceLine" id="cb207-13" title="13">fi</a>
<a class="sourceLine" id="cb207-14" title="14">EOF</a>
<a class="sourceLine" id="cb207-15" title="15">chmod 0700 /etc/maintenance_mode.sh</a>
<a class="sourceLine" id="cb207-16" title="16">cat &gt;/etc/secure_insmod.sh &lt;&lt;EOF</a>
<a class="sourceLine" id="cb207-17" title="17">#! /bin/bash</a>
<a class="sourceLine" id="cb207-18" title="18">declare -a blacklist</a>
<a class="sourceLine" id="cb207-19" title="19">blacklist=(</a>
<a class="sourceLine" id="cb207-20" title="20">    [0]=&quot;usb-storage&quot;</a>
<a class="sourceLine" id="cb207-21" title="21">    [1]=&quot;cramfs&quot;</a>
<a class="sourceLine" id="cb207-22" title="22">    [2]=&quot;freevxfs&quot;</a>
<a class="sourceLine" id="cb207-23" title="23">    [3]=&quot;jffs2&quot;</a>
<a class="sourceLine" id="cb207-24" title="24">    [4]=&quot;hfs&quot;</a>
<a class="sourceLine" id="cb207-25" title="25">    [5]=&quot;hfsplus&quot;</a>
<a class="sourceLine" id="cb207-26" title="26">    [6]=&quot;squashfs&quot;</a>
<a class="sourceLine" id="cb207-27" title="27">    [7]=&quot;crc-itu-t&quot;</a>
<a class="sourceLine" id="cb207-28" title="28">    [8]=&quot;udf&quot;</a>
<a class="sourceLine" id="cb207-29" title="29">    [9]=&quot;fat&quot;</a>
<a class="sourceLine" id="cb207-30" title="30">    [10]=&quot;vfat&quot;</a>
<a class="sourceLine" id="cb207-31" title="31">)</a>
<a class="sourceLine" id="cb207-32" title="32">if [ ! -f /SECURE_INSMOD_DISABLED ] ; then</a>
<a class="sourceLine" id="cb207-33" title="33">    # Explicitely disable some modules</a>
<a class="sourceLine" id="cb207-34" title="34">    for module in &quot;<span class="dt">\$</span>{blacklist[@]}&quot;; do</a>
<a class="sourceLine" id="cb207-35" title="35">        [ -e &quot;/etc/modprobe.d/<span class="dt">\$</span>module.conf&quot; ] || echo &quot;install <span class="dt">\$</span>module /bin/true&quot; &gt;&quot;/etc/modprobe.d/<span class="dt">\$</span>module.conf&quot;</a>
<a class="sourceLine" id="cb207-36" title="36">    done</a>
<a class="sourceLine" id="cb207-37" title="37">    setsebool secure_mode_insmod on</a>
<a class="sourceLine" id="cb207-38" title="38">    sysctl -w kernel.modules_disabled=1</a>
<a class="sourceLine" id="cb207-39" title="39">    exit 0</a>
<a class="sourceLine" id="cb207-40" title="40">else</a>
<a class="sourceLine" id="cb207-41" title="41">    # Re-instate disabled modules</a>
<a class="sourceLine" id="cb207-42" title="42">    for module in &quot;<span class="dt">\$</span>{blacklist[@]}&quot;; do</a>
<a class="sourceLine" id="cb207-43" title="43">        rm -f &quot;/etc/modprobe.d/<span class="dt">\$</span>module.conf&quot;</a>
<a class="sourceLine" id="cb207-44" title="44">    done</a>
<a class="sourceLine" id="cb207-45" title="45">    setsebool secure_mode_insmod off</a>
<a class="sourceLine" id="cb207-46" title="46">    mount /boot</a>
<a class="sourceLine" id="cb207-47" title="47">    mount /boot/efi</a>
<a class="sourceLine" id="cb207-48" title="48">    modprobe iso9660</a>
<a class="sourceLine" id="cb207-49" title="49">    echo &quot;Secure insmod is DISABLED.&quot;</a>
<a class="sourceLine" id="cb207-50" title="50">    rm -f /SECURE_INSMOD_DISABLED</a>
<a class="sourceLine" id="cb207-51" title="51">fi</a>
<a class="sourceLine" id="cb207-52" title="52">exit 0</a>
<a class="sourceLine" id="cb207-53" title="53">EOF</a>
<a class="sourceLine" id="cb207-54" title="54">chmod 0700 /etc/secure_insmod.sh</a>
<a class="sourceLine" id="cb207-55" title="55">cat &gt;/etc/systemd/system/secure_insmod.service &lt;&lt;EOF</a>
<a class="sourceLine" id="cb207-56" title="56">[Unit]</a>
<a class="sourceLine" id="cb207-57" title="57">Description=Script to prevents any further module loading</a>
<a class="sourceLine" id="cb207-58" title="58">After=default.target</a>
<a class="sourceLine" id="cb207-59" title="59"></a>
<a class="sourceLine" id="cb207-60" title="60">[Service]</a>
<a class="sourceLine" id="cb207-61" title="61">Type=oneshot</a>
<a class="sourceLine" id="cb207-62" title="62">ExecStart=/etc/secure_insmod.sh</a>
<a class="sourceLine" id="cb207-63" title="63">ExecStop=/etc/secure_insmod.sh</a>
<a class="sourceLine" id="cb207-64" title="64">TimeoutStartSec=0</a>
<a class="sourceLine" id="cb207-65" title="65"></a>
<a class="sourceLine" id="cb207-66" title="66">[Install]</a>
<a class="sourceLine" id="cb207-67" title="67">WantedBy=default.target</a>
<a class="sourceLine" id="cb207-68" title="68">EOF</a>
<a class="sourceLine" id="cb207-69" title="69">systemctl enable secure_insmod</a>
<a class="sourceLine" id="cb207-70" title="70"># Fin: HARDE-RHEL-205</a>
<a class="sourceLine" id="cb207-71" title="71"></a></code></pre></div>
<h3 id="méthode-daudit-204">Méthode d'audit</h3>
<h2 id="harde-rhel-206-">HARDE-RHEL-206 :</h2>
<h3 id="description-204">Description</h3>
<h3 id="références-204">Références</h3>
<h4 id="cis-204">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-204">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-198">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-204">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-206:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb208-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-206 : Configuration sysctl du module Yama&quot;</span></a>
<a class="sourceLine" id="cb208-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sysctl.d/25yama.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb208-3" title="3">kernel.yama.ptrace_scope = 1</a>
<a class="sourceLine" id="cb208-4" title="4"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb208-5" title="5"><span class="co"># Fin: HARDE-RHEL-206</span></a>
<a class="sourceLine" id="cb208-6" title="6"></a></code></pre></div>
<h3 id="méthode-daudit-205">Méthode d'audit</h3>
<h2 id="harde-rhel-207-">HARDE-RHEL-207 :</h2>
<h3 id="description-205">Description</h3>
<h3 id="références-205">Références</h3>
<h4 id="cis-205">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-205">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-199">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-205">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-207:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb209-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-207 : Partition séparée pour /var/log&quot;</span></a>
<a class="sourceLine" id="cb209-2" title="2"><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> -q -E <span class="st">&#39;/var/log\s&#39;</span> <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;/var/log n&#39;est pas une partition séparée !&quot;</span></a>
<a class="sourceLine" id="cb209-3" title="3"><span class="co"># Fin: HARDE-RHEL-207</span></a>
<a class="sourceLine" id="cb209-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-206">Méthode d'audit</h3>
<h2 id="harde-rhel-208-">HARDE-RHEL-208 :</h2>
<h3 id="description-206">Description</h3>
<h3 id="références-206">Références</h3>
<h4 id="cis-206">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-206">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-200">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-206">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-208:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb210-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-208 : Partition séparée pour /var/log/audit&quot;</span></a>
<a class="sourceLine" id="cb210-2" title="2"><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> -q -E <span class="st">&#39;/var/log/audit\s&#39;</span> <span class="kw">||</span> <span class="ex">harde_error</span> <span class="st">&quot;/var/log/audit n&#39;est pas une partition séparée !&quot;</span></a>
<a class="sourceLine" id="cb210-3" title="3"><span class="co"># Fin: HARDE-RHEL-208</span></a>
<a class="sourceLine" id="cb210-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-207">Méthode d'audit</h3>
<h2 id="harde-rhel-209-">HARDE-RHEL-209 :</h2>
<h3 id="description-207">Description</h3>
<h3 id="références-207">Références</h3>
<h4 id="cis-207">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-207">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-201">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-207">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-209:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb211-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-209 : Journal spécifique pour sudo&quot;</span></a>
<a class="sourceLine" id="cb211-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/sudoers.d/05log <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb211-3" title="3">Defaults logfile=&quot;/var/log/sudo/sudo.log&quot;</a>
<a class="sourceLine" id="cb211-4" title="4"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb211-5" title="5"><span class="fu">mkdir</span> /var/log/sudo</a>
<a class="sourceLine" id="cb211-6" title="6"><span class="ex">semanage</span> fcontext --add -t sudo_log_t /var/log/sudo </a>
<a class="sourceLine" id="cb211-7" title="7"><span class="ex">restorecon</span> -R -v /var/log/sudo</a>
<a class="sourceLine" id="cb211-8" title="8"><span class="co"># Fin: HARDE-RHEL-209</span></a>
<a class="sourceLine" id="cb211-9" title="9"></a></code></pre></div>
<h3 id="méthode-daudit-208">Méthode d'audit</h3>
<h2 id="harde-rhel-210-">HARDE-RHEL-210 :</h2>
<h3 id="description-208">Description</h3>
<h3 id="références-208">Références</h3>
<h4 id="cis-208">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-208">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-202">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-208">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-210:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb212-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-210 : S&#39;assurer qu&#39;auditd est installé&quot;</span></a>
<a class="sourceLine" id="cb212-2" title="2"><span class="ex">dnf</span> install audit audit-libs</a>
<a class="sourceLine" id="cb212-3" title="3"><span class="co"># Fin: HARDE-RHEL-210</span></a>
<a class="sourceLine" id="cb212-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-209">Méthode d'audit</h3>
<h2 id="harde-rhel-211-">HARDE-RHEL-211 :</h2>
<h3 id="description-209">Description</h3>
<h3 id="références-209">Références</h3>
<h4 id="cis-209">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-209">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-203">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-209">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-211:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb213-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-211 : S&#39;assurer que le service auditd est activé&quot;</span></a>
<a class="sourceLine" id="cb213-2" title="2"><span class="ex">systemctl</span> --now enable auditd</a>
<a class="sourceLine" id="cb213-3" title="3"><span class="co"># Fin: HARDE-RHEL-211</span></a>
<a class="sourceLine" id="cb213-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-210">Méthode d'audit</h3>
<h2 id="harde-rhel-212-">HARDE-RHEL-212 :</h2>
<h3 id="description-210">Description</h3>
<h3 id="références-210">Références</h3>
<h4 id="cis-210">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-210">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-204">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-210">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-212:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb214-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-212 : S&#39;assurer que l&#39;audit commence au plus tôt&quot;</span></a>
<a class="sourceLine" id="cb214-2" title="2"><span class="kw">if</span> ! <span class="fu">grep</span> -q -E <span class="st">&#39;auditd=&#39;</span> /etc/default/grub <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(GRUB_CMDLINE_LINUX=&quot;[^&quot;]*\)&quot;/\1 auditd=1&quot;/&#39;</span> -i /etc/default/grub <span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;Parameter auditd added.&quot;</span><span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb214-3" title="3"><span class="ex">grub2-mkconfig</span> –o /boot/grub2/grub.cfg <span class="op">&gt;</span>/dev/null</a>
<a class="sourceLine" id="cb214-4" title="4"><span class="ex">grub2-mkconfig</span> –o /boot/efi/EFI/grub.cfg  <span class="op">&gt;</span>/dev/null</a>
<a class="sourceLine" id="cb214-5" title="5"><span class="co"># Fin: HARDE-RHEL-212</span></a>
<a class="sourceLine" id="cb214-6" title="6"></a></code></pre></div>
<h3 id="méthode-daudit-211">Méthode d'audit</h3>
<h2 id="harde-rhel-213-">HARDE-RHEL-213 :</h2>
<h3 id="description-211">Description</h3>
<h3 id="références-211">Références</h3>
<h4 id="cis-211">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-211">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-205">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-211">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-213:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb215-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-213 : S&#39;assurer que la valeur d&#39;audit_backlog_limit est suffisante&quot;</span></a>
<a class="sourceLine" id="cb215-2" title="2"><span class="kw">if</span> ! <span class="fu">grep</span> -q -E <span class="st">&#39;audit_backlog_limit=&#39;</span> /etc/default/grub <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(GRUB_CMDLINE_LINUX=&quot;[^&quot;]*\)&quot;/\1 audit_backlog_limit=8192&quot;/&#39;</span> -i /etc/default/grub <span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;Parameter audit_backlog_limit added.&quot;</span><span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb215-3" title="3"><span class="ex">grub2-mkconfig</span> –o /boot/grub2/grub.cfg <span class="op">&gt;</span>/dev/null</a>
<a class="sourceLine" id="cb215-4" title="4"><span class="ex">grub2-mkconfig</span> –o /boot/efi/EFI/grub.cfg  <span class="op">&gt;</span>/dev/null</a>
<a class="sourceLine" id="cb215-5" title="5"><span class="co"># Fin: HARDE-RHEL-213</span></a>
<a class="sourceLine" id="cb215-6" title="6"></a></code></pre></div>
<h3 id="méthode-daudit-212">Méthode d'audit</h3>
<h2 id="harde-rhel-214-">HARDE-RHEL-214 :</h2>
<h3 id="description-212">Description</h3>
<h3 id="références-212">Références</h3>
<h4 id="cis-212">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-212">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-206">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-212">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-214:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb216-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-214 : Tracer les tentatives d&#39;accès aux fichiers refusées &quot;</span></a>
<a class="sourceLine" id="cb216-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/35access.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb216-3" title="3">-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=4294967295 -k access</a>
<a class="sourceLine" id="cb216-4" title="4">-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=4294967295 -k access</a>
<a class="sourceLine" id="cb216-5" title="5">-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=4294967295 -k access</a>
<a class="sourceLine" id="cb216-6" title="6">-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=4294967295 -k access</a>
<a class="sourceLine" id="cb216-7" title="7"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb216-8" title="8"><span class="co"># Fin: HARDE-RHEL-214</span></a>
<a class="sourceLine" id="cb216-9" title="9"></a></code></pre></div>
<h3 id="méthode-daudit-213">Méthode d'audit</h3>
<h2 id="harde-rhel-215-">HARDE-RHEL-215 :</h2>
<h3 id="description-213">Description</h3>
<h3 id="références-213">Références</h3>
<h4 id="cis-213">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-213">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-207">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-213">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-215:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb217-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-215 : Tracer les modifications d&#39;utilisateurs&quot;</span></a>
<a class="sourceLine" id="cb217-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/40identity.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb217-3" title="3">-w /etc/group -p wa -k identity</a>
<a class="sourceLine" id="cb217-4" title="4">-w /etc/passwd -p wa -k identity</a>
<a class="sourceLine" id="cb217-5" title="5">-w /etc/gshadow -p wa -k identity</a>
<a class="sourceLine" id="cb217-6" title="6">-w /etc/shadow -p wa -k identity</a>
<a class="sourceLine" id="cb217-7" title="7">-w /etc/security/opasswd -p wa -k identity</a>
<a class="sourceLine" id="cb217-8" title="8"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb217-9" title="9"><span class="co"># Fin: HARDE-RHEL-215</span></a>
<a class="sourceLine" id="cb217-10" title="10"></a></code></pre></div>
<h3 id="méthode-daudit-214">Méthode d'audit</h3>
<h2 id="harde-rhel-216-">HARDE-RHEL-216 :</h2>
<h3 id="description-214">Description</h3>
<h3 id="références-214">Références</h3>
<h4 id="cis-214">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-214">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-208">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-214">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-216:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb218-1" title="1"><span class="co">#! /usr/bin/env bash</span></a>
<a class="sourceLine" id="cb218-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-216 : Journalisation de l&#39;activité par auditd&quot;</span></a>
<a class="sourceLine" id="cb218-3" title="3"><span class="co"># Remove any pre-existing rules</span></a>
<a class="sourceLine" id="cb218-4" title="4"><span class="fu">rm</span> -f /etc/audit/rules.d/audit.rules <span class="kw">||</span> <span class="fu">true</span></a>
<a class="sourceLine" id="cb218-5" title="5"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/00audit.rules<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb218-6" title="6">## First rule - delete all</a>
<a class="sourceLine" id="cb218-7" title="7">-D</a>
<a class="sourceLine" id="cb218-8" title="8">## Increase the buffers to survive stress events.</a>
<a class="sourceLine" id="cb218-9" title="9">## Make this bigger for busy systems</a>
<a class="sourceLine" id="cb218-10" title="10">-b 8192</a>
<a class="sourceLine" id="cb218-11" title="11">## This determine how long to wait in burst of events</a>
<a class="sourceLine" id="cb218-12" title="12">--backlog_wait_time 60000</a>
<a class="sourceLine" id="cb218-13" title="13">## Set failure mode to syslog</a>
<a class="sourceLine" id="cb218-14" title="14">-f 1</a>
<a class="sourceLine" id="cb218-15" title="15"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb218-16" title="16"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/10etc.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb218-17" title="17"># Journaliser les modifications dans /etc/</a>
<a class="sourceLine" id="cb218-18" title="18">-w /etc/ -p wa</a>
<a class="sourceLine" id="cb218-19" title="19"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb218-20" title="20"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/20mount.rules<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb218-21" title="21"># Surveillance de montage/démontage</a>
<a class="sourceLine" id="cb218-22" title="22">-a exit,always -F arch=b32 -S mount -S umount2 -k mounts</a>
<a class="sourceLine" id="cb218-23" title="23">-a exit,always -F arch=b64 -S mount -S umount2 -k mounts</a>
<a class="sourceLine" id="cb218-24" title="24"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb218-25" title="25"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/30syscalls.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb218-26" title="26"># Appels de syscalls x86 suspects</a>
<a class="sourceLine" id="cb218-27" title="27">-a exit,always -F arch=b32 -S ioperm -S modify_ldt</a>
<a class="sourceLine" id="cb218-28" title="28">-a exit,always -F arch=b64 -S ioperm -S modify_ldt</a>
<a class="sourceLine" id="cb218-29" title="29"># Appels de syscalls qui doivent être rares et surveillés de près</a>
<a class="sourceLine" id="cb218-30" title="30">-a exit,always -F arch=b32 -S get_kernel_syms -S ptrace</a>
<a class="sourceLine" id="cb218-31" title="31">-a exit,always -F arch=b64 -S get_kernel_syms -S ptrace</a>
<a class="sourceLine" id="cb218-32" title="32">-a exit,always -F arch=b32 -S prctl</a>
<a class="sourceLine" id="cb218-33" title="33">-a exit,always -F arch=b64 -S prctl</a>
<a class="sourceLine" id="cb218-34" title="34"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb218-35" title="35"><span class="co"># Fin: HARDE-RHEL-216</span></a>
<a class="sourceLine" id="cb218-36" title="36"></a></code></pre></div>
<h3 id="méthode-daudit-215">Méthode d'audit</h3>
<h2 id="harde-rhel-217-">HARDE-RHEL-217 :</h2>
<h3 id="description-215">Description</h3>
<h3 id="références-215">Références</h3>
<h4 id="cis-215">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-215">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-209">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-215">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-217:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb219-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-217 : Tracer l&#39;utilisation des commandes privilégiés&quot;</span></a>
<a class="sourceLine" id="cb219-2" title="2"><span class="fu">find</span> / /usr /srv -xdev <span class="dt">\(</span> -perm -4000 -o -perm -2000 <span class="dt">\)</span> -type f <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print &quot;-a always,exit -F path=&quot; $1 &quot; -F perm=x -F auid&gt;=&#39;&quot;</span><span class="va">$(</span><span class="fu">awk</span> <span class="st">&#39;/^\s*UID_MIN/{print $2}&#39;</span> /etc/login.defs<span class="va">)</span><span class="st">&quot;&#39; -F auid!=4294967295 -k privileged&quot; }&#39;</span> <span class="op">&gt;</span> /etc/audit/rules.d/25privileged.rules</a>
<a class="sourceLine" id="cb219-3" title="3"><span class="co"># Fin: HARDE-RHEL-217</span></a>
<a class="sourceLine" id="cb219-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-216">Méthode d'audit</h3>
<h2 id="harde-rhel-218-">HARDE-RHEL-218 :</h2>
<h3 id="description-216">Description</h3>
<h3 id="références-216">Références</h3>
<h4 id="cis-216">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-216">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-210">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-216">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-218:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb220-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-218 : Tracer les suppressions de fichiers&quot;</span></a>
<a class="sourceLine" id="cb220-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/45delete.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb220-3" title="3">-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=1000 -F auid!=4294967295 -k delete</a>
<a class="sourceLine" id="cb220-4" title="4">-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=1000 -F auid!=4294967295 -k delete</a>
<a class="sourceLine" id="cb220-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb220-6" title="6"><span class="co"># Fin: HARDE-RHEL-218</span></a>
<a class="sourceLine" id="cb220-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-217">Méthode d'audit</h3>
<h2 id="harde-rhel-219-">HARDE-RHEL-219 :</h2>
<h3 id="description-217">Description</h3>
<h3 id="références-217">Références</h3>
<h4 id="cis-217">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-217">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-211">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-217">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-219:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb221-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-219 : Tracer le chargement/déchargement de modules&quot;</span></a>
<a class="sourceLine" id="cb221-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/50modules.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb221-3" title="3">-w /sbin/insmod -p x -k modules</a>
<a class="sourceLine" id="cb221-4" title="4">-w /sbin/rmmod -p x -k modules</a>
<a class="sourceLine" id="cb221-5" title="5">-w /sbin/modprobe -p x -k modules</a>
<a class="sourceLine" id="cb221-6" title="6">-a always,exit -F arch=b64 -S init_module -S delete_module -k modules</a>
<a class="sourceLine" id="cb221-7" title="7"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb221-8" title="8"><span class="co"># Fin: HARDE-RHEL-219</span></a>
<a class="sourceLine" id="cb221-9" title="9"></a></code></pre></div>
<h3 id="méthode-daudit-218">Méthode d'audit</h3>
<h2 id="harde-rhel-220-">HARDE-RHEL-220 :</h2>
<h3 id="description-218">Description</h3>
<h3 id="références-218">Références</h3>
<h4 id="cis-218">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-218">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-212">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-218">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-220:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb222-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-220 : Tracer les actions des administrateurs&quot;</span></a>
<a class="sourceLine" id="cb222-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/55actions.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb222-3" title="3">-w /var/log/sudo.log -p wa -k actions</a>
<a class="sourceLine" id="cb222-4" title="4"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb222-5" title="5"><span class="co"># Fin: HARDE-RHEL-220</span></a>
<a class="sourceLine" id="cb222-6" title="6"></a></code></pre></div>
<h3 id="méthode-daudit-219">Méthode d'audit</h3>
<h2 id="harde-rhel-221-">HARDE-RHEL-221 :</h2>
<h3 id="description-219">Description</h3>
<h3 id="références-219">Références</h3>
<h4 id="cis-219">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-219">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-213">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-219">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-221:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb223-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-221 : S&#39;assurer que la configuration auditd n&#39;est pas modifiable&quot;</span></a>
<a class="sourceLine" id="cb223-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/zz_lock.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb223-3" title="3"># Verrouillage de la configuration de auditd</a>
<a class="sourceLine" id="cb223-4" title="4">-e 2</a>
<a class="sourceLine" id="cb223-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb223-6" title="6"><span class="co"># Fin: HARDE-RHEL-221</span></a>
<a class="sourceLine" id="cb223-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-220">Méthode d'audit</h3>
<h2 id="harde-rhel-222--sassurer-que-la-taille-de-stockage-est-spécifiée">HARDE-RHEL-222 : S'assurer que la taille de stockage est spécifiée</h2>
<h3 id="description-220">Description</h3>
<h3 id="références-220">Références</h3>
<h4 id="cis-220">CIS</h4>
<p>Références: RHEL 8 4.1.2.1 Contrôles: 06.4 Ensure adequate storage for logs</p>
<h4 id="anssi-220">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-4-2">Niveau de Durcissement: 4</h4>
<h4 id="méthode-à-suivre-220">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-222:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb224-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-222 : S&#39;assurer que la taille de stockage est spécifiée&quot;</span></a>
<a class="sourceLine" id="cb224-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^max_log_file = 8&#39;</span> /etc/audit/auditd.conf <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(max_log_file .*\)/#HARDE-RHEL-222: \1/&#39;</span> -i /etc/audit/auditd.conf<span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;max_log_file = 8&quot;</span> <span class="op">&gt;&gt;</span> /etc/audit/auditd.conf<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb224-3" title="3"><span class="co"># Fin: HARDE-RHEL-222</span></a>
<a class="sourceLine" id="cb224-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-221">Méthode d'audit</h3>
<h2 id="harde-rhel-223--sassurer-que-les-logs-daudit-ne-soient-pas-purgés">HARDE-RHEL-223 : S'assurer que les logs d'audit ne soient pas purgés</h2>
<h3 id="description-221">Description</h3>
<p>dans /etc/audit/auditd.conf, s'assurer que le paramètre max_log_file_action soit positionné à keep_logs</p>
<p>Dans la pratique, il faut de manière régulière purger les journaux les plus anciens pour ne pas saturer la partition d'audit. Les paramètres d'auditd ne permettent pas de rotation basé sur les dates, un script lancé par cron est donc utilisé pour assurer une rotation basé sur l'âge. Ici, les journaux sont conservés un mois (variable NUM_LOGS du script positionnée à 30).</p>
<h3 id="références-221">Références</h3>
<h4 id="cis-221">CIS</h4>
<p>Références: RHEL 8 4.1.2.2 Contrôles: 06.4 Ensure adequate storage for logs</p>
<h4 id="anssi-221">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-4-3">Niveau de Durcissement: 4</h4>
<h4 id="méthode-à-suivre-221">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-223:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb225-1" title="1"><span class="co">#! /usr/bin/env bash</span></a>
<a class="sourceLine" id="cb225-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-223 : S&#39;assurer que les logs d&#39;audit ne soient pas purgés&quot;</span></a>
<a class="sourceLine" id="cb225-3" title="3"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^max_log_file_action = keep_logs&#39;</span> /etc/audit/auditd.conf</a>
<a class="sourceLine" id="cb225-4" title="4"><span class="kw">then</span> </a>
<a class="sourceLine" id="cb225-5" title="5">    <span class="fu">sed</span> -e <span class="st">&#39;s/\(max_log_file_action.*\)/#HARDE-RHEL-223: \1/&#39;</span> -i /etc/audit/auditd.conf</a>
<a class="sourceLine" id="cb225-6" title="6">    <span class="bu">echo</span> <span class="st">&quot;max_log_file_action = keep_logs&quot;</span> <span class="op">&gt;&gt;</span> /etc/audit/auditd.conf</a>
<a class="sourceLine" id="cb225-7" title="7"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb225-8" title="8"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/cron.daily/auditd <span class="op">&lt;&lt;&#39;EOF&#39;</span></a>
<a class="sourceLine" id="cb225-9" title="9">NUM_LOGS=30</a>
<a class="sourceLine" id="cb225-10" title="10"># /var/log/audit/audit.log.XX</a>
<a class="sourceLine" id="cb225-11" title="11"># Only keep the files where XX &gt; NUM_LOGS</a>
<a class="sourceLine" id="cb225-12" title="12">for log in /var/log/audit/audit.log.*</a>
<a class="sourceLine" id="cb225-13" title="13">do</a>
<a class="sourceLine" id="cb225-14" title="14">    extension=&quot;${log##*.}&quot;</a>
<a class="sourceLine" id="cb225-15" title="15">    # Ignore non-numeric extensions</a>
<a class="sourceLine" id="cb225-16" title="16">    [ &quot;$extension&quot; -eq &quot;$extension&quot; ] 2&gt;/dev/null || continue </a>
<a class="sourceLine" id="cb225-17" title="17">    [ &quot;$extension&quot; -gt $NUM_LOGS ] &amp;&amp; /bin/rm -f &quot;$log&quot;</a>
<a class="sourceLine" id="cb225-18" title="18">done</a>
<a class="sourceLine" id="cb225-19" title="19">kill -USR1 $(/sbin/pidof auditd)</a>
<a class="sourceLine" id="cb225-20" title="20"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb225-21" title="21"><span class="fu">chmod</span> 0500 /etc/cron.daily/auditd</a>
<a class="sourceLine" id="cb225-22" title="22"><span class="co"># Fin: HARDE-RHEL-223</span></a>
<a class="sourceLine" id="cb225-23" title="23"></a>
<a class="sourceLine" id="cb225-24" title="24"></a></code></pre></div>
<h3 id="méthode-daudit-222">Méthode d'audit</h3>
<h2 id="harde-rhel-224--sassurer-que-le-système-sarrête-si-le-système-daudit-est-plein">HARDE-RHEL-224 : S'assurer que le système s'arrête si le système d'audit est plein</h2>
<h3 id="description-222">Description</h3>
<p>Dans /etc/audit/auditd.conf, s'assurer que le paramètre admin_space_left_action soit positionné à halt.</p>
<p>Cela suppose que l'espace disque soit supervisé, une partition d'audit remplie entrainant un arrêt du système.</p>
<p>Dans la pratique, il faut de manière régulière purger les logs les plus anciens pour ne pas saturer la partition d'audit. Les paramètres d'auditd ne permettent pas de rotation basé sur les dates, il faut donc configurer logrotate (et que SELinux permette la rotation)</p>
<h3 id="références-222">Références</h3>
<h4 id="cis-222">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-222">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-214">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-222">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-224:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb226-1" title="1"><span class="co">#! /bin/bash</span></a>
<a class="sourceLine" id="cb226-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-224 : S&#39;assurer que le système s&#39;arrête si le système d&#39;audit est plein&quot;</span></a>
<a class="sourceLine" id="cb226-3" title="3"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^admin_space_left_action = halt&#39;</span> /etc/audit/auditd.conf <span class="kw">;</span> <span class="kw">then</span> <span class="fu">sed</span> -e <span class="st">&#39;s/\(admin_space_left_action .*\)/#HARDE-RHEL-224: \1/&#39;</span> -i /etc/audit/auditd.conf<span class="kw">;</span> <span class="bu">echo</span> <span class="st">&quot;admin_space_left_action = halt&quot;</span> <span class="op">&gt;&gt;</span> /etc/audit/auditd.conf<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb226-4" title="4"><span class="co"># Fin: HARDE-RHEL-224</span></a>
<a class="sourceLine" id="cb226-5" title="5"></a></code></pre></div>
<h3 id="méthode-daudit-223">Méthode d'audit</h3>
<h2 id="harde-rhel-225-">HARDE-RHEL-225 :</h2>
<h3 id="description-223">Description</h3>
<h3 id="références-223">Références</h3>
<h4 id="cis-223">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-223">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-215">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-223">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-225:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb227-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-225 : Auditer tout changement du fichier sudoers&quot;</span></a>
<a class="sourceLine" id="cb227-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/60scope.rules<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb227-3" title="3">-w /etc/sudoers -p wa -k scope</a>
<a class="sourceLine" id="cb227-4" title="4">-w /etc/sudoers.d/ -p wa -k scope</a>
<a class="sourceLine" id="cb227-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb227-6" title="6"><span class="co"># Fin: HARDE-RHEL-225</span></a>
<a class="sourceLine" id="cb227-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-224">Méthode d'audit</h3>
<h2 id="harde-rhel-226-">HARDE-RHEL-226 :</h2>
<h3 id="description-224">Description</h3>
<h3 id="références-224">Références</h3>
<h4 id="cis-224">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-224">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-216">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-224">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-226:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb228-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-226 : Auditer toute connexion/déconnexion&quot;</span></a>
<a class="sourceLine" id="cb228-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span> /etc/audit/rules.d/65audit.rules<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb228-3" title="3">-w /var/log/faillog -p wa -k logins</a>
<a class="sourceLine" id="cb228-4" title="4">-w /var/log/lastlog -p wa -k logins</a>
<a class="sourceLine" id="cb228-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb228-6" title="6"><span class="co"># Fin: HARDE-RHEL-226</span></a>
<a class="sourceLine" id="cb228-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-225">Méthode d'audit</h3>
<h2 id="harde-rhel-227-">HARDE-RHEL-227 :</h2>
<h3 id="description-225">Description</h3>
<h3 id="références-225">Références</h3>
<h4 id="cis-225">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-225">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-217">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-225">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-227:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb229-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-227 : Collecter toutes les informations de session&quot;</span></a>
<a class="sourceLine" id="cb229-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/70logins.rules<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb229-3" title="3">-w /var/run/utmp -p wa -k session</a>
<a class="sourceLine" id="cb229-4" title="4">-w /var/log/wtmp -p wa -k logins</a>
<a class="sourceLine" id="cb229-5" title="5">-w /var/log/btmp -p wa -k logins</a>
<a class="sourceLine" id="cb229-6" title="6"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb229-7" title="7"><span class="co"># Fin: HARDE-RHEL-227</span></a>
<a class="sourceLine" id="cb229-8" title="8"></a></code></pre></div>
<h3 id="méthode-daudit-226">Méthode d'audit</h3>
<h2 id="harde-rhel-228-">HARDE-RHEL-228 :</h2>
<h3 id="description-226">Description</h3>
<h3 id="références-226">Références</h3>
<h4 id="cis-226">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-226">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-218">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-226">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-228:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb230-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-228 : S&#39;assurer que les évenement de changements horaires soient tracés&quot;</span></a>
<a class="sourceLine" id="cb230-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/75time-change.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb230-3" title="3">-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change</a>
<a class="sourceLine" id="cb230-4" title="4">-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change</a>
<a class="sourceLine" id="cb230-5" title="5">-a always,exit -F arch=b64 -S clock_settime -k time-change</a>
<a class="sourceLine" id="cb230-6" title="6">-a always,exit -F arch=b32 -S clock_settime -k time-change</a>
<a class="sourceLine" id="cb230-7" title="7">-w /etc/localtime -p wa -k time-change</a>
<a class="sourceLine" id="cb230-8" title="8"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb230-9" title="9"><span class="co"># Fin: HARDE-RHEL-228</span></a>
<a class="sourceLine" id="cb230-10" title="10"></a></code></pre></div>
<h3 id="méthode-daudit-227">Méthode d'audit</h3>
<h2 id="harde-rhel-229-">HARDE-RHEL-229 :</h2>
<h3 id="description-227">Description</h3>
<h3 id="références-227">Références</h3>
<h4 id="cis-227">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-227">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-219">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-227">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-229:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb231-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-229 : S&#39;assurer que les événements modifiant les MAC soient collectéees&quot;</span></a>
<a class="sourceLine" id="cb231-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/80MAC-policy.rules<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb231-3" title="3">-w /etc/selinux/ -p wa -k MAC-policy</a>
<a class="sourceLine" id="cb231-4" title="4">-w /usr/share/selinux/ -p wa -k MAC-policy</a>
<a class="sourceLine" id="cb231-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb231-6" title="6"><span class="co"># Fin: HARDE-RHEL-229</span></a>
<a class="sourceLine" id="cb231-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-228">Méthode d'audit</h3>
<h2 id="harde-rhel-230-">HARDE-RHEL-230 :</h2>
<h3 id="description-228">Description</h3>
<h3 id="références-228">Références</h3>
<h4 id="cis-228">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-228">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-220">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-228">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-230:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb232-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-230 : Tracer les événements changeant l&#39;environnement réseau&quot;</span></a>
<a class="sourceLine" id="cb232-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/audit/rules.d/85system-locale.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb232-3" title="3">-a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale</a>
<a class="sourceLine" id="cb232-4" title="4">-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale</a>
<a class="sourceLine" id="cb232-5" title="5">-w /etc/issue -p wa -k system-locale</a>
<a class="sourceLine" id="cb232-6" title="6">-w /etc/issue.net -p wa -k system-locale</a>
<a class="sourceLine" id="cb232-7" title="7">-w /etc/hosts -p wa -k system-locale</a>
<a class="sourceLine" id="cb232-8" title="8">-w /etc/sysconfig/network -p wa -k system-locale</a>
<a class="sourceLine" id="cb232-9" title="9"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb232-10" title="10"><span class="co"># Fin: HARDE-RHEL-230</span></a>
<a class="sourceLine" id="cb232-11" title="11"></a></code></pre></div>
<h3 id="méthode-daudit-229">Méthode d'audit</h3>
<h2 id="harde-rhel-231-">HARDE-RHEL-231 :</h2>
<h3 id="description-229">Description</h3>
<h3 id="références-229">Références</h3>
<h4 id="cis-229">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-229">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-221">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-229">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-231:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb233-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-231 : Tracer les changements de permission&quot;</span></a>
<a class="sourceLine" id="cb233-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span> /etc/audit/rules.d/90perm_mod.rules <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb233-3" title="3">-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</a>
<a class="sourceLine" id="cb233-4" title="4">-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</a>
<a class="sourceLine" id="cb233-5" title="5">-a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</a>
<a class="sourceLine" id="cb233-6" title="6">-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</a>
<a class="sourceLine" id="cb233-7" title="7">-a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</a>
<a class="sourceLine" id="cb233-8" title="8">-a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=1000 -F auid!=4294967295 -k perm_mod</a>
<a class="sourceLine" id="cb233-9" title="9"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb233-10" title="10"><span class="co"># Fin: HARDE-RHEL-231</span></a>
<a class="sourceLine" id="cb233-11" title="11"></a></code></pre></div>
<h3 id="méthode-daudit-230">Méthode d'audit</h3>
<h2 id="harde-rhel-232-">HARDE-RHEL-232 :</h2>
<h3 id="description-230">Description</h3>
<h3 id="références-230">Références</h3>
<h4 id="cis-230">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-230">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-222">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-230">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-232:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb234-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-232 : Installer le service rsyslog&quot;</span></a>
<a class="sourceLine" id="cb234-2" title="2"><span class="ex">dnf</span> install rsyslog</a>
<a class="sourceLine" id="cb234-3" title="3"><span class="co"># Fin: HARDE-RHEL-232</span></a>
<a class="sourceLine" id="cb234-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-231">Méthode d'audit</h3>
<h2 id="harde-rhel-233-">HARDE-RHEL-233 :</h2>
<h3 id="description-231">Description</h3>
<h3 id="références-231">Références</h3>
<h4 id="cis-231">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-231">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-223">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-231">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-233:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb235-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-233 : Activer le service syslog&quot;</span></a>
<a class="sourceLine" id="cb235-2" title="2"><span class="ex">systemctl</span> --now enable rsyslog</a>
<a class="sourceLine" id="cb235-3" title="3"><span class="co"># Fin: HARDE-RHEL-233</span></a>
<a class="sourceLine" id="cb235-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-232">Méthode d'audit</h3>
<h2 id="harde-rhel-234-">HARDE-RHEL-234 :</h2>
<h3 id="description-232">Description</h3>
<h3 id="références-232">Références</h3>
<h4 id="cis-232">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-232">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-224">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-232">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-234:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb236-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-234 : Configurer les permissions des fichiers journaux&quot;</span></a>
<a class="sourceLine" id="cb236-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span> /etc/rsyslog.d/10FileCreate.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb236-3" title="3"><span class="dt">\$</span>FileCreateMode 0640</a>
<a class="sourceLine" id="cb236-4" title="4"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb236-5" title="5"><span class="co"># Fin: HARDE-RHEL-234</span></a>
<a class="sourceLine" id="cb236-6" title="6"></a></code></pre></div>
<h3 id="méthode-daudit-233">Méthode d'audit</h3>
<h2 id="harde-rhel-235-">HARDE-RHEL-235 :</h2>
<h3 id="description-233">Description</h3>
<h3 id="références-233">Références</h3>
<h4 id="cis-233">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-233">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-225">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-233">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-235:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb237-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-235 : Définir les fichiers journaux&quot;</span></a>
<a class="sourceLine" id="cb237-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/rsyslog.d/files.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb237-3" title="3"># Everybody gets emergency messages</a>
<a class="sourceLine" id="cb237-4" title="4">*.emerg         :omusrmsg:*</a>
<a class="sourceLine" id="cb237-5" title="5"># The authpriv file has restricted access.</a>
<a class="sourceLine" id="cb237-6" title="6">auth,authpriv.*     /var/log/secure</a>
<a class="sourceLine" id="cb237-7" title="7"># Log cron stuff</a>
<a class="sourceLine" id="cb237-8" title="8">cron.*          /var/log/cron</a>
<a class="sourceLine" id="cb237-9" title="9">mail.*          -/var/log/mail</a>
<a class="sourceLine" id="cb237-10" title="10">mail.info       -/var/log/mail.info</a>
<a class="sourceLine" id="cb237-11" title="11">mail.warning        -/var/log/mail.warn</a>
<a class="sourceLine" id="cb237-12" title="12">mail.err        /var/log/mail.err</a>
<a class="sourceLine" id="cb237-13" title="13">news.crit       -/var/log/news/news.crit</a>
<a class="sourceLine" id="cb237-14" title="14">news.err        -/var/log/news/news.err</a>
<a class="sourceLine" id="cb237-15" title="15">news.notice         -/var/log/news/news.notice</a>
<a class="sourceLine" id="cb237-16" title="16">*.=warning;*.=err   -/var/log/warn</a>
<a class="sourceLine" id="cb237-17" title="17">*.crit          /var/log/warn</a>
<a class="sourceLine" id="cb237-18" title="18"># Log anything (except mail) of level info or higher.</a>
<a class="sourceLine" id="cb237-19" title="19"># Don&#39;t log private authentication messages!</a>
<a class="sourceLine" id="cb237-20" title="20">*.info;mail.none;authpriv.none;cron.none    -/var/log/messages</a>
<a class="sourceLine" id="cb237-21" title="21">local0.*,local1.*   -/var/log/localmessages</a>
<a class="sourceLine" id="cb237-22" title="22">local2.*,local3.*   -/var/log/localmessages</a>
<a class="sourceLine" id="cb237-23" title="23">local4.*,local5.*   -/var/log/localmessages</a>
<a class="sourceLine" id="cb237-24" title="24">local6.*        -/var/log/localmessages</a>
<a class="sourceLine" id="cb237-25" title="25">local7.*        /var/log/boot.log</a>
<a class="sourceLine" id="cb237-26" title="26"># Save news errors of level crit and higher in a special file.</a>
<a class="sourceLine" id="cb237-27" title="27">uucp,news.crit      /var/log/spooler</a>
<a class="sourceLine" id="cb237-28" title="28"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb237-29" title="29"><span class="co"># Fin: HARDE-RHEL-235</span></a>
<a class="sourceLine" id="cb237-30" title="30"></a></code></pre></div>
<h3 id="méthode-daudit-234">Méthode d'audit</h3>
<h2 id="harde-rhel-236--renvoyer-les-journaux-vers-un-hôte-distant">HARDE-RHEL-236 : Renvoyer les journaux vers un hôte distant</h2>
<h3 id="description-234">Description</h3>
<h3 id="références-234">Références</h3>
<h4 id="cis-234">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-234">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-226">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-234">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-236:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb238-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-236 : Renvoyer les journaux vers un hôte distant&quot;</span></a>
<a class="sourceLine" id="cb238-2" title="2"><span class="co"># ask for the syslog server</span></a>
<a class="sourceLine" id="cb238-3" title="3"><span class="bu">echo</span> -n <span class="st">&quot;Merci de préciser l&#39;adresse ou le nom du serveur SYSLOG distant :&quot;</span><span class="kw">;</span> <span class="bu">read</span> -e -i <span class="st">&#39;127.0.0.1&#39;</span> -r <span class="va">SYSLOGSERVER</span></a>
<a class="sourceLine" id="cb238-4" title="4"><span class="fu">cat</span> <span class="op">&gt;</span> /etc/rsyslog.d/loghost.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb238-5" title="5"># TCP version *.*     @@<span class="va">$SYSLOGSERVER</span>:514</a>
<a class="sourceLine" id="cb238-6" title="6">*.*     @<span class="va">$SYSLOGSERVER</span>:514</a>
<a class="sourceLine" id="cb238-7" title="7"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb238-8" title="8"><span class="co"># Fin: HARDE-RHEL-236</span></a>
<a class="sourceLine" id="cb238-9" title="9"></a></code></pre></div>
<h3 id="méthode-daudit-235">Méthode d'audit</h3>
<h2 id="harde-rhel-237-">HARDE-RHEL-237 :</h2>
<h3 id="description-235">Description</h3>
<h3 id="références-235">Références</h3>
<h4 id="cis-235">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-235">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-227">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-235">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-237:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb239-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-237 : S&#39;assurer que seuls les puits de logs peuvent recevoir des logs&quot;</span></a>
<a class="sourceLine" id="cb239-2" title="2"></a>
<a class="sourceLine" id="cb239-3" title="3"><span class="co"># Fin: HARDE-RHEL-237</span></a>
<a class="sourceLine" id="cb239-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-236">Méthode d'audit</h3>
<h2 id="harde-rhel-238-">HARDE-RHEL-238 :</h2>
<h3 id="description-236">Description</h3>
<h3 id="références-236">Références</h3>
<h4 id="cis-236">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-236">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-228">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-236">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-238:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb240-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-238 : S&#39;assurer que journald est redirigé vers rsyslog&quot;</span></a>
<a class="sourceLine" id="cb240-2" title="2"><span class="ex">systemctl</span> stop systemd-journald</a>
<a class="sourceLine" id="cb240-3" title="3"><span class="ex">systemctl</span> disable systemd-journald</a>
<a class="sourceLine" id="cb240-4" title="4"><span class="fu">mkdir</span> -p /etc/systemd/journald.conf.d/ </a>
<a class="sourceLine" id="cb240-5" title="5"><span class="fu">cat</span> <span class="op">&gt;</span> /etc/systemd/journald.conf.d/00-forwardsyslog.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb240-6" title="6">[Journal]</a>
<a class="sourceLine" id="cb240-7" title="7">ForwardToSyslog=yes</a>
<a class="sourceLine" id="cb240-8" title="8"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb240-9" title="9"><span class="co"># Fin: HARDE-RHEL-238</span></a>
<a class="sourceLine" id="cb240-10" title="10"></a></code></pre></div>
<h3 id="méthode-daudit-237">Méthode d'audit</h3>
<h2 id="harde-rhel-239-">HARDE-RHEL-239 :</h2>
<h3 id="description-237">Description</h3>
<h3 id="références-237">Références</h3>
<h4 id="cis-237">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-237">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-229">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-237">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-239:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb241-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-239 : S&#39;assurer que journald compresse les journaux de grande taille&quot;</span></a>
<a class="sourceLine" id="cb241-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span> /etc/systemd/journald.conf.d/10-compress.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb241-3" title="3">[Journal]</a>
<a class="sourceLine" id="cb241-4" title="4">Compress=yes</a>
<a class="sourceLine" id="cb241-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb241-6" title="6"><span class="co"># Fin: HARDE-RHEL-239</span></a>
<a class="sourceLine" id="cb241-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-238">Méthode d'audit</h3>
<h2 id="harde-rhel-240-">HARDE-RHEL-240 :</h2>
<h3 id="description-238">Description</h3>
<h3 id="références-238">Références</h3>
<h4 id="cis-238">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-238">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-230">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-238">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-240:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb242-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-240 : S&#39;assurer que journald écrit les journaux sur disque&quot;</span></a>
<a class="sourceLine" id="cb242-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span> /etc/systemd/journald.conf.d/20-persistent.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb242-3" title="3">[Journal]</a>
<a class="sourceLine" id="cb242-4" title="4">Storage=persistent</a>
<a class="sourceLine" id="cb242-5" title="5"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb242-6" title="6"><span class="co"># Fin: HARDE-RHEL-240</span></a>
<a class="sourceLine" id="cb242-7" title="7"></a></code></pre></div>
<h3 id="méthode-daudit-239">Méthode d'audit</h3>
<h2 id="harde-rhel-241--sassurer-de-la-permission-des-fichiers-journaux">HARDE-RHEL-241 : S'assurer de la permission des fichiers journaux</h2>
<p>Il s'agit de s'assurer que les droits d'accès aux journaux (qui peuvent contenir des informations sensibles) soient limités au maximum.</p>
<p>Cette règle peut causer des problèmes pour des services ne s'exécutant pas en root. Si cela est possible, il convient de modifier la configuration pour :</p>
<ul>
<li>envoyer les logs de manière sécurisé à un serveur centralisé.</li>
<li>ou, sélectionner un répertoire différent en dehors de l'arborescence <code>/var/log</code>.</li>
</ul>
<h3 id="description-239">Description</h3>
<h3 id="références-239">Références</h3>
<h4 id="cis-239">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-239">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-231">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-239">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-241:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb243-1" title="1"><span class="co">#! /usr/bin/env bash</span></a>
<a class="sourceLine" id="cb243-2" title="2"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-241 : S&#39;assurer de la permission des fichiers journaux&quot;</span></a>
<a class="sourceLine" id="cb243-3" title="3"><span class="co"># this is a one time solution since systemd resets permissions on reboot</span></a>
<a class="sourceLine" id="cb243-4" title="4"><span class="co">#   find /var/log -type f -exec chmod g-wx,o-rwx &quot;{}&quot; + -o -type d -exec chmod g-w,o-rwx &quot;{}&quot; &quot;;&quot;</span></a>
<a class="sourceLine" id="cb243-5" title="5"><span class="co"># systemd way:</span></a>
<a class="sourceLine" id="cb243-6" title="6"><span class="fu">sed</span> -e <span class="st">&#39;s,d /var/log 0755,d /var/log 0751,&#39;</span> -i /usr/lib/tmpfiles.d/var.conf </a>
<a class="sourceLine" id="cb243-7" title="7"><span class="fu">sed</span> -e <span class="st">&#39;s,f /var/log/wtmp 0664,f /var/log/wtmp 0640,&#39;</span> -i /usr/lib/tmpfiles.d/var.conf </a>
<a class="sourceLine" id="cb243-8" title="8"><span class="fu">sed</span> -e <span class="st">&#39;s,f /var/log/lastlog 0664,f /var/log/lastlog 0640,&#39;</span> -i /usr/lib/tmpfiles.d/var.conf </a>
<a class="sourceLine" id="cb243-9" title="9"><span class="fu">sed</span> -e <span class="st">&#39;s,f /var/log/btmp 0660,f /var/log/btmp 0640,&#39;</span> -i /usr/lib/tmpfiles.d/var.conf </a>
<a class="sourceLine" id="cb243-10" title="10"><span class="fu">sed</span> -e <span class="st">&#39;s,z /var/log/journal 2755,z /var/log/journal 2750,&#39;</span> -i /usr/lib/tmpfiles.d/systemd.conf</a>
<a class="sourceLine" id="cb243-11" title="11"><span class="fu">sed</span> -e <span class="st">&#39;s,z /var/log/journal/%m 2755,z /var/log/journal/%m 2750,&#39;</span> -i /usr/lib/tmpfiles.d/systemd.conf</a>
<a class="sourceLine" id="cb243-12" title="12"><span class="co"># Fin: HARDE-RHEL-241</span></a>
<a class="sourceLine" id="cb243-13" title="13"></a></code></pre></div>
<h3 id="méthode-daudit-240">Méthode d'audit</h3>
<h2 id="harde-rhel-242-">HARDE-RHEL-242 :</h2>
<h3 id="description-240">Description</h3>
<h3 id="références-240">Références</h3>
<h4 id="cis-240">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-240">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-232">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-240">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-242:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb244-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-242 : S&#39;assurer que logrotate est configuré&quot;</span></a>
<a class="sourceLine" id="cb244-2" title="2"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/logrotate.d/wtmp<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb244-3" title="3"># no packages own wtmp -- we&#39;ll rotate it here</a>
<a class="sourceLine" id="cb244-4" title="4">/var/log/wtmp {</a>
<a class="sourceLine" id="cb244-5" title="5">    missingok</a>
<a class="sourceLine" id="cb244-6" title="6">    monthly</a>
<a class="sourceLine" id="cb244-7" title="7">    create 0600 root utmp</a>
<a class="sourceLine" id="cb244-8" title="8">    minsize 1M</a>
<a class="sourceLine" id="cb244-9" title="9">    rotate 12</a>
<a class="sourceLine" id="cb244-10" title="10">}</a>
<a class="sourceLine" id="cb244-11" title="11"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb244-12" title="12"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/logrotate.d/lastlog<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb244-13" title="13"># no packages own lastlog -- we&#39;ll rotate it here</a>
<a class="sourceLine" id="cb244-14" title="14">/var/log/lastlog {</a>
<a class="sourceLine" id="cb244-15" title="15">    missingok</a>
<a class="sourceLine" id="cb244-16" title="16">    monthly</a>
<a class="sourceLine" id="cb244-17" title="17">    create 0600 root utmp</a>
<a class="sourceLine" id="cb244-18" title="18">    minsize 1M</a>
<a class="sourceLine" id="cb244-19" title="19">    rotate 12</a>
<a class="sourceLine" id="cb244-20" title="20">}</a>
<a class="sourceLine" id="cb244-21" title="21"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb244-22" title="22"><span class="fu">cat</span> <span class="op">&gt;</span>/etc/logrotate.d/btmp<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb244-23" title="23"># no packages own btmp -- we&#39;ll rotate it here</a>
<a class="sourceLine" id="cb244-24" title="24">/var/log/btmp {</a>
<a class="sourceLine" id="cb244-25" title="25">    missingok</a>
<a class="sourceLine" id="cb244-26" title="26">    monthly</a>
<a class="sourceLine" id="cb244-27" title="27">    create 0600 root utmp</a>
<a class="sourceLine" id="cb244-28" title="28">    rotate 12</a>
<a class="sourceLine" id="cb244-29" title="29">}</a>
<a class="sourceLine" id="cb244-30" title="30"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb244-31" title="31"><span class="co"># Fin: HARDE-RHEL-242</span></a>
<a class="sourceLine" id="cb244-32" title="32"></a></code></pre></div>
<h3 id="méthode-daudit-241">Méthode d'audit</h3>
<h2 id="harde-rhel-243-">HARDE-RHEL-243 :</h2>
<h3 id="description-241">Description</h3>
<h3 id="références-241">Références</h3>
<h4 id="cis-241">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-241">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-233">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-241">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-243:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb245-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-243 : S&#39;assurer que le paramètre SSH LogLevel est approprié&quot;</span></a>
<a class="sourceLine" id="cb245-2" title="2"><span class="kw">if</span>  ! <span class="fu">grep</span> -q -E <span class="st">&#39;^LogLevel\s+(VERBOSE|INFO)&#39;</span> /etc/ssh/sshd_config <span class="kw">;</span> <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;LogLevel VERBOSE&quot;</span><span class="op">&gt;&gt;</span> /etc/ssh/sshd_config<span class="kw">;</span> <span class="kw">fi</span></a>
<a class="sourceLine" id="cb245-3" title="3"><span class="co"># Fin: HARDE-RHEL-243</span></a>
<a class="sourceLine" id="cb245-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-242">Méthode d'audit</h3>
<h2 id="harde-rhel-244-">HARDE-RHEL-244 :</h2>
<h3 id="description-242">Description</h3>
<h3 id="références-242">Références</h3>
<h4 id="cis-242">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-242">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-234">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-242">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-244:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb246-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-244 : Durcissement et configuration du service syslog&quot;</span></a>
<a class="sourceLine" id="cb246-2" title="2"></a>
<a class="sourceLine" id="cb246-3" title="3"><span class="co"># Fin: HARDE-RHEL-244</span></a>
<a class="sourceLine" id="cb246-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-243">Méthode d'audit</h3>
<h2 id="harde-rhel-245-">HARDE-RHEL-245 :</h2>
<h3 id="description-243">Description</h3>
<h3 id="références-243">Références</h3>
<h4 id="cis-243">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-243">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-235">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-243">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-245:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb247-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-245 : Cloisonnement du service syslog par chroot&quot;</span></a>
<a class="sourceLine" id="cb247-2" title="2"></a>
<a class="sourceLine" id="cb247-3" title="3"><span class="co"># Fin: HARDE-RHEL-245</span></a>
<a class="sourceLine" id="cb247-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-244">Méthode d'audit</h3>
<h2 id="harde-rhel-246-">HARDE-RHEL-246 :</h2>
<h3 id="description-244">Description</h3>
<h3 id="références-244">Références</h3>
<h4 id="cis-244">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-244">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-236">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-244">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-246:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb248-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-246 : Cloisonnement du service syslog par conteneur&quot;</span></a>
<a class="sourceLine" id="cb248-2" title="2"></a>
<a class="sourceLine" id="cb248-3" title="3"><span class="co"># Fin: HARDE-RHEL-246</span></a>
<a class="sourceLine" id="cb248-4" title="4"></a></code></pre></div>
<h3 id="méthode-daudit-245">Méthode d'audit</h3>
<h2 id="harde-rhel-247-">HARDE-RHEL-247 :</h2>
<h3 id="description-245">Description</h3>
<h3 id="références-245">Références</h3>
<h4 id="cis-245">CIS</h4>
<p>Références: Contrôles:</p>
<h4 id="anssi-245">ANSSI</h4>
<p>Référence ANSSI:</p>
<h4 id="niveau-de-durcissement-237">Niveau de Durcissement:</h4>
<h4 id="méthode-à-suivre-245">Méthode à suivre</h4>
<p>Pour se faire utiliser le script fourni, dont voici le code source concernant HARDE-RHEL-247:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb249-1" title="1"><span class="bu">echo</span> <span class="st">&quot;HARDE-RHEL-247 : Journaux d&#39;activité de service&quot;</span></a>
<a class="sourceLine" id="cb249-2" title="2"></a>
<a class="sourceLine" id="cb249-3" title="3"><span class="co"># Fin: HARDE-RHEL-247</span></a></code></pre></div>
<h3 id="méthode-daudit-246">Méthode d'audit</h3>
<h1 id="utilisation-du-systeme">UTILISATION DU SYSTEME</h1>
<h2 id="ajouter-un-utilisateur">Ajouter un utilisateur</h2>
<p>La commande useradd permet de créer un utilisateur : useradd robert La commande passwd permet de définir/changer son mot de passe : passwd robert À noter que l’utilisateur est créé par défaut avec le role SELinux user_u.</p>
<h2 id="supprimer-un-utilisateur">Supprimer un utilisateur</h2>
<p>La commande userdel permet de supprimer un utilisateur du système (l’option -r permet de supprimer son répertoire d’accueil). Par exemple : userdel -r -Z baldet</p>
<h2 id="ajouter-un-administrateur">Ajouter un administrateur</h2>
<p>Il faut créer un utilisateur selon le §7.1 puis lui donner des droits via la commande suivante : usermod -G sudogrp -Z staff_u blanchet</p>
<h2 id="supprimer-un-administrateur">Supprimer un administrateur</h2>
<p>Un administrateur peut être supprimé comme un utilisateur (via la commande userdel). S’il s’agit de supprimer son accès administrateur seulement, il faut lancer la commande suivante : semanage login --delete blanchet</p>
<h2 id="ajouter-un-service">Ajouter un service</h2>
<p>Il est possible de rajouter des services en portant une attention particulière à SELinux et firewalld. SELinux peut empêcher un processus d’envoyer un email ou de se comporter en serveur HTTP. Par exemple, après avoir installé un serveur Apache, la commande suivante est nécessaire : setsebool -P httpd_can_network_connect 1 D’autre part, il faut également ouvrir le port grâce à firewalld, par exemple, pour un serveur Apache : firewall-cmd --permanent --zone=public --add-service=http Évidemment, les options à activer dépendent du service, et une description complète déborde du cadre de ce guide.</p>
<h2 id="se-connecter-en-root">Se connecter en root</h2>
<p>Il n’est possible de se connecter en root que sur une console « physique » c’est-à-dire les consoles (tty de 1 à 6) disponibles sur l’écran/clavier connectés directement à l’ordinateur. Pour les autres connexions, il faut passer par sudo (via sudo -i).</p>
<h2 id="monter-une-partition">Monter une partition</h2>
<p>À cause de l’utilisation de pam_namespace, il est recommandé de modifier /etc/fstab (puis redémarrer) pour tous les points de montage destinés à être « permanents » ou visibles de tous les utilisateurs. Utiliser mount dans une session sudo ne rendra ce point de montage visible que dans la session courante (et sera donc invisible des autres utilisateurs). D’autre part, la sécurisation par défaut empêche le chargement de modules noyaux, ce qui bloque donc l’utilisation de clés USB ou de CD/DVD (même sous la forme de fichiers ISO). Il faudra donc dans ces cas-là autoriser temporairement le chargement de modules noyaux :</p>
<h3 id="images-iso-physiques-ou-virtuelles">Images ISO (physiques ou virtuelles)</h3>
<p>Suivant le format, elles requièrent le module iso9660 ou udf. Il faut donc passer en mode de maintenance pour autoriser le chargement des modules. Pour se faire, lancer la commande suivante : sudo /etc/maintenance_mode.sh Le script vous demande de redémarrer. Une fois le système à nouveau accessible, il devient possible d’utiliser de monter des images ISO.</p>
<h3 id="clés-usb">Clés USB</h3>
<p>Là encore, il n’est pas possible d’utiliser de clés USB en mode normal et il faut donc passer en mode de maintenance. Pour se faire, lancer la commande suivante : sudo /etc/maintenance_mode.sh Le script vous demande de redémarrer. Une fois le système à nouveau accessible, il devient possible d’utiliser des clés USB.</p>
<h2 id="accéder-à-la-partition-boot">Accéder à la partition /boot</h2>
<p>Avant d’appliquer une mise à jour, il faut monter /boot et /boot/efi (souvent nécessaire lors des mises à jour) : il faut donc autoriser le chargement des modules: sudo /etc/maintenance_mode.sh Puis redémarrer. Ensuite monter le système de fichier : mount /boot &amp;&amp; mount /boot/efi Une fois la mise à jour faite, redémarrer pour revenir en situation normale.</p>
<h2 id="diagnostic-selinux">Diagnostic SELinux</h2>
<p>La commande ausearch permet de repérer les événements liés à un blocage par SELinux.</p>
<p>Cette commande est très puissante et décrire l’ensemble des options possibles dépasse du cadre de ce guide. Pour plus d’information, nous renvoyons vers ce site : <a href="https://wiki.centos.org/HowTos/SELinux" class="uri">https://wiki.centos.org/HowTos/SELinux</a>.</p>
<p>À titre d’exemple, la commande suivante est lancée et nous reporte un événement « bloqué » : ausearch -m AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR -i Résultat : type=PROCTITLE msg=audit(12/09/2020 07:18:11.625:4768) : proctitle=ausearch -m AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR -i type=PATH msg=audit(12/09/2020 07:18:11.625:4768) : item=0 name=/var/log/audit/audit.log nametype=UNKNOWN cap_fp=none cap_fi=none cap_fe=0 cap_fver=0 type=CWD msg=audit(12/09/2020 07:18:11.625:4768) : cwd=/root type=SYSCALL msg=audit(12/09/2020 07:18:11.625:4768) : arch=x86_64 syscall=openat success=no exit=EACCES(Permission non accordée) a0=0xffffff9c a1=0x55fd00b078f0 a2=O_RDONLY a3=0x0 items=1 ppid=6470 pid=6489 auid=blanchet uid=root gid=root euid=root suid=root fsuid=root egid=root sgid=root fsgid=root tty=pts1 ses=22 comm=ausearch exe=/usr/sbin/ausearch subj=staff_u:staff_r:staff_t:s0-s0:c0.c1023 key=access type=AVC msg=audit(12/09/2020 07:18:11.625:4768) : avc: denied { search } for pid=6489 comm=ausearch name=/ dev=&quot;dm-4&quot; ino=128 scontext=staff_u:staff_r:staff_t:s0-s0:c0.c1023 tcontext=system_u:object_r:auditd_log_t:s0 tclass=dir permissive=0</p>
<p>Il s’agit d’un utilisateur n’ayant pas pu exécuter la commande ausearch. La commande audit2why permet de comprendre la raison du blocage :</p>
<pre><code>grep &#39;625:4768&#39; /var/log/audit/audit.log | audit2why
type=AVC msg=audit(1599887891.625:4768): avc:  denied  { search } for  pid=6489 comm=&quot;ausearch&quot; name=&quot;/&quot; dev=&quot;dm-4&quot; ino=128 scontext=staff_u:staff_r:staff_t:s0-s0:c0.c1023 tcontext=system_u:object_r:auditd_log_t:s0 tclass=dir permissive=0

        Was caused by:
                Missing type enforcement (TE) allow rule.

                You can use audit2allow to generate a loadable module to allow this access.
</code></pre>
<p>Une solution peut être de rajouter une permission à la politique SELinux via une nouvelle règle. La commande audit2allow permet de la générer :</p>
<pre><code>grep &#39;625:4768&#39; /var/log/audit/audit.log | audit2allow _M ausearch


&lt;a name=&quot;=============staff_t==============&quot;&gt;&lt;/a&gt;

#1\. ============= staff_t ==============
allow staff_t auditd_log_t:dir search;
</code></pre>
<p>Il faut alors lancer les commandes suivantes pour les charger : semodule -i ausearch.pp checkmodule -m -M sudolog.te -o ausearch.mod Il peut être nécessaire de passer en mode Permissive pour établir l’ensemble des règles nécessaires au bon fonctionnement d’un service. Ceci doit être réalisé dans un environnement de développement sécurisé. En mode Permissive, seuls les logs sont générés et peuvent donc être manipulés par ausearch, audit2why et audit2allow.</p>
<h2 id="agrandir-une-partition">Agrandir une partition</h2>
<p>Il suffit d’utiliser les outils classiques de LVM pour rajouter des disques ou étendre des partitions</p>
<h2 id="modifier-le-mot-de-passe-de-démarrage">Modifier le mot de passe de démarrage</h2>
<p>Le mot de passe de démarrage qui protège les paramètres de «boot» est stocké dans le répertoire /boot. Pour pouvoir le modifier, il faut donc d’abord suivre la procédure de passage en mode «maitenance». Une fois la partition accessible, lancer : grub2-setpassword -o /boot/grub2 Et ensuite : cp /boot/grub2/user.cfg /boot/efi/EFI/redhat/</p>
<h2 id="modifier-le-serveur-syslog-distant">Modifier le serveur SYSLOG distant</h2>
<p>Il faut modifier le fichier /etc/rsyslog.d/loghost.conf</p>
<h2 id="modifier-la-source-de-référence-de-temps">Modifier la source de référence de temps</h2>
<p>Il faut modifier le fichier /etc/chrony.conf et remplacer la directive par défaut pool x.rhel.pool.ntp.org … par server <adresse IP ou nom>, puis relancer chrony.</p>
<h2 id="joindre-un-domaine-windows">Joindre un domaine Windows</h2>
<p>Lancer la commande suivante pour joindre un domaine, remplacer domain.com par le domaine cible, user1 par le nom d’administrateur et SERVERS pour l’OU destination : <code>sudo realm join domain.com -U 'user1' --computer-ou=OU=SERVERS --os-name=&quot;$(uname -o)&quot; --os-version=&quot;$(uname -rsv)&quot; --install='/' --verbose</code></p>
<p>Pour restreindre la connexion à un certain groupe seulement (ici SUDOERS), lancer : <code>sudo realm deny -R domain.com -a</code> <code>sudo realm permit -R domain.com -g SUDOERS</code></p>
</body>
</html>
